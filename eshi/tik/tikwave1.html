<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>×ª×§×©×•×¨×ª ×•×—×‘×¨×” â€“ ××¡×œ×•×œ ×œ×"×“</title>
<link href="https://fonts.googleapis.com/css2?family=Rubik:wght@300;400;500;700;900&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
<style>
:root {
    --primary: #4a69bd; --text-dark: #2d3436; --glass-bg: rgba(255,255,255,0.96);
    --c-al: #6c5ce7; --c-1: #0984e3; --c-2: #00cec9; --c-3: #d63031; --c-4: #e1b12c;
    --c-5: #00b894; --c-6: #e17055; --c-7: #be2edd; --c-8: #4834d4; --c-9: #e84393;
}
* { box-sizing: border-box; outline: none; -webkit-tap-highlight-color: transparent; }
body { font-family: 'Rubik', sans-serif; margin: 0; padding: 0; min-height: 100vh; color: var(--text-dark); }

/* ===== ××¡×š ×›× ×™×¡×” ===== */
#loginScreen {
    background: linear-gradient(135deg, #667eea, #764ba2);
    min-height: 100vh; display: flex; align-items: center; justify-content: center; padding: 20px;
}
.login-box {
    background: white; border-radius: 25px; padding: 40px;
    width: 100%; max-width: 420px; box-shadow: 0 30px 80px rgba(0,0,0,0.3);
}
.login-logo { text-align: center; margin-bottom: 30px; }
.login-logo h1 { font-size: 1.5rem; font-weight: 900; color: var(--primary); margin: 10px 0 5px; }
.login-logo p { color: #888; font-size: 0.9rem; margin: 0; }
.login-tabs { display: flex; gap: 5px; background: #f0f0f0; padding: 5px; border-radius: 15px; margin-bottom: 25px; }
.login-tab { flex: 1; padding: 10px; border: none; border-radius: 10px; font-family: inherit; font-size: 0.9rem; font-weight: 600; cursor: pointer; background: none; color: #888; transition: all 0.3s; }
.login-tab.active { background: white; color: var(--primary); box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
.login-field { margin-bottom: 15px; }
.login-field label { display: block; font-weight: 700; margin-bottom: 6px; font-size: 0.9rem; color: #555; }
.login-field input { width: 100%; padding: 13px 15px; border: 2px solid #eee; border-radius: 12px; font-family: inherit; font-size: 1rem; transition: 0.3s; }
.login-field input:focus { border-color: var(--primary); background: #f8f9ff; }
.btn-login { width: 100%; padding: 14px; background: linear-gradient(45deg, #667eea, #764ba2); color: white; border: none; border-radius: 15px; font-family: inherit; font-size: 1.1rem; font-weight: 700; cursor: pointer; transition: 0.3s; margin-top: 10px; }
.btn-login:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(102,126,234,0.4); }
.login-error { color: #e74c3c; font-size: 0.9rem; text-align: center; margin-top: 10px; display: none; }

/* ===== ×›×œ×œ×™ ×œ×›×œ ×”××¡×›×™× ===== */
#studentScreen, #teacherScreen, #adminScreen { display: none; }

.topbar {
    background: linear-gradient(135deg, #667eea, #764ba2); color: white;
    padding: 12px 20px; display: flex; justify-content: space-between; align-items: center;
    position: sticky; top: 0; z-index: 100; box-shadow: 0 4px 15px rgba(0,0,0,0.2);
}
.topbar-title { font-weight: 900; font-size: 1.1rem; }
.topbar-user { font-size: 0.85rem; opacity: 0.9; }
.btn-logout { background: rgba(255,255,255,0.2); border: none; color: white; padding: 7px 15px; border-radius: 20px; cursor: pointer; font-family: inherit; font-size: 0.85rem; font-weight: 600; transition: 0.3s; }
.btn-logout:hover { background: rgba(255,255,255,0.35); }

/* ===== ×ª×œ××™×“ ===== */
#studentScreen { background: linear-gradient(135deg, #a29bfe, #74b9ff); min-height: 100vh; padding-bottom: 80px; }
.nav-container { position: sticky; top: 60px; z-index: 99; display: flex; justify-content: center; padding: 10px; }
.nav-bar { background: var(--glass-bg); padding: 8px; border-radius: 50px; display: flex; gap: 5px; box-shadow: 0 10px 20px rgba(0,0,0,0.1); overflow-x: auto; max-width: 100%; border: 1px solid rgba(255,255,255,0.5); }
.nav-btn { background: none; border: none; padding: 10px 15px; border-radius: 30px; font-weight: 500; cursor: pointer; display: flex; align-items: center; gap: 6px; font-family: inherit; color: #555; white-space: nowrap; }
.nav-btn.active { background: var(--primary); color: white; }
.glass-container { width: 95%; max-width: 900px; margin: 20px auto; background: var(--glass-bg); border-radius: 20px; padding: 5px 20px 30px; box-shadow: 0 20px 60px rgba(0,0,0,0.15); }
.page { display: none; animation: fadeIn 0.5s ease; }
.page.active { display: block; }
@keyframes fadeIn { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }
@keyframes slideIn { from { opacity: 0; transform: translateX(-30px); } to { opacity: 1; transform: translateX(0); } }
@keyframes bounceIn { 0% { transform: scale(0); } 50% { transform: scale(1.2); } 100% { transform: scale(1); } }
h1 { text-align: center; margin: 0 0 30px; font-size: 2rem; color: var(--text-dark); }
.grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 15px; }
.card { background: white; padding: 15px; border-radius: 15px; text-align: center; cursor: pointer; box-shadow: 0 5px 10px rgba(0,0,0,0.05); transition: all 0.3s; border-bottom: 5px solid #ccc; height: 140px; display: flex; flex-direction: column; justify-content: center; align-items: center; position: relative; }
.card:hover { transform: translateY(-5px) scale(1.02); box-shadow: 0 15px 35px rgba(0,0,0,0.15); }
.card .icon { font-size: 35px; margin-bottom: 10px; }
.card .name { font-weight: 700; font-size: 1rem; line-height: 1.2; }
.c-al{border-color:var(--c-al);color:var(--c-al);} .c-1{border-color:var(--c-1);color:var(--c-1);}
.c-2{border-color:var(--c-2);color:var(--c-2);} .c-3{border-color:var(--c-3);color:var(--c-3);}
.c-4{border-color:var(--c-4);color:var(--c-4);} .c-5{border-color:var(--c-5);color:var(--c-5);}
.c-6{border-color:var(--c-6);color:var(--c-6);} .c-7{border-color:var(--c-7);color:var(--c-7);}
.c-8{border-color:var(--c-8);color:var(--c-8);} .c-9{border-color:var(--c-9);color:var(--c-9);}
.chapter-box { border-radius: 20px; margin-bottom: 25px; background: white; overflow: hidden; border: 1px solid #eee; border-right: 6px solid #ccc; box-shadow: 0 5px 15px rgba(0,0,0,0.03); }
.chapter-header { padding: 20px; cursor: pointer; display: flex; justify-content: space-between; align-items: center; }
.chapter-title { font-weight: 800; font-size: 1.2rem; display: flex; align-items: center; gap: 10px; }
.chapter-content { display: none; padding: 25px; border-top: 1px solid #eee; animation: slideIn 0.4s ease; }
.btn-open-chapter { background: white; border: 1px solid rgba(0,0,0,0.1); padding: 6px 15px; border-radius: 20px; font-size: 0.85rem; font-weight: bold; }
.full-concept-card { padding: 20px; border-radius: 15px; margin-bottom: 20px; border: 1px solid rgba(0,0,0,0.05); background: #f9f9f9; }
.card-num { font-size: 1.5rem; font-weight: 900; opacity: 0.2; display: block; margin-bottom: 10px; }
.form-group { margin-bottom: 15px; }
label { display: block; font-weight: 700; margin-bottom: 5px; font-size: 0.95rem; color: #444; }
input[type="text"], textarea, select { width: 100%; padding: 12px; border: 2px solid #eee; border-radius: 10px; background: #fafafa; font-family: inherit; font-size: 1rem; }
input[type="text"]:focus, textarea:focus { border-color: var(--primary); background: white; }
textarea { resize: vertical; min-height: 80px; line-height: 1.6; }
.vs-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
.vs-box { background: white; padding: 15px; border: 1px solid #eee; border-radius: 12px; }
@media(max-width:600px){.vs-grid{grid-template-columns:1fr;}}
.gain { background: #e8f5e9; padding: 10px; border-radius: 8px; margin-top: 10px; border: 1px solid #c8e6c9; font-size: 0.9rem; }
.cost { background: #ffebee; padding: 10px; border-radius: 8px; margin-top: 10px; border: 1px solid #ffcdd2; font-size: 0.9rem; }
.btn-back-lobby { background: transparent; border: 2px solid #ccc; padding: 8px 20px; border-radius: 20px; cursor: pointer; font-weight: bold; color: #555; }
.btn-save-changes { background: linear-gradient(45deg, #00b894, #00cec9); color: white; padding: 12px 25px; border: none; border-radius: 25px; cursor: pointer; font-weight: bold; transition: 0.3s; }
.btn-save-all { width: 100%; background: linear-gradient(45deg, #00b894, #00cec9); color: white; padding: 15px; font-size: 1.2rem; border: none; border-radius: 50px; font-weight: bold; cursor: pointer; margin-top: 20px; }
.teacher-notes-section { background: linear-gradient(135deg, #fff9e6, #fff3cd); border: 2px solid #ffc107; border-radius: 15px; padding: 20px; margin-top: 30px; margin-bottom: 20px; }
.teacher-notes-title { color: #f57f17; font-size: 1.1rem; font-weight: 800; margin: 0 0 10px; display: flex; align-items: center; gap: 8px; }
.teacher-notes-textarea { width: 100%; min-height: 100px; padding: 12px; border: 2px solid #ffe082; border-radius: 10px; background: white; font-family: inherit; font-size: 1rem; resize: vertical; }
.footer-action { display: flex; gap: 15px; justify-content: space-between; margin-top: 30px; }
.home-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-top: 30px; }
.home-card { background: white; padding: 25px; border-radius: 20px; text-align: center; cursor: pointer; box-shadow: 0 10px 20px rgba(0,0,0,0.05); transition: 0.3s; border: 2px solid transparent; }
.home-card:hover { transform: translateY(-5px); border-color: var(--primary); }
.home-icon { font-size: 45px; padding: 12px; border-radius: 50%; margin-bottom: 8px; display: inline-block; }
.progress-indicator { position: absolute; top: 10px; left: 10px; width: 35px; height: 35px; border-radius: 50%; background: conic-gradient(#4cd137 var(--progress), #f0f0f0 0); display: flex; align-items: center; justify-content: center; font-size: 0.65rem; font-weight: bold; z-index: 10; }
.progress-indicator::before { content:''; position:absolute; width:28px; height:28px; border-radius:50%; background:white; z-index:1; }
.progress-indicator span { position:relative; z-index:2; color:#2d3436; }
.completion-badge { position:absolute; top:-8px; right:-8px; background:linear-gradient(135deg,#00b894,#00cec9); color:white; width:32px; height:32px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:1.2rem; animation:bounceIn 0.5s ease; z-index:10; }
.dashboard-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px; }
.stat-card { background: white; padding: 20px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.08); border-right: 6px solid; position: relative; overflow: hidden; }
.stat-icon { font-size: 3rem; opacity: 0.1; position: absolute; left: 15px; top: 15px; }
.stat-number { font-size: 2.2rem; font-weight: 900; margin-bottom: 5px; }
.stat-label { color: #666; font-size: 0.9rem; }
.progress-bar { background: #f0f0f0; height: 10px; border-radius: 10px; overflow: hidden; margin: 12px 0; }
.progress-fill { height: 100%; background: linear-gradient(90deg, #00b894, #00cec9); border-radius: 10px; transition: width 0.6s ease; }
.arena-status { background: white; padding: 12px 18px; border-radius: 12px; margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 3px 10px rgba(0,0,0,0.05); border-right: 4px solid; }
.arena-name { font-weight: 700; }
.arena-progress { display: flex; align-items: center; gap: 12px; }
.badge { padding: 4px 10px; border-radius: 20px; font-size: 0.8rem; font-weight: bold; }
.badge-complete { background: #d4edda; color: #155724; }
.badge-partial { background: #fff3cd; color: #856404; }
.badge-empty { background: #f8d7da; color: #721c24; }
.mini-progress { width: 70px; height: 7px; background: #e0e0e0; border-radius: 10px; overflow: hidden; }
.mini-progress-fill { height: 100%; border-radius: 10px; }
.save-toast { position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%); background: linear-gradient(135deg,#00b894,#00cec9); color: white; padding: 13px 28px; border-radius: 50px; font-weight: bold; z-index: 9999; display: none; box-shadow: 0 10px 30px rgba(0,184,148,0.4); }
.copy-warning { position: fixed; top: 50%; left: 50%; transform: translate(-50%,-50%); background: linear-gradient(135deg,#e74c3c,#c0392b); color: white; padding: 25px 45px; border-radius: 20px; font-size: 1.2rem; font-weight: bold; z-index: 10000; display: none; }
.input-mic-wrapper { display: flex; align-items: flex-start; gap: 8px; width: 100%; }
.input-mic-wrapper input, .input-mic-wrapper textarea { flex: 1; min-width: 0; }
.mic-btn { background: #f0f0f0; border: none; cursor: pointer; color: #888; width: 36px; height: 36px; border-radius: 50%; display: flex; align-items: center; justify-content: center; transition: 0.2s; flex-shrink: 0; margin-top: 4px; }
.mic-btn:hover { color: var(--primary); background: #e0e8ff; }
.mic-btn.listening { color: white; background: #e74c3c; animation: micPulse 1s infinite; }
@keyframes micPulse { 0%,100%{box-shadow:0 0 0 0 rgba(231,76,60,0.4);}50%{box-shadow:0 0 0 10px rgba(231,76,60,0);} }

/* ===== ××•×¨×” ===== */
#teacherScreen { background: #f0f4ff; min-height: 100vh; padding-bottom: 40px; }
.teacher-container { max-width: 1000px; margin: 0 auto; padding: 20px; }
.teacher-header { background: white; border-radius: 20px; padding: 25px; margin-bottom: 25px; box-shadow: 0 5px 20px rgba(0,0,0,0.08); }
.class-title { font-size: 1.5rem; font-weight: 900; color: var(--primary); margin: 0 0 5px; }
.students-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 15px; }
.student-card { background: white; border-radius: 15px; padding: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.07); border-right: 5px solid var(--primary); cursor: pointer; transition: 0.3s; }
.student-card:hover { transform: translateY(-3px); box-shadow: 0 10px 25px rgba(0,0,0,0.12); }
.student-name { font-weight: 800; font-size: 1.1rem; margin-bottom: 8px; }
.student-class { color: #888; font-size: 0.85rem; margin-bottom: 12px; }
.student-progress-bar { background: #f0f0f0; height: 8px; border-radius: 10px; overflow: hidden; margin-bottom: 5px; }
.student-progress-fill { height: 100%; background: linear-gradient(90deg, #667eea, #764ba2); border-radius: 10px; transition: width 0.5s; }
.student-progress-text { font-size: 0.8rem; color: #888; text-align: left; }
.teacher-view-modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 500; overflow-y: auto; }
.teacher-view-content { background: #f0f4ff; min-height: 100vh; max-width: 900px; margin: 0 auto; padding: 20px; }
.btn-close-modal { background: white; border: 2px solid #ddd; padding: 10px 20px; border-radius: 20px; cursor: pointer; font-weight: bold; margin-bottom: 20px; font-family: inherit; }
.readonly-note { background: #fff3cd; border: 2px solid #ffc107; border-radius: 10px; padding: 12px 18px; margin-bottom: 20px; font-weight: 600; color: #856404; }

/* ===== ×× ×”×œ ===== */
#adminScreen { background: #f5f7ff; min-height: 100vh; padding-bottom: 40px; }
.admin-container { max-width: 1000px; margin: 0 auto; padding: 20px; }
.admin-tabs { display: flex; gap: 10px; margin-bottom: 25px; flex-wrap: wrap; }
.admin-tab-btn { padding: 12px 25px; border: none; border-radius: 15px; font-family: inherit; font-size: 1rem; font-weight: 700; cursor: pointer; background: white; color: #555; box-shadow: 0 3px 10px rgba(0,0,0,0.08); transition: 0.3s; }
.admin-tab-btn.active { background: linear-gradient(45deg, #667eea, #764ba2); color: white; }
.admin-panel { display: none; }
.admin-panel.active { display: block; }
.admin-card { background: white; border-radius: 20px; padding: 25px; box-shadow: 0 5px 20px rgba(0,0,0,0.08); margin-bottom: 20px; }
.admin-card h2 { margin-top: 0; color: var(--primary); }
.admin-table { width: 100%; border-collapse: collapse; }
.admin-table th { background: #f0f4ff; padding: 12px 15px; text-align: right; font-weight: 700; border-bottom: 2px solid #e0e0e0; }
.admin-table td { padding: 12px 15px; border-bottom: 1px solid #f0f0f0; }
.admin-table tr:hover td { background: #f8f9ff; }
.btn-admin { padding: 10px 20px; border: none; border-radius: 10px; font-family: inherit; font-weight: 700; cursor: pointer; transition: 0.3s; }
.btn-primary { background: linear-gradient(45deg, #667eea, #764ba2); color: white; }
.btn-danger { background: #fee2e2; color: #c0392b; }
.btn-success { background: #d4edda; color: #155724; }
.admin-form input, .admin-form select { width: 100%; padding: 11px 15px; border: 2px solid #eee; border-radius: 10px; font-family: inherit; font-size: 1rem; margin-bottom: 12px; }
.admin-form input:focus, .admin-form select:focus { border-color: var(--primary); }
.excel-drop { border: 3px dashed #c0c0c0; border-radius: 15px; padding: 40px; text-align: center; margin-bottom: 15px; cursor: pointer; transition: 0.3s; }
.excel-drop:hover { border-color: var(--primary); background: #f0f4ff; }
.excel-preview { max-height: 300px; overflow-y: auto; }
.tag { display: inline-block; padding: 3px 10px; border-radius: 20px; font-size: 0.8rem; font-weight: 600; margin: 2px; background: #e0e8ff; color: var(--primary); }
</style>
</head>
<body>

<!-- ===== ××¡×š ×›× ×™×¡×” ===== -->
<div id="loginScreen">
    <div class="login-box">
        <div class="login-logo">
            <span class="material-icons-round" style="font-size:50px; color:var(--primary);">school</span>
            <h1>×ª×§×©×•×¨×ª ×•×—×‘×¨×”</h1>
            <p>××¡×œ×•×œ ×œ×"×“ | ×›× ×™×¡×” ×œ××¢×¨×›×ª</p>
        </div>
        <div class="login-tabs">
            <button class="login-tab active" onclick="switchLoginTab('student')">ğŸ“ ×ª×œ××™×“</button>
            <button class="login-tab" onclick="switchLoginTab('teacher')">ğŸ‘©â€ğŸ« ××•×¨×”</button>
            <button class="login-tab" onclick="switchLoginTab('admin')">âš™ï¸ ×× ×”×œ</button>
        </div>

        <!-- ×ª×œ××™×“ -->
        <div id="loginStudent">
            <div class="login-field">
                <label>×ª×¢×•×“×ª ×–×”×•×ª</label>
                <input type="text" id="studentId" placeholder="×”×–×Ÿ ×ª×¢×•×“×ª ×–×”×•×ª" maxlength="9">
            </div>
            <button class="btn-login" onclick="loginStudent()">×›× ×™×¡×” ×œ×ª×™×§ ×©×œ×™</button>
        </div>

        <!-- ××•×¨×” -->
        <div id="loginTeacher" style="display:none;">
            <div class="login-field">
                <label>×©× ××©×ª××©</label>
                <input type="text" id="teacherUsername" placeholder="×©× ××©×ª××©">
            </div>
            <div class="login-field">
                <label>×¡×™×¡××”</label>
                <input type="password" id="teacherPassword" placeholder="×¡×™×¡××”">
            </div>
            <button class="btn-login" onclick="loginTeacher()">×›× ×™×¡×”</button>
        </div>

        <!-- ×× ×”×œ -->
        <div id="loginAdmin" style="display:none;">
            <div class="login-field">
                <label>×©× ××©×ª××©</label>
                <input type="text" id="adminUsername" placeholder="×©× ××©×ª××©">
            </div>
            <div class="login-field">
                <label>×¡×™×¡××”</label>
                <input type="password" id="adminPassword" placeholder="×¡×™×¡××”">
            </div>
            <button class="btn-login" onclick="loginAdmin()">×›× ×™×¡×”</button>
        </div>

        <div class="login-error" id="loginError">âŒ ×¤×¨×˜×™ ×›× ×™×¡×” ×©×’×•×™×™×</div>
    </div>
</div>

<!-- ===== ××¡×š ×ª×œ××™×“ ===== -->
<div id="studentScreen">
    <div class="topbar">
        <div>
            <div class="topbar-title">×ª×§×©×•×¨×ª ×•×—×‘×¨×” â€“ ××¡×œ×•×œ ×œ×"×“</div>
            <div class="topbar-user" id="studentTopbarName"></div>
        </div>
        <button class="btn-logout" onclick="logout()">×™×¦×™××”</button>
    </div>

    <div class="nav-container"><div class="nav-bar">
        <button class="nav-btn active" onclick="showPage('home', this)"><span class="material-icons-round">home</span> ×©×¢×¨</button>
        <button class="nav-btn" onclick="showPage('dashboard', this)"><span class="material-icons-round">analytics</span> ××¦×‘</button>
        <button class="nav-btn" onclick="showPage('lobby-zirot', this)"><span class="material-icons-round">apps</span> ×–×™×¨×•×ª</button>
        <button class="nav-btn" onclick="showPage('finish', this)"><span class="material-icons-round">cloud_upload</span> ×©××™×¨×”</button>
    </div></div>

    <div class="glass-container">

        <div id="home" class="page active">
            <h1>×ª×™×§ ×œ×"×“ ×“×™×’×™×˜×œ×™</h1>
            <div style="background:linear-gradient(135deg,#ff9ff3,#feca57);color:#fff;padding:25px;text-align:center;border-radius:15px;margin-bottom:25px;text-shadow:1px 1px 2px rgba(0,0,0,0.2);">
                <p style="font-size:1.05rem;line-height:1.5;margin-bottom:15px;">×”×©× ×” × ×¦× ×™×—×“ ×œ××¡×¢ ×‘×™×Ÿ ×–×™×¨×•×ª ×”×œ×™××•×“ â€“ ×¤×¨×§×™ ×œ×™××•×“ ×©×›×œ ××—×“ ××”× ×™×¤×ª×— ×‘×¤× ×™×›× ×¢×•×œ× ×©×œ × ×•×©××™×, ×©××œ×•×ª ×•×“×™×œ××•×ª ××¢×•×œ× ×”×ª×§×©×•×¨×ª ×•×”×—×‘×¨×”.</p>
                <div style="font-size:1.4rem;font-weight:900;border-top:1px solid rgba(255,255,255,0.4);padding-top:15px;">ğŸš€ ×‘×”×¦×œ×—×” ×‘××¡×¢ ×”×œ×™××•×“×™!</div>
            </div>
            <div class="home-grid">
                <div class="home-card" onclick="showPage('lobby-zirot', document.querySelectorAll('.nav-btn')[2])">
                    <span class="material-icons-round home-icon" style="background:#e3f2fd;color:#0984e3;">school</span>
                    <h3>×–×™×¨×•×ª ×”×œ×™××•×“</h3><p>×›× ×™×¡×” ×œ×–×™×¨×•×ª 1-9 ×•×–×™×¨×ª ×”×¢×œ</p>
                </div>
                <div class="home-card" onclick="showPage('dashboard', document.querySelectorAll('.nav-btn')[1])">
                    <span class="material-icons-round home-icon" style="background:#e8f5e9;color:#00b894;">analytics</span>
                    <h3>×ª××•× ×ª ××¦×‘</h3><p>×¡×™×›×•× ×”×”×ª×§×“××•×ª ×©×œ×š</p>
                </div>
            </div>
        </div>

        <div id="dashboard" class="page">
            <h1>ğŸ“Š ×ª××•× ×ª ××¦×‘</h1>
            <div class="dashboard-grid">
                <div class="stat-card" style="border-color:#00b894;"><span class="stat-icon">âœ…</span><div class="stat-number" id="totalProgress" style="color:#00b894;">0%</div><div class="stat-label">×”×ª×§×“××•×ª ×›×œ×œ×™×ª</div><div class="progress-bar"><div class="progress-fill" id="totalProgressBar" style="width:0%"></div></div></div>
                <div class="stat-card" style="border-color:#0984e3;"><span class="stat-icon">ğŸ“š</span><div class="stat-number" id="conceptsCount" style="color:#0984e3;">0</div><div class="stat-label">××•×©×’×™× ×©×”×•×¡×‘×¨×•</div></div>
                <div class="stat-card" style="border-color:#6c5ce7;"><span class="stat-icon">ğŸ­</span><div class="stat-number" id="dilemmasCount" style="color:#6c5ce7;">0</div><div class="stat-label">×“×™×œ××•×ª ×©× ×•×ª×—×•</div></div>
                <div class="stat-card" style="border-color:#fd79a8;"><span class="stat-icon">ğŸŒ</span><div class="stat-number" id="arenasCount" style="color:#fd79a8;">0/10</div><div class="stat-label">×–×™×¨×•×ª ×©×”×•×©×œ××•</div></div>
            </div>
            <div style="background:white;padding:25px;border-radius:20px;box-shadow:0 10px 30px rgba(0,0,0,0.08);">
                <h2 style="margin-top:0;">ğŸ“‹ ×¤×™×¨×•×˜ ×œ×¤×™ ×–×™×¨×•×ª</h2>
                <div id="arenasList"></div>
            </div>
        </div>

        <div id="lobby-zirot" class="page">
            <h1>×–×™×¨×•×ª ×”×œ×™××•×“</h1>
            <div class="grid">
                <div class="card c-al" onclick="showPage('z-al')"><span class="icon material-icons-round">all_inclusive</span><span class="name">×–×™×¨×ª ×”×¢×œ</span></div>
                <div class="card c-1" onclick="showPage('z-1')"><span class="icon material-icons-round">visibility</span><span class="name">××¦×™××•×ª ×ª×§×©×•×¨×ª×™×ª</span></div>
                <div class="card c-2" onclick="showPage('z-2')"><span class="icon material-icons-round">public</span><span class="name">×’×œ×•×‘×œ×™×–×¦×™×”</span></div>
                <div class="card c-3" onclick="showPage('z-3')"><span class="icon material-icons-round">tv</span><span class="name">×—×“×©×•×ª ×•×¦×™×œ×•×</span></div>
                <div class="card c-4" onclick="showPage('z-4')"><span class="icon material-icons-round">theater_comedy</span><span class="name">×”×•××•×¨ ×•×¡××˜×™×¨×”</span></div>
                <div class="card c-5" onclick="showPage('z-5')"><span class="icon material-icons-round">smartphone</span><span class="name">×ª×¨×‘×•×ª ×“×™×’×™×˜×œ×™×ª</span></div>
                <div class="card c-6" onclick="showPage('z-6')"><span class="icon material-icons-round">star</span><span class="name">×¨×™××œ×™×˜×™</span></div>
                <div class="card c-7" onclick="showPage('z-7')"><span class="icon material-icons-round">music_note</span><span class="name">×§×œ×™×¤×™×</span></div>
                <div class="card c-8" onclick="showPage('z-8')"><span class="icon material-icons-round">sports_soccer</span><span class="name">×¡×¤×•×¨×˜</span></div>
                <div class="card c-9" onclick="showPage('z-9')"><span class="icon material-icons-round">campaign</span><span class="name">×¤×¨×¡×•×</span></div>
            </div>
        </div>

        <!-- ×–×™×¨×ª ×”×¢×œ -->
        <div id="z-al" class="page">
            <h1 style="color:var(--c-al);">×–×™×¨×ª ×”×¢×œ</h1>
            <div style="background:#e3f2fd;border:1px solid #bbdefb;border-radius:15px;padding:20px;margin-bottom:25px;color:#1565c0;line-height:1.6;">
                <p>×‘×›×“×™ ×œ×”×‘×™×Ÿ ×‘×××ª ××ª ×›×•×—×” ×©×œ ×”×ª×§×©×•×¨×ª, ×—×©×•×‘ ×œ×¢×¦×•×¨ ×•×œ×”×‘×™×Ÿ ××ª ×”×§×©×¨ ×©×œ×” ×œ×“××•×§×¨×˜×™×”.</p>
                <p>×”×ª×§×©×•×¨×ª × ×—×©×‘×ª ×œ"×¨×©×•×ª ×¨×‘×™×¢×™×ª": ×–×• ×©×××•×¨×” ×œ×‘×§×¨ ××ª ×”×©×œ×˜×•×Ÿ, ×œ×—×©×•×£ ××” ×©×× ×¡×™× ×œ×”×¡×ª×™×¨, ×•×œ×”×’×Ÿ ×¢×œ ×–×›×•×ª ×”×¦×™×‘×•×¨ ×œ×“×¢×ª.</p>
            </div>
            <div class="chapter-box" style="border-right-color:var(--c-al);">
                <div class="chapter-header" onclick="toggleChapter(this)" style="background:#f3e5f5;"><div class="chapter-title" style="color:var(--c-al);">×¤×¨×§ 1: ××•×©×’×™×</div><div class="btn-open-chapter">×¤×ª×—</div></div>
                <div class="chapter-content">
                    <div class="full-concept-card" style="background:#f3e5f5;border-right:6px solid #8e44ad;"><span class="card-num">#1</span><div class="form-group"><label>×©× ×”××•×©×’:</label><input type="text" value=""></div><div class="form-group"><label>×”×”×¡×‘×¨ ×©×œ×™:</label><textarea rows="2"></textarea></div><div class="form-group"><label>×“×•×’××”/×§×™×©×•×¨:</label><input type="text" class="allow-paste" placeholder="×”×“×‘×™×§×• ×›××Ÿ ×§×™×©×•×¨" value=""></div><div class="form-group"><label>×”×¡×‘×¨ ×”×§×©×¨:</label><textarea rows="2"></textarea></div></div>
                    <div class="full-concept-card" style="background:#e3f2fd;border-right:6px solid #2196f3;"><span class="card-num">#2</span><div class="form-group"><label>×©× ×”××•×©×’:</label><input type="text" value=""></div><div class="form-group"><label>×”×”×¡×‘×¨ ×©×œ×™:</label><textarea rows="2"></textarea></div><div class="form-group"><label>×“×•×’××”/×§×™×©×•×¨:</label><input type="text" class="allow-paste" placeholder="×”×“×‘×™×§×• ×›××Ÿ ×§×™×©×•×¨" value=""></div><div class="form-group"><label>×”×¡×‘×¨ ×”×§×©×¨:</label><textarea rows="2"></textarea></div></div>
                    <div class="full-concept-card" style="background:#fffde7;border-right:6px solid #fbc02d;"><span class="card-num">#3</span><div class="form-group"><label>×©× ×”××•×©×’:</label><input type="text" value=""></div><div class="form-group"><label>×”×”×¡×‘×¨ ×©×œ×™:</label><textarea rows="2"></textarea></div><div class="form-group"><label>×“×•×’××”/×§×™×©×•×¨:</label><input type="text" class="allow-paste" placeholder="×”×“×‘×™×§×• ×›××Ÿ ×§×™×©×•×¨" value=""></div><div class="form-group"><label>×”×¡×‘×¨ ×”×§×©×¨:</label><textarea rows="2"></textarea></div></div>
                    <div class="full-concept-card" style="background:#fce4ec;border-right:6px solid #e91e63;"><span class="card-num">#4</span><div class="form-group"><label>×©× ×”××•×©×’:</label><input type="text" value=""></div><div class="form-group"><label>×”×”×¡×‘×¨ ×©×œ×™:</label><textarea rows="2"></textarea></div><div class="form-group"><label>×“×•×’××”/×§×™×©×•×¨:</label><input type="text" class="allow-paste" placeholder="×”×“×‘×™×§×• ×›××Ÿ ×§×™×©×•×¨" value=""></div><div class="form-group"><label>×”×¡×‘×¨ ×”×§×©×¨:</label><textarea rows="2"></textarea></div></div>
                </div>
            </div>
            <div class="chapter-box" style="border-right-color:var(--c-al);">
                <div class="chapter-header" onclick="toggleChapter(this)" style="background:#f3e5f5;"><div class="chapter-title" style="color:var(--c-al);">×¤×¨×§ 2: ×“×™×œ××•×ª</div><div class="btn-open-chapter">×¤×ª×—</div></div>
                <div class="chapter-content">
                    <div style="background:#f3e5f5;border-right:6px solid #8e44ad;padding:20px;border-radius:15px;margin-bottom:20px;"><h3 style="color:#8e44ad;margin-top:0;">ğŸ‘¤ ×“×™×œ××” ××™×©×™×ª</h3><div class="form-group"><label>×ª×™××•×¨:</label><textarea rows="3"></textarea></div><div class="vs-grid"><div class="vs-box"><h4>×“×¨×š ×'</h4><input type="text" value=""><div class="gain"><label>×¨×•×•×—:</label><input type="text" value=""></div><div class="cost"><label>××—×™×¨:</label><input type="text" value=""></div></div><div class="vs-box"><h4>×“×¨×š ×‘'</h4><input type="text" value=""><div class="gain"><label>×¨×•×•×—:</label><input type="text" value=""></div><div class="cost"><label>××—×™×¨:</label><input type="text" value=""></div></div></div><div class="form-group" style="margin-top:12px;"><label>×”×›×¨×¢×”:</label><textarea rows="2"></textarea></div><div class="form-group"><label>×¤×ª×¨×•×Ÿ:</label><textarea rows="2"></textarea></div></div>
                    <div style="background:#ede7f6;border-right:6px solid #673ab7;padding:20px;border-radius:15px;"><h3 style="color:#673ab7;margin-top:0;">ğŸ¥ ×“×™×œ××” ××§×¦×•×¢×™×ª</h3><div class="form-group"><label>×ª×™××•×¨:</label><textarea rows="3"></textarea></div><div class="vs-grid"><div class="vs-box"><h4>×“×¨×š ×'</h4><input type="text" value=""><div class="gain"><label>×¨×•×•×—:</label><input type="text" value=""></div><div class="cost"><label>××—×™×¨:</label><input type="text" value=""></div></div><div class="vs-box"><h4>×“×¨×š ×‘'</h4><input type="text" value=""><div class="gain"><label>×¨×•×•×—:</label><input type="text" value=""></div><div class="cost"><label>××—×™×¨:</label><input type="text" value=""></div></div></div><div class="form-group" style="margin-top:12px;"><label>×”×›×¨×¢×”:</label><textarea rows="2"></textarea></div><div class="form-group"><label>×¤×ª×¨×•×Ÿ:</label><textarea rows="2"></textarea></div></div>
                </div>
            </div>
            <div class="chapter-box" style="border-right-color:var(--c-al);">
                <div class="chapter-header" onclick="toggleChapter(this)" style="background:#f3e5f5;"><div class="chapter-title" style="color:var(--c-al);">×¤×¨×§ 3: ××•×¨×™×™× ×•×ª</div><div class="btn-open-chapter">×¤×ª×—</div></div>
                <div class="chapter-content">
                    <div class="full-concept-card" style="background:#fdf0ff;border-right:6px solid #be2edd;"><div class="form-group"><label style="color:#be2edd;font-size:1.05rem;">ğŸŒ ×¢×œ ×”×—×‘×¨×” ×¡×‘×™×‘×›×</label><textarea rows="5"></textarea></div></div>
                    <div class="full-concept-card" style="background:#f0f4ff;border-right:6px solid #4834d4;"><div class="form-group"><label style="color:#4834d4;font-size:1.05rem;">ğŸ“º ×¢×œ ×”×ª×§×©×•×¨×ª ×•×¤×¢×•×œ×ª×”</label><textarea rows="5"></textarea></div></div>
                    <div class="full-concept-card" style="background:#fff9db;border-right:6px solid #f1c40f;"><div class="form-group"><label style="color:#f39c12;font-size:1.05rem;">ğŸ™‹ ×¢×œ ×¢×¦××™ ×›×¦×¨×›×Ÿ ×ª×§×©×•×¨×ª</label><textarea rows="5"></textarea></div></div>
                </div>
            </div>
            <div class="teacher-notes-section"><div class="teacher-notes-title"><span class="material-icons-round">chat</span> ×”×¢×¨×•×ª ××•×¨×”</div><textarea id="notes-al" class="teacher-notes-textarea" placeholder="×”×¢×¨×•×ª ×”××•×¨×” ×œ×–×™×¨×ª ×”×¢×œ" readonly style="background:#fffde7;"></textarea></div>
            <div class="footer-action"><button class="btn-save-changes" onclick="saveToCloud()">â˜ï¸ ×©××™×¨×”</button><button class="btn-back-lobby" onclick="showPage('lobby-zirot')">×—×–×¨×”</button></div>
        </div>

        <!-- ×–×™×¨×•×ª 1-9 (×ª×‘× ×™×ª ××—×™×“×”) -->
        <div id="z-1" class="page"><h1 style="color:var(--c-1);">×–×™×¨×” 1: ××¦×™××•×ª ×ª×§×©×•×¨×ª×™×ª</h1><div class="chapter-box" style="border-right-color:var(--c-1);"><div class="chapter-header" onclick="toggleChapter(this)" style="background:#e3f2fd;"><div class="chapter-title" style="color:var(--c-1);">×¤×¨×§ 1: ××•×©×’×™×</div><div class="btn-open-chapter">×¤×ª×—</div></div><div class="chapter-content"><div class="full-concept-card" style="background:#f3e5f5;border-right:6px solid #8e44ad;"><span class="card-num">#1</span><div class="form-group"><label>×”××•×©×’:</label><input type="text" value=""></div><div class="form-group"><label>×”×¡×‘×¨:</label><textarea rows="2"></textarea></div><div class="form-group"><label>×§×™×©×•×¨:</label><input type="text" class="allow-paste" value=""></div><div class="form-group"><label>×”×§×©×¨:</label><textarea rows="2"></textarea></div></div><div class="full-concept-card" style="background:#e3f2fd;border-right:6px solid #2196f3;"><span class="card-num">#2</span><div class="form-group"><label>×”××•×©×’:</label><input type="text" value=""></div><div class="form-group"><label>×”×¡×‘×¨:</label><textarea rows="2"></textarea></div><div class="form-group"><label>×§×™×©×•×¨:</label><input type="text" class="allow-paste" value=""></div><div class="form-group"><label>×”×§×©×¨:</label><textarea rows="2"></textarea></div></div><div class="full-concept-card" style="background:#fffde7;border-right:6px solid #fbc02d;"><span class="card-num">#3</span><div class="form-group"><label>×”××•×©×’:</label><input type="text" value=""></div><div class="form-group"><label>×”×¡×‘×¨:</label><textarea rows="2"></textarea></div><div class="form-group"><label>×§×™×©×•×¨:</label><input type="text" class="allow-paste" value=""></div><div class="form-group"><label>×”×§×©×¨:</label><textarea rows="2"></textarea></div></div><div class="full-concept-card" style="background:#fce4ec;border-right:6px solid #e91e63;"><span class="card-num">#4</span><div class="form-group"><label>×”××•×©×’:</label><input type="text" value=""></div><div class="form-group"><label>×”×¡×‘×¨:</label><textarea rows="2"></textarea></div><div class="form-group"><label>×§×™×©×•×¨:</label><input type="text" class="allow-paste" value=""></div><div class="form-group"><label>×”×§×©×¨:</label><textarea rows="2"></textarea></div></div></div></div><div class="chapter-box" style="border-right-color:var(--c-1);"><div class="chapter-header" onclick="toggleChapter(this)" style="background:#e3f2fd;"><div class="chapter-title" style="color:var(--c-1);">×¤×¨×§ 2: ×“×™×œ××•×ª</div><div class="btn-open-chapter">×¤×ª×—</div></div><div class="chapter-content"><div style="background:#f3e5f5;border-right:6px solid #8e44ad;padding:20px;border-radius:15px;margin-bottom:20px;"><h3 style="color:#8e44ad;margin-top:0;">ğŸ‘¤ ×“×™×œ××” ××™×©×™×ª</h3><div class="form-group"><label>×ª×™××•×¨:</label><textarea rows="3"></textarea></div><div class="vs-grid"><div class="vs-box"><h4>×“×¨×š ×'</h4><input type="text" value=""><div class="gain"><label>×¨×•×•×—:</label><input type="text" value=""></div><div class="cost"><label>××—×™×¨:</label><input type="text" value=""></div></div><div class="vs-box"><h4>×“×¨×š ×‘'</h4><input type="text" value=""><div class="gain"><label>×¨×•×•×—:</label><input type="text" value=""></div><div class="cost"><label>××—×™×¨:</label><input type="text" value=""></div></div></div><div class="form-group" style="margin-top:12px;"><label>×”×›×¨×¢×”:</label><textarea rows="2"></textarea></div><div class="form-group"><label>×¤×ª×¨×•×Ÿ:</label><textarea rows="2"></textarea></div></div><div style="background:#ede7f6;border-right:6px solid #673ab7;padding:20px;border-radius:15px;"><h3 style="color:#673ab7;margin-top:0;">ğŸ¥ ×“×™×œ××” ××§×¦×•×¢×™×ª</h3><div class="form-group"><label>×ª×™××•×¨:</label><textarea rows="3"></textarea></div><div class="vs-grid"><div class="vs-box"><h4>×“×¨×š ×'</h4><input type="text" value=""><div class="gain"><label>×¨×•×•×—:</label><input type="text" value=""></div><div class="cost"><label>××—×™×¨:</label><input type="text" value=""></div></div><div class="vs-box"><h4>×“×¨×š ×‘'</h4><input type="text" value=""><div class="gain"><label>×¨×•×•×—:</label><input type="text" value=""></div><div class="cost"><label>××—×™×¨:</label><input type="text" value=""></div></div></div><div class="form-group" style="margin-top:12px;"><label>×”×›×¨×¢×”:</label><textarea rows="2"></textarea></div><div class="form-group"><label>×¤×ª×¨×•×Ÿ:</label><textarea rows="2"></textarea></div></div></div></div><div class="chapter-box" style="border-right-color:var(--c-1);"><div class="chapter-header" onclick="toggleChapter(this)" style="background:#e3f2fd;"><div class="chapter-title" style="color:var(--c-1);">×¤×¨×§ 3: ××•×¨×™×™× ×•×ª</div><div class="btn-open-chapter">×¤×ª×—</div></div><div class="chapter-content"><div class="full-concept-card" style="background:#fdf0ff;border-right:6px solid #be2edd;"><div class="form-group"><label>×¢×œ ×”×—×‘×¨×”</label><textarea rows="4"></textarea></div></div><div class="full-concept-card" style="background:#f0f4ff;border-right:6px solid #4834d4;"><div class="form-group"><label>×¢×œ ×”×ª×§×©×•×¨×ª</label><textarea rows="4"></textarea></div></div><div class="full-concept-card" style="background:#fff9db;border-right:6px solid #f1c40f;"><div class="form-group"><label>×¢×œ ×¢×¦××™</label><textarea rows="4"></textarea></div></div></div></div><div class="teacher-notes-section"><div class="teacher-notes-title"><span class="material-icons-round">chat</span> ×”×¢×¨×•×ª ××•×¨×”</div><textarea id="notes-1" class="teacher-notes-textarea" readonly style="background:#fffde7;"></textarea></div><div class="footer-action"><button class="btn-save-changes" onclick="saveToCloud()">â˜ï¸ ×©××™×¨×”</button><button class="btn-back-lobby" onclick="showPage('lobby-zirot')">×—×–×¨×”</button></div></div>

        <div id="z-2" class="page"><h1 style="color:var(--c-2);">×–×™×¨×” 2: ×’×œ×•×‘×œ×™×–×¦×™×”</h1><div class="chapter-box" style="border-right-color:var(--c-2);"><div class="chapter-header" onclick="toggleChapter(this)"><div class="chapter-title" style="color:var(--c-2);">×¤×¨×§ 1: ××•×©×’×™×</div><div class="btn-open-chapter">×¤×ª×—</div></div><div class="chapter-content"><div class="full-concept-card" style="background:#f3e5f5;border-right:6px solid #8e44ad;"><span class="card-num">#1</span><div class="form-group"><label>×”××•×©×’:</label><input type="text" value=""></div><div class="form-group"><label>×”×¡×‘×¨:</label><textarea rows="2"></textarea></div><div class="form-group"><label>×§×™×©×•×¨:</label><input type="text" class="allow-paste" value=""></div><div class="form-group"><label>×”×§×©×¨:</label><textarea rows="2"></textarea></div></div><div class="full-concept-card" style="background:#e3f2fd;border-right:6px solid #2196f3;"><span class="card-num">#2</span><div class="form-group"><label>×”××•×©×’:</label><input type="text" value=""></div><div class="form-group"><label>×”×¡×‘×¨:</label><textarea rows="2"></textarea></div><div class="form-group"><label>×§×™×©×•×¨:</label><input type="text" class="allow-paste" value=""></div><div class="form-group"><label>×”×§×©×¨:</label><textarea rows="2"></textarea></div></div><div class="full-concept-card" style="background:#fffde7;border-right:6px solid #fbc02d;"><span class="card-num">#3</span><div class="form-group"><label>×”××•×©×’:</label><input type="text" value=""></div><div class="form-group"><label>×”×¡×‘×¨:</label><textarea rows="2"></textarea></div><div class="form-group"><label>×§×™×©×•×¨:</label><input type="text" class="allow-paste" value=""></div><div class="form-group"><label>×”×§×©×¨:</label><textarea rows="2"></textarea></div></div><div class="full-concept-card" style="background:#fce4ec;border-right:6px solid #e91e63;"><span class="card-num">#4</span><div class="form-group"><label>×”××•×©×’:</label><input type="text" value=""></div><div class="form-group"><label>×”×¡×‘×¨:</label><textarea rows="2"></textarea></div><div class="form-group"><label>×§×™×©×•×¨:</label><input type="text" class="allow-paste" value=""></div><div class="form-group"><label>×”×§×©×¨:</label><textarea rows="2"></textarea></div></div></div></div><div class="chapter-box" style="border-right-color:var(--c-2);"><div class="chapter-header" onclick="toggleChapter(this)"><div class="chapter-title" style="color:var(--c-2);">×¤×¨×§ 2: ×“×™×œ××•×ª</div><div class="btn-open-chapter">×¤×ª×—</div></div><div class="chapter-content"><div style="background:#f3e5f5;border-right:6px solid #8e44ad;padding:20px;border-radius:15px;margin-bottom:20px;"><h3 style="margin-top:0;">ğŸ‘¤ ×“×™×œ××” ××™×©×™×ª</h3><div class="form-group"><label>×ª×™××•×¨:</label><textarea rows="3"></textarea></div><div class="vs-grid"><div class="vs-box"><h4>×“×¨×š ×'</h4><input type="text" value=""><div class="gain"><label>×¨×•×•×—:</label><input type="text" value=""></div><div class="cost"><label>××—×™×¨:</label><input type="text" value=""></div></div><div class="vs-box"><h4>×“×¨×š ×‘'</h4><input type="text" value=""><div class="gain"><label>×¨×•×•×—:</label><input type="text" value=""></div><div class="cost"><label>××—×™×¨:</label><input type="text" value=""></div></div></div><div class="form-group" style="margin-top:12px;"><label>×”×›×¨×¢×”:</label><textarea rows="2"></textarea></div><div class="form-group"><label>×¤×ª×¨×•×Ÿ:</label><textarea rows="2"></textarea></div></div><div style="background:#ede7f6;border-right:6px solid #673ab7;padding:20px;border-radius:15px;"><h3 style="margin-top:0;">ğŸ¥ ×“×™×œ××” ××§×¦×•×¢×™×ª</h3><div class="form-group"><label>×ª×™××•×¨:</label><textarea rows="3"></textarea></div><div class="vs-grid"><div class="vs-box"><h4>×“×¨×š ×'</h4><input type="text" value=""><div class="gain"><label>×¨×•×•×—:</label><input type="text" value=""></div><div class="cost"><label>××—×™×¨:</label><input type="text" value=""></div></div><div class="vs-box"><h4>×“×¨×š ×‘'</h4><input type="text" value=""><div class="gain"><label>×¨×•×•×—:</label><input type="text" value=""></div><div class="cost"><label>××—×™×¨:</label><input type="text" value=""></div></div></div><div class="form-group" style="margin-top:12px;"><label>×”×›×¨×¢×”:</label><textarea rows="2"></textarea></div><div class="form-group"><label>×¤×ª×¨×•×Ÿ:</label><textarea rows="2"></textarea></div></div></div></div><div class="chapter-box" style="border-right-color:var(--c-2);"><div class="chapter-header" onclick="toggleChapter(this)"><div class="chapter-title" style="color:var(--c-2);">×¤×¨×§ 3: ××•×¨×™×™× ×•×ª</div><div class="btn-open-chapter">×¤×ª×—</div></div><div class="chapter-content"><div class="full-concept-card" style="background:#fdf0ff;border-right:6px solid #be2edd;"><div class="form-group"><label>×¢×œ ×”×—×‘×¨×”</label><textarea rows="4"></textarea></div></div><div class="full-concept-card" style="background:#f0f4ff;border-right:6px solid #4834d4;"><div class="form-group"><label>×¢×œ ×”×ª×§×©×•×¨×ª</label><textarea rows="4"></textarea></div></div><div class="full-concept-card" style="background:#fff9db;border-right:6px solid #f1c40f;"><div class="form-group"><label>×¢×œ ×¢×¦××™</label><textarea rows="4"></textarea></div></div></div></div><div class="teacher-notes-section"><div class="teacher-notes-title"><span class="material-icons-round">chat</span> ×”×¢×¨×•×ª ××•×¨×”</div><textarea id="notes-2" class="teacher-notes-textarea" readonly style="background:#fffde7;"></textarea></div><div class="footer-action"><button class="btn-save-changes" onclick="saveToCloud()">â˜ï¸ ×©××™×¨×”</button><button class="btn-back-lobby" onclick="showPage('lobby-zirot')">×—×–×¨×”</button></div></div>

        <!-- ×–×™×¨×•×ª 3-9 (×ª×‘× ×™×ª ×–×”×”) -->
        <div id="z-3" class="page"><h1 style="color:var(--c-3);">×–×™×¨×” 3: ×—×“×©×•×ª ×•×¦×™×œ×•×</h1><div class="chapter-box" style="border-right-color:var(--c-3);"><div class="chapter-header" onclick="toggleChapter(this)"><div class="chapter-title" style="color:var(--c-3);">×¤×¨×§ 1: ××•×©×’×™×</div><div class="btn-open-chapter">×¤×ª×—</div></div><div class="chapter-content"><div class="full-concept-card" style="background:#f3e5f5;border-right:6px solid #8e44ad;"><span class="card-num">#1</span><div class="form-group"><label>×”××•×©×’:</label><input type="text" value=""></div><div class="form-group"><label>×”×¡×‘×¨:</label><textarea rows="2"></textarea></div><div class="form-group"><label>×§×™×©×•×¨:</label><input type="text" class="allow-paste" value=""></div><div class="form-group"><label>×”×§×©×¨:</label><textarea rows="2"></textarea></div></div><div class="full-concept-card" style="background:#e3f2fd;border-right:6px solid #2196f3;"><span class="card-num">#2</span><div class="form-group"><label>×”××•×©×’:</label><input type="text" value=""></div><div class="form-group"><label>×”×¡×‘×¨:</label><textarea rows="2"></textarea></div><div class="form-group"><label>×§×™×©×•×¨:</label><input type="text" class="allow-paste" value=""></div><div class="form-group"><label>×”×§×©×¨:</label><textarea rows="2"></textarea></div></div><div class="full-concept-card" style="background:#fffde7;border-right:6px solid #fbc02d;"><span class="card-num">#3</span><div class="form-group"><label>×”××•×©×’:</label><input type="text" value=""></div><div class="form-group"><label>×”×¡×‘×¨:</label><textarea rows="2"></textarea></div><div class="form-group"><label>×§×™×©×•×¨:</label><input type="text" class="allow-paste" value=""></div><div class="form-group"><label>×”×§×©×¨:</label><textarea rows="2"></textarea></div></div><div class="full-concept-card" style="background:#fce4ec;border-right:6px solid #e91e63;"><span class="card-num">#4</span><div class="form-group"><label>×”××•×©×’:</label><input type="text" value=""></div><div class="form-group"><label>×”×¡×‘×¨:</label><textarea rows="2"></textarea></div><div class="form-group"><label>×§×™×©×•×¨:</label><input type="text" class="allow-paste" value=""></div><div class="form-group"><label>×”×§×©×¨:</label><textarea rows="2"></textarea></div></div></div></div><div class="chapter-box" style="border-right-color:var(--c-3);"><div class="chapter-header" onclick="toggleChapter(this)"><div class="chapter-title" style="color:var(--c-3);">×¤×¨×§ 2: ×“×™×œ××•×ª</div><div class="btn-open-chapter">×¤×ª×—</div></div><div class="chapter-content"><div style="background:#f3e5f5;border-right:6px solid #8e44ad;padding:20px;border-radius:15px;margin-bottom:20px;"><h3 style="margin-top:0;">ğŸ‘¤ ×“×™×œ××” ××™×©×™×ª</h3><div class="form-group"><label>×ª×™××•×¨:</label><textarea rows="3"></textarea></div><div class="vs-grid"><div class="vs-box"><h4>×“×¨×š ×'</h4><input type="text" value=""><div class="gain"><label>×¨×•×•×—:</label><input type="text" value=""></div><div class="cost"><label>××—×™×¨:</label><input type="text" value=""></div></div><div class="vs-box"><h4>×“×¨×š ×‘'</h4><input type="text" value=""><div class="gain"><label>×¨×•×•×—:</label><input type="text" value=""></div><div class="cost"><label>××—×™×¨:</label><input type="text" value=""></div></div></div><div class="form-group" style="margin-top:12px;"><label>×”×›×¨×¢×”:</label><textarea rows="2"></textarea></div><div class="form-group"><label>×¤×ª×¨×•×Ÿ:</label><textarea rows="2"></textarea></div></div><div style="background:#ede7f6;border-right:6px solid #673ab7;padding:20px;border-radius:15px;"><h3 style="margin-top:0;">ğŸ¥ ×“×™×œ××” ××§×¦×•×¢×™×ª</h3><div class="form-group"><label>×ª×™××•×¨:</label><textarea rows="3"></textarea></div><div class="vs-grid"><div class="vs-box"><h4>×“×¨×š ×'</h4><input type="text" value=""><div class="gain"><label>×¨×•×•×—:</label><input type="text" value=""></div><div class="cost"><label>××—×™×¨:</label><input type="text" value=""></div></div><div class="vs-box"><h4>×“×¨×š ×‘'</h4><input type="text" value=""><div class="gain"><label>×¨×•×•×—:</label><input type="text" value=""></div><div class="cost"><label>××—×™×¨:</label><input type="text" value=""></div></div></div><div class="form-group" style="margin-top:12px;"><label>×”×›×¨×¢×”:</label><textarea rows="2"></textarea></div><div class="form-group"><label>×¤×ª×¨×•×Ÿ:</label><textarea rows="2"></textarea></div></div></div></div><div class="chapter-box" style="border-right-color:var(--c-3);"><div class="chapter-header" onclick="toggleChapter(this)"><div class="chapter-title" style="color:var(--c-3);">×¤×¨×§ 3: ××•×¨×™×™× ×•×ª</div><div class="btn-open-chapter">×¤×ª×—</div></div><div class="chapter-content"><div class="full-concept-card" style="background:#fdf0ff;border-right:6px solid #be2edd;"><div class="form-group"><label>×¢×œ ×”×—×‘×¨×”</label><textarea rows="4"></textarea></div></div><div class="full-concept-card" style="background:#f0f4ff;border-right:6px solid #4834d4;"><div class="form-group"><label>×¢×œ ×”×ª×§×©×•×¨×ª</label><textarea rows="4"></textarea></div></div><div class="full-concept-card" style="background:#fff9db;border-right:6px solid #f1c40f;"><div class="form-group"><label>×¢×œ ×¢×¦××™</label><textarea rows="4"></textarea></div></div></div></div><div class="teacher-notes-section"><div class="teacher-notes-title"><span class="material-icons-round">chat</span> ×”×¢×¨×•×ª ××•×¨×”</div><textarea id="notes-3" class="teacher-notes-textarea" readonly style="background:#fffde7;"></textarea></div><div class="footer-action"><button class="btn-save-changes" onclick="saveToCloud()">â˜ï¸ ×©××™×¨×”</button><button class="btn-back-lobby" onclick="showPage('lobby-zirot')">×—×–×¨×”</button></div></div>
        <div id="z-4" class="page"><h1 style="color:var(--c-4);">×–×™×¨×” 4: ×”×•××•×¨ ×•×¡××˜×™×¨×”</h1><div class="chapter-box" style="border-right-color:var(--c-4);"><div class="chapter-header" onclick="toggleChapter(this)"><div class="chapter-title" style="color:var(--c-4);">×¤×¨×§ 1: ××•×©×’×™×</div><div class="btn-open-chapter">×¤×ª×—</div></div><div class="chapter-content"><div class="full-concept-card" style="background:#f3e5f5;border-right:6px solid #8e44ad;"><span class="card-num">#1</span><div class="form-group"><label>×”××•×©×’:</label><input type="text" value=""></div><div class="form-group"><label>×”×¡×‘×¨:</label><textarea rows="2"></textarea></div><div class="form-group"><label>×§×™×©×•×¨:</label><input type="text" class="allow-paste" value=""></div><div class="form-group"><label>×”×§×©×¨:</label><textarea rows="2"></textarea></div></div><div class="full-concept-card" style="background:#e3f2fd;border-right:6px solid #2196f3;"><span class="card-num">#2</span><div class="form-group"><label>×”××•×©×’:</label><input type="text" value=""></div><div class="form-group"><label>×”×¡×‘×¨:</label><textarea rows="2"></textarea></div><div class="form-group"><label>×§×™×©×•×¨:</label><input type="text" class="allow-paste" value=""></div><div class="form-group"><label>×”×§×©×¨:</label><textarea rows="2"></textarea></div></div><div class="full-concept-card" style="background:#fffde7;border-right:6px solid #fbc02d;"><span class="card-num">#3</span><div class="form-group"><label>×”××•×©×’:</label><input type="text" value=""></div><div class="form-group"><label>×”×¡×‘×¨:</label><textarea rows="2"></textarea></div><div class="form-group"><label>×§×™×©×•×¨:</label><input type="text" class="allow-paste" value=""></div><div class="form-group"><label>×”×§×©×¨:</label><textarea rows="2"></textarea></div></div><div class="full-concept-card" style="background:#fce4ec;border-right:6px solid #e91e63;"><span class="card-num">#4</span><div class="form-group"><label>×”××•×©×’:</label><input type="text" value=""></div><div class="form-group"><label>×”×¡×‘×¨:</label><textarea rows="2"></textarea></div><div class="form-group"><label>×§×™×©×•×¨:</label><input type="text" class="allow-paste" value=""></div><div class="form-group"><label>×”×§×©×¨:</label><textarea rows="2"></textarea></div></div></div></div><div class="chapter-box" style="border-right-color:var(--c-4);"><div class="chapter-header" onclick="toggleChapter(this)"><div class="chapter-title" style="color:var(--c-4);">×¤×¨×§ 2: ×“×™×œ××•×ª</div><div class="btn-open-chapter">×¤×ª×—</div></div><div class="chapter-content"><div style="background:#f3e5f5;border-right:6px solid #8e44ad;padding:20px;border-radius:15px;margin-bottom:20px;"><h3 style="margin-top:0;">ğŸ‘¤ ×“×™×œ××” ××™×©×™×ª</h3><div class="form-group"><label>×ª×™××•×¨:</label><textarea rows="3"></textarea></div><div class="vs-grid"><div class="vs-box"><h4>×“×¨×š ×'</h4><input type="text" value=""><div class="gain"><label>×¨×•×•×—:</label><input type="text" value=""></div><div class="cost"><label>××—×™×¨:</label><input type="text" value=""></div></div><div class="vs-box"><h4>×“×¨×š ×‘'</h4><input type="text" value=""><div class="gain"><label>×¨×•×•×—:</label><input type="text" value=""></div><div class="cost"><label>××—×™×¨:</label><input type="text" value=""></div></div></div><div class="form-group" style="margin-top:12px;"><label>×”×›×¨×¢×”:</label><textarea rows="2"></textarea></div><div class="form-group"><label>×¤×ª×¨×•×Ÿ:</label><textarea rows="2"></textarea></div></div><div style="background:#ede7f6;border-right:6px solid #673ab7;padding:20px;border-radius:15px;"><h3 style="margin-top:0;">ğŸ¥ ×“×™×œ××” ××§×¦×•×¢×™×ª</h3><div class="form-group"><label>×ª×™××•×¨:</label><textarea rows="3"></textarea></div><div class="vs-grid"><div class="vs-box"><h4>×“×¨×š ×'</h4><input type="text" value=""><div class="gain"><label>×¨×•×•×—:</label><input type="text" value=""></div><div class="cost"><label>××—×™×¨:</label><input type="text" value=""></div></div><div class="vs-box"><h4>×“×¨×š ×‘'</h4><input type="text" value=""><div class="gain"><label>×¨×•×•×—:</label><input type="text" value=""></div><div class="cost"><label>××—×™×¨:</label><input type="text" value=""></div></div></div><div class="form-group" style="margin-top:12px;"><label>×”×›×¨×¢×”:</label><textarea rows="2"></textarea></div><div class="form-group"><label>×¤×ª×¨×•×Ÿ:</label><textarea rows="2"></textarea></div></div></div></div><div class="chapter-box" style="border-right-color:var(--c-4);"><div class="chapter-header" onclick="toggleChapter(this)"><div class="chapter-title" style="color:var(--c-4);">×¤×¨×§ 3: ××•×¨×™×™× ×•×ª</div><div class="btn-open-chapter">×¤×ª×—</div></div><div class="chapter-content"><div class="full-concept-card" style="background:#fdf0ff;border-right:6px solid #be2edd;"><div class="form-group"><label>×¢×œ ×”×—×‘×¨×”</label><textarea rows="4"></textarea></div></div><div class="full-concept-card" style="background:#f0f4ff;border-right:6px solid #4834d4;"><div class="form-group"><label>×¢×œ ×”×ª×§×©×•×¨×ª</label><textarea rows="4"></textarea></div></div><div class="full-concept-card" style="background:#fff9db;border-right:6px solid #f1c40f;"><div class="form-group"><label>×¢×œ ×¢×¦××™</label><textarea rows="4"></textarea></div></div></div></div><div class="teacher-notes-section"><div class="teacher-notes-title"><span class="material-icons-round">chat</span> ×”×¢×¨×•×ª ××•×¨×”</div><textarea id="notes-4" class="teacher-notes-textarea" readonly style="background:#fffde7;"></textarea></div><div class="footer-action"><button class="btn-save-changes" onclick="saveToCloud()">â˜ï¸ ×©××™×¨×”</button><button class="btn-back-lobby" onclick="showPage('lobby-zirot')">×—×–×¨×”</button></div></div>
        <div id="z-5" class="page"><h1 style="color:var(--c-5);">×–×™×¨×” 5: ×ª×¨×‘×•×ª ×“×™×’×™×˜×œ×™×ª</h1><div class="chapter-box" style="border-right-color:var(--c-5);"><div class="chapter-header" onclick="toggleChapter(this)"><div class="chapter-title" style="color:var(--c-5);">×¤×¨×§ 1: ××•×©×’×™×</div><div class="btn-open-chapter">×¤×ª×—</div></div><div class="chapter-content"><div class="full-concept-card" style="background:#f3e5f5;border-right:6px solid #8e44ad;"><span class="card-num">#1</span><div class="form-group"><label>×”××•×©×’:</label><input type="text" value=""></div><div class="form-group"><label>×”×¡×‘×¨:</label><textarea rows="2"></textarea></div><div class="form-group"><label>×§×™×©×•×¨:</label><input type="text" class="allow-paste" value=""></div><div class="form-group"><label>×”×§×©×¨:</label><textarea rows="2"></textarea></div></div><div class="full-concept-card" style="background:#e3f2fd;border-right:6px solid #2196f3;"><span class="card-num">#2</span><div class="form-group"><label>×”××•×©×’:</label><input type="text" value=""></div><div class="form-group"><label>×”×¡×‘×¨:</label><textarea rows="2"></textarea></div><div class="form-group"><label>×§×™×©×•×¨:</label><input type="text" class="allow-paste" value=""></div><div class="form-group"><label>×”×§×©×¨:</label><textarea rows="2"></textarea></div></div><div class="full-concept-card" style="background:#fffde7;border-right:6px solid #fbc02d;"><span class="card-num">#3</span><div class="form-group"><label>×”××•×©×’:</label><input type="text" value=""></div><div class="form-group"><label>×”×¡×‘×¨:</label><textarea rows="2"></textarea></div><div class="form-group"><label>×§×™×©×•×¨:</label><input type="text" class="allow-paste" value=""></div><div class="form-group"><label>×”×§×©×¨:</label><textarea rows="2"></textarea></div></div><div class="full-concept-card" style="background:#fce4ec;border-right:6px solid #e91e63;"><span class="card-num">#4</span><div class="form-group"><label>×”××•×©×’:</label><input type="text" value=""></div><div class="form-group"><label>×”×¡×‘×¨:</label><textarea rows="2"></textarea></div><div class="form-group"><label>×§×™×©×•×¨:</label><input type="text" class="allow-paste" value=""></div><div class="form-group"><label>×”×§×©×¨:</label><textarea rows="2"></textarea></div></div></div></div><div class="chapter-box" style="border-right-color:var(--c-5);"><div class="chapter-header" onclick="toggleChapter(this)"><div class="chapter-title" style="color:var(--c-5);">×¤×¨×§ 2: ×“×™×œ××•×ª</div><div class="btn-open-chapter">×¤×ª×—</div></div><div class="chapter-content"><div style="background:#f3e5f5;border-right:6px solid #8e44ad;padding:20px;border-radius:15px;margin-bottom:20px;"><h3 style="margin-top:0;">ğŸ‘¤ ×“×™×œ××” ××™×©×™×ª</h3><div class="form-group"><label>×ª×™××•×¨:</label><textarea rows="3"></textarea></div><div class="vs-grid"><div class="vs-box"><h4>×“×¨×š ×'</h4><input type="text" value=""><div class="gain"><label>×¨×•×•×—:</label><input type="text" value=""></div><div class="cost"><label>××—×™×¨:</label><input type="text" value=""></div></div><div class="vs-box"><h4>×“×¨×š ×‘'</h4><input type="text" value=""><div class="gain"><label>×¨×•×•×—:</label><input type="text" value=""></div><div class="cost"><label>××—×™×¨:</label><input type="text" value=""></div></div></div><div class="form-group" style="margin-top:12px;"><label>×”×›×¨×¢×”:</label><textarea rows="2"></textarea></div><div class="form-group"><label>×¤×ª×¨×•×Ÿ:</label><textarea rows="2"></textarea></div></div><div style="background:#ede7f6;border-right:6px solid #673ab7;padding:20px;border-radius:15px;"><h3 style="margin-top:0;">ğŸ¥ ×“×™×œ××” ××§×¦×•×¢×™×ª</h3><div class="form-group"><label>×ª×™××•×¨:</label><textarea rows="3"></textarea></div><div class="vs-grid"><div class="vs-box"><h4>×“×¨×š ×'</h4><input type="text" value=""><div class="gain"><label>×¨×•×•×—:</label><input type="text" value=""></div><div class="cost"><label>××—×™×¨:</label><input type="text" value=""></div></div><div class="vs-box"><h4>×“×¨×š ×‘'</h4><input type="text" value=""><div class="gain"><label>×¨×•×•×—:</label><input type="text" value=""></div><div class="cost"><label>××—×™×¨:</label><input type="text" value=""></div></div></div><div class="form-group" style="margin-top:12px;"><label>×”×›×¨×¢×”:</label><textarea rows="2"></textarea></div><div class="form-group"><label>×¤×ª×¨×•×Ÿ:</label><textarea rows="2"></textarea></div></div></div></div><div class="chapter-box" style="border-right-color:var(--c-5);"><div class="chapter-header" onclick="toggleChapter(this)"><div class="chapter-title" style="color:var(--c-5);">×¤×¨×§ 3: ××•×¨×™×™× ×•×ª</div><div class="btn-open-chapter">×¤×ª×—</div></div><div class="chapter-content"><div class="full-concept-card" style="background:#fdf0ff;border-right:6px solid #be2edd;"><div class="form-group"><label>×¢×œ ×”×—×‘×¨×”</label><textarea rows="4"></textarea></div></div><div class="full-concept-card" style="background:#f0f4ff;border-right:6px solid #4834d4;"><div class="form-group"><label>×¢×œ ×”×ª×§×©×•×¨×ª</label><textarea rows="4"></textarea></div></div><div class="full-concept-card" style="background:#fff9db;border-right:6px solid #f1c40f;"><div class="form-group"><label>×¢×œ ×¢×¦××™</label><textarea rows="4"></textarea></div></div></div></div><div class="teacher-notes-section"><div class="teacher-notes-title"><span class="material-icons-round">chat</span> ×”×¢×¨×•×ª ××•×¨×”</div><textarea id="notes-5" class="teacher-notes-textarea" readonly style="background:#fffde7;"></textarea></div><div class="footer-action"><button class="btn-save-changes" onclick="saveToCloud()">â˜ï¸ ×©××™×¨×”</button><button class="btn-back-lobby" onclick="showPage('lobby-zirot')">×—×–×¨×”</button></div></div>
        <div id="z-6" class="page"><h1 style="color:var(--c-6);">×–×™×¨×” 6: ×¨×™××œ×™×˜×™</h1><div class="chapter-box" style="border-right-color:var(--c-6);"><div class="chapter-header" onclick="toggleChapter(this)"><div class="chapter-title" style="color:var(--c-6);">×¤×¨×§ 1: ××•×©×’×™×</div><div class="btn-open-chapter">×¤×ª×—</div></div><div class="chapter-content"><div class="full-concept-card" style="background:#f3e5f5;border-right:6px solid #8e44ad;"><span class="card-num">#1</span><div class="form-group"><label>×”××•×©×’:</label><input type="text" value=""></div><div class="form-group"><label>×”×¡×‘×¨:</label><textarea rows="2"></textarea></div><div class="form-group"><label>×§×™×©×•×¨:</label><input type="text" class="allow-paste" value=""></div><div class="form-group"><label>×”×§×©×¨:</label><textarea rows="2"></textarea></div></div><div class="full-concept-card" style="background:#e3f2fd;border-right:6px solid #2196f3;"><span class="card-num">#2</span><div class="form-group"><label>×”××•×©×’:</label><input type="text" value=""></div><div class="form-group"><label>×”×¡×‘×¨:</label><textarea rows="2"></textarea></div><div class="form-group"><label>×§×™×©×•×¨:</label><input type="text" class="allow-paste" value=""></div><div class="form-group"><label>×”×§×©×¨:</label><textarea rows="2"></textarea></div></div><div class="full-concept-card" style="background:#fffde7;border-right:6px solid #fbc02d;"><span class="card-num">#3</span><div class="form-group"><label>×”××•×©×’:</label><input type="text" value=""></div><div class="form-group"><label>×”×¡×‘×¨:</label><textarea rows="2"></textarea></div><div class="form-group"><label>×§×™×©×•×¨:</label><input type="text" class="allow-paste" value=""></div><div class="form-group"><label>×”×§×©×¨:</label><textarea rows="2"></textarea></div></div><div class="full-concept-card" style="background:#fce4ec;border-right:6px solid #e91e63;"><span class="card-num">#4</span><div class="form-group"><label>×”××•×©×’:</label><input type="text" value=""></div><div class="form-group"><label>×”×¡×‘×¨:</label><textarea rows="2"></textarea></div><div class="form-group"><label>×§×™×©×•×¨:</label><input type="text" class="allow-paste" value=""></div><div class="form-group"><label>×”×§×©×¨:</label><textarea rows="2"></textarea></div></div></div></div><div class="chapter-box" style="border-right-color:var(--c-6);"><div class="chapter-header" onclick="toggleChapter(this)"><div class="chapter-title" style="color:var(--c-6);">×¤×¨×§ 2: ×“×™×œ××•×ª</div><div class="btn-open-chapter">×¤×ª×—</div></div><div class="chapter-content"><div style="background:#f3e5f5;border-right:6px solid #8e44ad;padding:20px;border-radius:15px;margin-bottom:20px;"><h3 style="margin-top:0;">ğŸ‘¤ ×“×™×œ××” ××™×©×™×ª</h3><div class="form-group"><label>×ª×™××•×¨:</label><textarea rows="3"></textarea></div><div class="vs-grid"><div class="vs-box"><h4>×“×¨×š ×'</h4><input type="text" value=""><div class="gain"><label>×¨×•×•×—:</label><input type="text" value=""></div><div class="cost"><label>××—×™×¨:</label><input type="text" value=""></div></div><div class="vs-box"><h4>×“×¨×š ×‘'</h4><input type="text" value=""><div class="gain"><label>×¨×•×•×—:</label><input type="text" value=""></div><div class="cost"><label>××—×™×¨:</label><input type="text" value=""></div></div></div><div class="form-group" style="margin-top:12px;"><label>×”×›×¨×¢×”:</label><textarea rows="2"></textarea></div><div class="form-group"><label>×¤×ª×¨×•×Ÿ:</label><textarea rows="2"></textarea></div></div><div style="background:#ede7f6;border-right:6px solid #673ab7;padding:20px;border-radius:15px;"><h3 style="margin-top:0;">ğŸ¥ ×“×™×œ××” ××§×¦×•×¢×™×ª</h3><div class="form-group"><label>×ª×™××•×¨:</label><textarea rows="3"></textarea></div><div class="vs-grid"><div class="vs-box"><h4>×“×¨×š ×'</h4><input type="text" value=""><div class="gain"><label>×¨×•×•×—:</label><input type="text" value=""></div><div class="cost"><label>××—×™×¨:</label><input type="text" value=""></div></div><div class="vs-box"><h4>×“×¨×š ×‘'</h4><input type="text" value=""><div class="gain"><label>×¨×•×•×—:</label><input type="text" value=""></div><div class="cost"><label>××—×™×¨:</label><input type="text" value=""></div></div></div><div class="form-group" style="margin-top:12px;"><label>×”×›×¨×¢×”:</label><textarea rows="2"></textarea></div><div class="form-group"><label>×¤×ª×¨×•×Ÿ:</label><textarea rows="2"></textarea></div></div></div></div><div class="chapter-box" style="border-right-color:var(--c-6);"><div class="chapter-header" onclick="toggleChapter(this)"><div class="chapter-title" style="color:var(--c-6);">×¤×¨×§ 3: ××•×¨×™×™× ×•×ª</div><div class="btn-open-chapter">×¤×ª×—</div></div><div class="chapter-content"><div class="full-concept-card" style="background:#fdf0ff;border-right:6px solid #be2edd;"><div class="form-group"><label>×¢×œ ×”×—×‘×¨×”</label><textarea rows="4"></textarea></div></div><div class="full-concept-card" style="background:#f0f4ff;border-right:6px solid #4834d4;"><div class="form-group"><label>×¢×œ ×”×ª×§×©×•×¨×ª</label><textarea rows="4"></textarea></div></div><div class="full-concept-card" style="background:#fff9db;border-right:6px solid #f1c40f;"><div class="form-group"><label>×¢×œ ×¢×¦××™</label><textarea rows="4"></textarea></div></div></div></div><div class="teacher-notes-section"><div class="teacher-notes-title"><span class="material-icons-round">chat</span> ×”×¢×¨×•×ª ××•×¨×”</div><textarea id="notes-6" class="teacher-notes-textarea" readonly style="background:#fffde7;"></textarea></div><div class="footer-action"><button class="btn-save-changes" onclick="saveToCloud()">â˜ï¸ ×©××™×¨×”</button><button class="btn-back-lobby" onclick="showPage('lobby-zirot')">×—×–×¨×”</button></div></div>
        <div id="z-7" class="page"><h1 style="color:var(--c-7);">×–×™×¨×” 7: ×§×œ×™×¤×™×</h1><div class="chapter-box" style="border-right-color:var(--c-7);"><div class="chapter-header" onclick="toggleChapter(this)"><div class="chapter-title" style="color:var(--c-7);">×¤×¨×§ 1: ××•×©×’×™×</div><div class="btn-open-chapter">×¤×ª×—</div></div><div class="chapter-content"><div class="full-concept-card" style="background:#f3e5f5;border-right:6px solid #8e44ad;"><span class="card-num">#1</span><div class="form-group"><label>×”××•×©×’:</label><input type="text" value=""></div><div class="form-group"><label>×”×¡×‘×¨:</label><textarea rows="2"></textarea></div><div class="form-group"><label>×§×™×©×•×¨:</label><input type="text" class="allow-paste" value=""></div><div class="form-group"><label>×”×§×©×¨:</label><textarea rows="2"></textarea></div></div><div class="full-concept-card" style="background:#e3f2fd;border-right:6px solid #2196f3;"><span class="card-num">#2</span><div class="form-group"><label>×”××•×©×’:</label><input type="text" value=""></div><div class="form-group"><label>×”×¡×‘×¨:</label><textarea rows="2"></textarea></div><div class="form-group"><label>×§×™×©×•×¨:</label><input type="text" class="allow-paste" value=""></div><div class="form-group"><label>×”×§×©×¨:</label><textarea rows="2"></textarea></div></div><div class="full-concept-card" style="background:#fffde7;border-right:6px solid #fbc02d;"><span class="card-num">#3</span><div class="form-group"><label>×”××•×©×’:</label><input type="text" value=""></div><div class="form-group"><label>×”×¡×‘×¨:</label><textarea rows="2"></textarea></div><div class="form-group"><label>×§×™×©×•×¨:</label><input type="text" class="allow-paste" value=""></div><div class="form-group"><label>×”×§×©×¨:</label><textarea rows="2"></textarea></div></div><div class="full-concept-card" style="background:#fce4ec;border-right:6px solid #e91e63;"><span class="card-num">#4</span><div class="form-group"><label>×”××•×©×’:</label><input type="text" value=""></div><div class="form-group"><label>×”×¡×‘×¨:</label><textarea rows="2"></textarea></div><div class="form-group"><label>×§×™×©×•×¨:</label><input type="text" class="allow-paste" value=""></div><div class="form-group"><label>×”×§×©×¨:</label><textarea rows="2"></textarea></div></div></div></div><div class="chapter-box" style="border-right-color:var(--c-7);"><div class="chapter-header" onclick="toggleChapter(this)"><div class="chapter-title" style="color:var(--c-7);">×¤×¨×§ 2: ×“×™×œ××•×ª</div><div class="btn-open-chapter">×¤×ª×—</div></div><div class="chapter-content"><div style="background:#f3e5f5;border-right:6px solid #8e44ad;padding:20px;border-radius:15px;margin-bottom:20px;"><h3 style="margin-top:0;">ğŸ‘¤ ×“×™×œ××” ××™×©×™×ª</h3><div class="form-group"><label>×ª×™××•×¨:</label><textarea rows="3"></textarea></div><div class="vs-grid"><div class="vs-box"><h4>×“×¨×š ×'</h4><input type="text" value=""><div class="gain"><label>×¨×•×•×—:</label><input type="text" value=""></div><div class="cost"><label>××—×™×¨:</label><input type="text" value=""></div></div><div class="vs-box"><h4>×“×¨×š ×‘'</h4><input type="text" value=""><div class="gain"><label>×¨×•×•×—:</label><input type="text" value=""></div><div class="cost"><label>××—×™×¨:</label><input type="text" value=""></div></div></div><div class="form-group" style="margin-top:12px;"><label>×”×›×¨×¢×”:</label><textarea rows="2"></textarea></div><div class="form-group"><label>×¤×ª×¨×•×Ÿ:</label><textarea rows="2"></textarea></div></div><div style="background:#ede7f6;border-right:6px solid #673ab7;padding:20px;border-radius:15px;"><h3 style="margin-top:0;">ğŸ¥ ×“×™×œ××” ××§×¦×•×¢×™×ª</h3><div class="form-group"><label>×ª×™××•×¨:</label><textarea rows="3"></textarea></div><div class="vs-grid"><div class="vs-box"><h4>×“×¨×š ×'</h4><input type="text" value=""><div class="gain"><label>×¨×•×•×—:</label><input type="text" value=""></div><div class="cost"><label>××—×™×¨:</label><input type="text" value=""></div></div><div class="vs-box"><h4>×“×¨×š ×‘'</h4><input type="text" value=""><div class="gain"><label>×¨×•×•×—:</label><input type="text" value=""></div><div class="cost"><label>××—×™×¨:</label><input type="text" value=""></div></div></div><div class="form-group" style="margin-top:12px;"><label>×”×›×¨×¢×”:</label><textarea rows="2"></textarea></div><div class="form-group"><label>×¤×ª×¨×•×Ÿ:</label><textarea rows="2"></textarea></div></div></div></div><div class="chapter-box" style="border-right-color:var(--c-7);"><div class="chapter-header" onclick="toggleChapter(this)"><div class="chapter-title" style="color:var(--c-7);">×¤×¨×§ 3: ××•×¨×™×™× ×•×ª</div><div class="btn-open-chapter">×¤×ª×—</div></div><div class="chapter-content"><div class="full-concept-card" style="background:#fdf0ff;border-right:6px solid #be2edd;"><div class="form-group"><label>×¢×œ ×”×—×‘×¨×”</label><textarea rows="4"></textarea></div></div><div class="full-concept-card" style="background:#f0f4ff;border-right:6px solid #4834d4;"><div class="form-group"><label>×¢×œ ×”×ª×§×©×•×¨×ª</label><textarea rows="4"></textarea></div></div><div class="full-concept-card" style="background:#fff9db;border-right:6px solid #f1c40f;"><div class="form-group"><label>×¢×œ ×¢×¦××™</label><textarea rows="4"></textarea></div></div></div></div><div class="teacher-notes-section"><div class="teacher-notes-title"><span class="material-icons-round">chat</span> ×”×¢×¨×•×ª ××•×¨×”</div><textarea id="notes-7" class="teacher-notes-textarea" readonly style="background:#fffde7;"></textarea></div><div class="footer-action"><button class="btn-save-changes" onclick="saveToCloud()">â˜ï¸ ×©××™×¨×”</button><button class="btn-back-lobby" onclick="showPage('lobby-zirot')">×—×–×¨×”</button></div></div>
        <div id="z-8" class="page"><h1 style="color:var(--c-8);">×–×™×¨×” 8: ×¡×¤×•×¨×˜</h1><div class="chapter-box" style="border-right-color:var(--c-8);"><div class="chapter-header" onclick="toggleChapter(this)"><div class="chapter-title" style="color:var(--c-8);">×¤×¨×§ 1: ××•×©×’×™×</div><div class="btn-open-chapter">×¤×ª×—</div></div><div class="chapter-content"><div class="full-concept-card" style="background:#f3e5f5;border-right:6px solid #8e44ad;"><span class="card-num">#1</span><div class="form-group"><label>×”××•×©×’:</label><input type="text" value=""></div><div class="form-group"><label>×”×¡×‘×¨:</label><textarea rows="2"></textarea></div><div class="form-group"><label>×§×™×©×•×¨:</label><input type="text" class="allow-paste" value=""></div><div class="form-group"><label>×”×§×©×¨:</label><textarea rows="2"></textarea></div></div><div class="full-concept-card" style="background:#e3f2fd;border-right:6px solid #2196f3;"><span class="card-num">#2</span><div class="form-group"><label>×”××•×©×’:</label><input type="text" value=""></div><div class="form-group"><label>×”×¡×‘×¨:</label><textarea rows="2"></textarea></div><div class="form-group"><label>×§×™×©×•×¨:</label><input type="text" class="allow-paste" value=""></div><div class="form-group"><label>×”×§×©×¨:</label><textarea rows="2"></textarea></div></div><div class="full-concept-card" style="background:#fffde7;border-right:6px solid #fbc02d;"><span class="card-num">#3</span><div class="form-group"><label>×”××•×©×’:</label><input type="text" value=""></div><div class="form-group"><label>×”×¡×‘×¨:</label><textarea rows="2"></textarea></div><div class="form-group"><label>×§×™×©×•×¨:</label><input type="text" class="allow-paste" value=""></div><div class="form-group"><label>×”×§×©×¨:</label><textarea rows="2"></textarea></div></div><div class="full-concept-card" style="background:#fce4ec;border-right:6px solid #e91e63;"><span class="card-num">#4</span><div class="form-group"><label>×”××•×©×’:</label><input type="text" value=""></div><div class="form-group"><label>×”×¡×‘×¨:</label><textarea rows="2"></textarea></div><div class="form-group"><label>×§×™×©×•×¨:</label><input type="text" class="allow-paste" value=""></div><div class="form-group"><label>×”×§×©×¨:</label><textarea rows="2"></textarea></div></div></div></div><div class="chapter-box" style="border-right-color:var(--c-8);"><div class="chapter-header" onclick="toggleChapter(this)"><div class="chapter-title" style="color:var(--c-8);">×¤×¨×§ 2: ×“×™×œ××•×ª</div><div class="btn-open-chapter">×¤×ª×—</div></div><div class="chapter-content"><div style="background:#f3e5f5;border-right:6px solid #8e44ad;padding:20px;border-radius:15px;margin-bottom:20px;"><h3 style="margin-top:0;">ğŸ‘¤ ×“×™×œ××” ××™×©×™×ª</h3><div class="form-group"><label>×ª×™××•×¨:</label><textarea rows="3"></textarea></div><div class="vs-grid"><div class="vs-box"><h4>×“×¨×š ×'</h4><input type="text" value=""><div class="gain"><label>×¨×•×•×—:</label><input type="text" value=""></div><div class="cost"><label>××—×™×¨:</label><input type="text" value=""></div></div><div class="vs-box"><h4>×“×¨×š ×‘'</h4><input type="text" value=""><div class="gain"><label>×¨×•×•×—:</label><input type="text" value=""></div><div class="cost"><label>××—×™×¨:</label><input type="text" value=""></div></div></div><div class="form-group" style="margin-top:12px;"><label>×”×›×¨×¢×”:</label><textarea rows="2"></textarea></div><div class="form-group"><label>×¤×ª×¨×•×Ÿ:</label><textarea rows="2"></textarea></div></div><div style="background:#ede7f6;border-right:6px solid #673ab7;padding:20px;border-radius:15px;"><h3 style="margin-top:0;">ğŸ¥ ×“×™×œ××” ××§×¦×•×¢×™×ª</h3><div class="form-group"><label>×ª×™××•×¨:</label><textarea rows="3"></textarea></div><div class="vs-grid"><div class="vs-box"><h4>×“×¨×š ×'</h4><input type="text" value=""><div class="gain"><label>×¨×•×•×—:</label><input type="text" value=""></div><div class="cost"><label>××—×™×¨:</label><input type="text" value=""></div></div><div class="vs-box"><h4>×“×¨×š ×‘'</h4><input type="text" value=""><div class="gain"><label>×¨×•×•×—:</label><input type="text" value=""></div><div class="cost"><label>××—×™×¨:</label><input type="text" value=""></div></div></div><div class="form-group" style="margin-top:12px;"><label>×”×›×¨×¢×”:</label><textarea rows="2"></textarea></div><div class="form-group"><label>×¤×ª×¨×•×Ÿ:</label><textarea rows="2"></textarea></div></div></div></div><div class="chapter-box" style="border-right-color:var(--c-8);"><div class="chapter-header" onclick="toggleChapter(this)"><div class="chapter-title" style="color:var(--c-8);">×¤×¨×§ 3: ××•×¨×™×™× ×•×ª</div><div class="btn-open-chapter">×¤×ª×—</div></div><div class="chapter-content"><div class="full-concept-card" style="background:#fdf0ff;border-right:6px solid #be2edd;"><div class="form-group"><label>×¢×œ ×”×—×‘×¨×”</label><textarea rows="4"></textarea></div></div><div class="full-concept-card" style="background:#f0f4ff;border-right:6px solid #4834d4;"><div class="form-group"><label>×¢×œ ×”×ª×§×©×•×¨×ª</label><textarea rows="4"></textarea></div></div><div class="full-concept-card" style="background:#fff9db;border-right:6px solid #f1c40f;"><div class="form-group"><label>×¢×œ ×¢×¦××™</label><textarea rows="4"></textarea></div></div></div></div><div class="teacher-notes-section"><div class="teacher-notes-title"><span class="material-icons-round">chat</span> ×”×¢×¨×•×ª ××•×¨×”</div><textarea id="notes-8" class="teacher-notes-textarea" readonly style="background:#fffde7;"></textarea></div><div class="footer-action"><button class="btn-save-changes" onclick="saveToCloud()">â˜ï¸ ×©××™×¨×”</button><button class="btn-back-lobby" onclick="showPage('lobby-zirot')">×—×–×¨×”</button></div></div>
        <div id="z-9" class="page"><h1 style="color:var(--c-9);">×–×™×¨×” 9: ×¤×¨×¡×•×</h1><div class="chapter-box" style="border-right-color:var(--c-9);"><div class="chapter-header" onclick="toggleChapter(this)"><div class="chapter-title" style="color:var(--c-9);">×¤×¨×§ 1: ××•×©×’×™×</div><div class="btn-open-chapter">×¤×ª×—</div></div><div class="chapter-content"><div class="full-concept-card" style="background:#f3e5f5;border-right:6px solid #8e44ad;"><span class="card-num">#1</span><div class="form-group"><label>×”××•×©×’:</label><input type="text" value=""></div><div class="form-group"><label>×”×¡×‘×¨:</label><textarea rows="2"></textarea></div><div class="form-group"><label>×§×™×©×•×¨:</label><input type="text" class="allow-paste" value=""></div><div class="form-group"><label>×”×§×©×¨:</label><textarea rows="2"></textarea></div></div><div class="full-concept-card" style="background:#e3f2fd;border-right:6px solid #2196f3;"><span class="card-num">#2</span><div class="form-group"><label>×”××•×©×’:</label><input type="text" value=""></div><div class="form-group"><label>×”×¡×‘×¨:</label><textarea rows="2"></textarea></div><div class="form-group"><label>×§×™×©×•×¨:</label><input type="text" class="allow-paste" value=""></div><div class="form-group"><label>×”×§×©×¨:</label><textarea rows="2"></textarea></div></div><div class="full-concept-card" style="background:#fffde7;border-right:6px solid #fbc02d;"><span class="card-num">#3</span><div class="form-group"><label>×”××•×©×’:</label><input type="text" value=""></div><div class="form-group"><label>×”×¡×‘×¨:</label><textarea rows="2"></textarea></div><div class="form-group"><label>×§×™×©×•×¨:</label><input type="text" class="allow-paste" value=""></div><div class="form-group"><label>×”×§×©×¨:</label><textarea rows="2"></textarea></div></div><div class="full-concept-card" style="background:#fce4ec;border-right:6px solid #e91e63;"><span class="card-num">#4</span><div class="form-group"><label>×”××•×©×’:</label><input type="text" value=""></div><div class="form-group"><label>×”×¡×‘×¨:</label><textarea rows="2"></textarea></div><div class="form-group"><label>×§×™×©×•×¨:</label><input type="text" class="allow-paste" value=""></div><div class="form-group"><label>×”×§×©×¨:</label><textarea rows="2"></textarea></div></div></div></div><div class="chapter-box" style="border-right-color:var(--c-9);"><div class="chapter-header" onclick="toggleChapter(this)"><div class="chapter-title" style="color:var(--c-9);">×¤×¨×§ 2: ×“×™×œ××•×ª</div><div class="btn-open-chapter">×¤×ª×—</div></div><div class="chapter-content"><div style="background:#f3e5f5;border-right:6px solid #8e44ad;padding:20px;border-radius:15px;margin-bottom:20px;"><h3 style="margin-top:0;">ğŸ‘¤ ×“×™×œ××” ××™×©×™×ª</h3><div class="form-group"><label>×ª×™××•×¨:</label><textarea rows="3"></textarea></div><div class="vs-grid"><div class="vs-box"><h4>×“×¨×š ×'</h4><input type="text" value=""><div class="gain"><label>×¨×•×•×—:</label><input type="text" value=""></div><div class="cost"><label>××—×™×¨:</label><input type="text" value=""></div></div><div class="vs-box"><h4>×“×¨×š ×‘'</h4><input type="text" value=""><div class="gain"><label>×¨×•×•×—:</label><input type="text" value=""></div><div class="cost"><label>××—×™×¨:</label><input type="text" value=""></div></div></div><div class="form-group" style="margin-top:12px;"><label>×”×›×¨×¢×”:</label><textarea rows="2"></textarea></div><div class="form-group"><label>×¤×ª×¨×•×Ÿ:</label><textarea rows="2"></textarea></div></div><div style="background:#ede7f6;border-right:6px solid #673ab7;padding:20px;border-radius:15px;"><h3 style="margin-top:0;">ğŸ¥ ×“×™×œ××” ××§×¦×•×¢×™×ª</h3><div class="form-group"><label>×ª×™××•×¨:</label><textarea rows="3"></textarea></div><div class="vs-grid"><div class="vs-box"><h4>×“×¨×š ×'</h4><input type="text" value=""><div class="gain"><label>×¨×•×•×—:</label><input type="text" value=""></div><div class="cost"><label>××—×™×¨:</label><input type="text" value=""></div></div><div class="vs-box"><h4>×“×¨×š ×‘'</h4><input type="text" value=""><div class="gain"><label>×¨×•×•×—:</label><input type="text" value=""></div><div class="cost"><label>××—×™×¨:</label><input type="text" value=""></div></div></div><div class="form-group" style="margin-top:12px;"><label>×”×›×¨×¢×”:</label><textarea rows="2"></textarea></div><div class="form-group"><label>×¤×ª×¨×•×Ÿ:</label><textarea rows="2"></textarea></div></div></div></div><div class="chapter-box" style="border-right-color:var(--c-9);"><div class="chapter-header" onclick="toggleChapter(this)"><div class="chapter-title" style="color:var(--c-9);">×¤×¨×§ 3: ××•×¨×™×™× ×•×ª</div><div class="btn-open-chapter">×¤×ª×—</div></div><div class="chapter-content"><div class="full-concept-card" style="background:#fdf0ff;border-right:6px solid #be2edd;"><div class="form-group"><label>×¢×œ ×”×—×‘×¨×”</label><textarea rows="4"></textarea></div></div><div class="full-concept-card" style="background:#f0f4ff;border-right:6px solid #4834d4;"><div class="form-group"><label>×¢×œ ×”×ª×§×©×•×¨×ª</label><textarea rows="4"></textarea></div></div><div class="full-concept-card" style="background:#fff9db;border-right:6px solid #f1c40f;"><div class="form-group"><label>×¢×œ ×¢×¦××™</label><textarea rows="4"></textarea></div></div></div></div><div class="teacher-notes-section"><div class="teacher-notes-title"><span class="material-icons-round">chat</span> ×”×¢×¨×•×ª ××•×¨×”</div><textarea id="notes-9" class="teacher-notes-textarea" readonly style="background:#fffde7;"></textarea></div><div class="footer-action"><button class="btn-save-changes" onclick="saveToCloud()">â˜ï¸ ×©××™×¨×”</button><button class="btn-back-lobby" onclick="showPage('lobby-zirot')">×—×–×¨×”</button></div></div>

        <div id="finish" class="page">
            <h1>â˜ï¸ ×©××™×¨×” ×‘×¢× ×Ÿ</h1>
            <div style="background:white;padding:30px;border-radius:20px;text-align:center;box-shadow:0 10px 30px rgba(0,0,0,0.1);margin-bottom:25px;">
                <span class="material-icons-round" style="font-size:70px;color:#00b894;">cloud_done</span>
                <h2>×›×œ ×”× ×ª×•× ×™× ×©×œ×š × ×©××¨×™× ××•×˜×•××˜×™×ª</h2>
                <p style="color:#666;line-height:1.6;">×œ×—×¥ ×¢×œ ×”×›×¤×ª×•×¨ ×œ×©××™×¨×” ××™×™×“×™×ª ×œ×¢× ×Ÿ</p>
                <button class="btn-save-all" onclick="saveToCloud()">â˜ï¸ ×©××™×¨×” ×¢×›×©×™×•</button>
            </div>
            <div style="background:linear-gradient(135deg,#667eea,#764ba2);color:white;padding:30px;border-radius:20px;text-align:center;">
                <h3 style="margin:0 0 10px;font-size:1.6rem;">ğŸ‰ ×›×œ ×”×›×‘×•×“!</h3>
                <p style="opacity:0.95;line-height:1.6;">×¡×™×™××ª× ××ª ×”×¢×‘×•×“×” ×‘×ª×™×§ ×”×œ×"×“ ×”×“×™×’×™×˜×œ×™.<br>×ª×•×“×” ×¢×œ ×”××××¥ ×©×”×©×§×¢×ª×!</p>
            </div>
        </div>

    </div><!-- glass-container -->
</div><!-- studentScreen -->

<!-- ===== ××¡×š ××•×¨×” ===== -->
<div id="teacherScreen">
    <div class="topbar">
        <div>
            <div class="topbar-title">×ª×§×©×•×¨×ª ×•×—×‘×¨×” â€“ ××¡×œ×•×œ ×œ×"×“</div>
            <div class="topbar-user" id="teacherTopbarName"></div>
        </div>
        <button class="btn-logout" onclick="logout()">×™×¦×™××”</button>
    </div>
    <div class="teacher-container">
        <div class="teacher-header">
            <div class="class-title" id="teacherClassTitle">ğŸ‘©â€ğŸ« ×ª×œ××™×“×™ ×”×›×™×ª×•×ª ×©×œ×™</div>
            <p style="color:#888;margin:5px 0 0;">×œ×—×¥ ×¢×œ ×ª×œ××™×“ ×œ×¦×¤×™×™×” ×‘×ª×™×§ ×©×œ×•</p>
        </div>
        <div class="students-grid" id="studentsGrid"></div>
    </div>

    <!-- ××•×“×œ ×¦×¤×™×™×” ×‘×ª×™×§ ×ª×œ××™×“ -->
    <div class="teacher-view-modal" id="teacherViewModal">
        <div class="teacher-view-content">
            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:15px;">
                <h2 id="viewingStudentName" style="margin:0;color:var(--primary);"></h2>
                <button class="btn-close-modal" onclick="closeStudentView()">âœ• ×¡×’×™×¨×”</button>
            </div>
            <div class="readonly-note">ğŸ‘ï¸ ××¦×‘ ×¦×¤×™×™×” â€“ ×”× ×ª×•× ×™× ×©×œ ×”×ª×œ××™×“. × ×™×ª×Ÿ ×œ×›×ª×•×‘ ×”×¢×¨×•×ª ×‘×©×“×•×ª ×”×”×¢×¨×•×ª.</div>
            <div id="teacherStudentContent"></div>
        </div>
    </div>
</div>

<!-- ===== ××¡×š ×× ×”×œ ===== -->
<div id="adminScreen">
    <div class="topbar">
        <div>
            <div class="topbar-title">×ª×§×©×•×¨×ª ×•×—×‘×¨×” â€“ ××¡×œ×•×œ ×œ×"×“</div>
            <div class="topbar-user">âš™ï¸ ×××©×§ × ×™×”×•×œ</div>
        </div>
        <button class="btn-logout" onclick="logout()">×™×¦×™××”</button>
    </div>
    <div class="admin-container">
        <div class="admin-tabs">
            <button class="admin-tab-btn active" onclick="switchAdminTab('students')">ğŸ‘¥ ×ª×œ××™×“×™×</button>
            <button class="admin-tab-btn" onclick="switchAdminTab('teachers')">ğŸ‘©â€ğŸ« ××•×¨×™×</button>
            <button class="admin-tab-btn" onclick="switchAdminTab('overview')">ğŸ“Š ×¡×§×™×¨×” ×›×œ×œ×™×ª</button>
        </div>

        <!-- ×œ×©×•× ×™×ª ×ª×œ××™×“×™× -->
        <div id="adminStudents" class="admin-panel active">

            <!-- ×”×¢×œ××ª Excel -->
            <div class="admin-card">
                <h2>ğŸ“¤ ×”×¢×œ××ª ×ª×œ××™×“×™× ×-Excel</h2>
                <p style="color:#666;margin-top:-10px;">×”×¢×œ×” ×§×•×‘×¥ Excel ×¢× ×¢××•×“×•×ª: <strong>×ª×– | ×©× | ×›×™×ª×”</strong></p>
                <div class="excel-drop" id="excelDrop" onclick="document.getElementById('excelFile').click()">
                    <span class="material-icons-round" style="font-size:40px;color:#aaa;display:block;margin-bottom:10px;">upload_file</span>
                    <div style="font-size:1.1rem;font-weight:700;color:#555;">×œ×—×¥ ×œ×‘×—×™×¨×ª ×§×•×‘×¥ Excel</div>
                    <div style="color:#aaa;font-size:0.85rem;margin-top:5px;">xlsx, xls, csv</div>
                </div>
                <input type="file" id="excelFile" accept=".xlsx,.xls,.csv" style="display:none" onchange="handleExcelUpload(this)">
                <div id="excelPreview" style="display:none;">
                    <div style="background:#f0f9ff;border:2px solid #00b894;border-radius:12px;padding:15px;margin-bottom:15px;">
                        <div style="font-weight:700;color:#00b894;margin-bottom:10px;" id="excelSummary"></div>
                        <div class="excel-preview" id="excelTable"></div>
                    </div>
                    <button class="btn-admin btn-primary" onclick="importAllStudents()" style="width:100%;padding:14px;font-size:1.05rem;">
                        âœ… ×™×™×‘×•× ×›×œ ×”×ª×œ××™×“×™× ×œ-Firebase
                    </button>
                </div>
            </div>

            <!-- ×”×•×¡×¤×” ×™×“× ×™×ª -->
            <div class="admin-card">
                <h2>â• ×”×•×¡×¤×ª ×ª×œ××™×“ ×™×“× ×™×ª</h2>
                <div class="admin-form">
                    <input type="text" id="newStudentId" placeholder="×ª×¢×•×“×ª ×–×”×•×ª (9 ×¡×¤×¨×•×ª)">
                    <input type="text" id="newStudentName" placeholder="×©× ××œ×">
                    <input type="text" id="newStudentClass" placeholder='×›×™×ª×” (×œ××©×œ: ×™ ×œ××“ ×)'>
                    <button class="btn-admin btn-primary" onclick="addStudent()">×”×•×¡×¤×”</button>
                </div>
            </div>
            <div class="admin-card">
                <h2>ğŸ“‹ ×¨×©×™××ª ×ª×œ××™×“×™×</h2>
                <div style="margin-bottom:15px;">
                    <input type="text" id="searchStudent" placeholder="×—×™×¤×•×© ×œ×¤×™ ×©× ××• ×›×™×ª×”..." onkeyup="filterStudents()" style="padding:10px 15px;border:2px solid #eee;border-radius:10px;width:100%;font-family:inherit;">
                </div>
                <div style="overflow-x:auto;">
                    <table class="admin-table" id="studentsTable">
                        <thead><tr><th>×ª×¢×•×“×ª ×–×”×•×ª</th><th>×©×</th><th>×›×™×ª×”</th><th>×”×ª×§×“××•×ª</th><th>×¤×¢×•×œ×•×ª</th></tr></thead>
                        <tbody id="studentsTableBody"></tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- ×œ×©×•× ×™×ª ××•×¨×™× -->
        <div id="adminTeachers" class="admin-panel">
            <div class="admin-card">
                <h2>â• ×”×•×¡×¤×ª ××•×¨×”</h2>
                <div class="admin-form">
                    <input type="text" id="newTeacherUsername" placeholder="×©× ××©×ª××©">
                    <input type="text" id="newTeacherPassword" placeholder="×¡×™×¡××”">
                    <input type="text" id="newTeacherName" placeholder="×©× ××œ×">
                    <input type="text" id="newTeacherClasses" placeholder='×›×™×ª×•×ª (××•×¤×¨×“×•×ª ×‘×¤×¡×™×§: ×™ ×œ××“ ×, ×™ ×œ××“ ×‘)'>
                    <button class="btn-admin btn-primary" onclick="addTeacher()">×”×•×¡×¤×”</button>
                </div>
            </div>
            <div class="admin-card">
                <h2>ğŸ“‹ ×¨×©×™××ª ××•×¨×™×</h2>
                <table class="admin-table" id="teachersTable">
                    <thead><tr><th>×©× ××©×ª××©</th><th>×©× ××œ×</th><th>×›×™×ª×•×ª</th><th>×¤×¢×•×œ×•×ª</th></tr></thead>
                    <tbody id="teachersTableBody"></tbody>
                </table>
            </div>
        </div>

        <!-- ×œ×©×•× ×™×ª ×¡×§×™×¨×” -->
        <div id="adminOverview" class="admin-panel">
            <div class="dashboard-grid" style="margin-bottom:20px;">
                <div class="stat-card" style="border-color:#667eea;"><span class="stat-icon">ğŸ‘¥</span><div class="stat-number" id="adminTotalStudents" style="color:#667eea;">0</div><div class="stat-label">×¡×”"×› ×ª×œ××™×“×™×</div></div>
                <div class="stat-card" style="border-color:#00b894;"><span class="stat-icon">âœ…</span><div class="stat-number" id="adminAvgProgress" style="color:#00b894;">0%</div><div class="stat-label">×”×ª×§×“××•×ª ×××•×¦×¢×ª</div></div>
                <div class="stat-card" style="border-color:#fd79a8;"><span class="stat-icon">ğŸ‘©â€ğŸ«</span><div class="stat-number" id="adminTotalTeachers" style="color:#fd79a8;">0</div><div class="stat-label">××•×¨×™× ×‘××¢×¨×›×ª</div></div>
            </div>
            <div class="admin-card">
                <h2>ğŸ“Š ×”×ª×§×“××•×ª ×œ×¤×™ ×›×™×ª×•×ª</h2>
                <div id="classesOverview"></div>
            </div>
        </div>
    </div>
</div>

<div class="save-toast" id="saveToast">â˜ï¸ × ×©××¨ ×‘×”×¦×œ×—×”!</div>
<div class="copy-warning" id="copyWarning">âŒ ×”×¢×ª×§×” ×—×¡×•××”!</div>

<script>
// ===== SheetJS ×œ×§×¨×™××ª Excel =====
function loadSheetJS(callback) {
    if (window.XLSX) { callback(); return; }
    const script = document.createElement('script');
    script.src = 'https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js';
    script.onload = callback;
    document.head.appendChild(script);
}

let excelStudentsData = [];

function handleExcelUpload(input) {
    const file = input.files[0];
    if (!file) return;
    loadSheetJS(() => {
        const reader = new FileReader();
        reader.onload = function(e) {
            const workbook = XLSX.read(e.target.result, { type: 'binary' });
            const sheet = workbook.Sheets[workbook.SheetNames[0]];
            const rows = XLSX.utils.sheet_to_json(sheet, { header: 1 });
            excelStudentsData = [];
            const headers = rows[0] ? rows[0].map(h => String(h).trim()) : [];
            let idCol = headers.findIndex(h => h.includes('×ª×–') || h.includes('×–×”×•×ª') || h.toLowerCase().includes('id'));
            let nameCol = headers.findIndex(h => h.includes('×©×') || h.toLowerCase().includes('name'));
            let classCol = headers.findIndex(h => h.includes('×›×™×ª×”') || h.toLowerCase().includes('class'));
            if (idCol === -1) idCol = 0;
            if (nameCol === -1) nameCol = 1;
            if (classCol === -1) classCol = 2;
            for (let i = 1; i < rows.length; i++) {
                const row = rows[i];
                if (!row || row.length === 0) continue;
                const id = String(row[idCol] || '').trim();
                const name = String(row[nameCol] || '').trim();
                const cls = String(row[classCol] || '').trim();
                if (id && name) excelStudentsData.push({ id, name, class: cls });
            }
            showExcelPreview();
        };
        reader.readAsBinaryString(file);
    });
}

function showExcelPreview() {
    document.getElementById('excelPreview').style.display = 'block';
    document.getElementById('excelSummary').textContent = `âœ… × ××¦××• ${excelStudentsData.length} ×ª×œ××™×“×™× â€“ ×‘×“×•×§ ×œ×¤× ×™ ×™×™×‘×•×:`;
    let html = `<table style="width:100%;border-collapse:collapse;font-size:0.9rem;">
        <thead><tr style="background:#e0f0ff;">
            <th style="padding:8px;border:1px solid #ddd;">×ª×–</th>
            <th style="padding:8px;border:1px solid #ddd;">×©×</th>
            <th style="padding:8px;border:1px solid #ddd;">×›×™×ª×”</th>
        </tr></thead><tbody>`;
    excelStudentsData.slice(0, 10).forEach(s => {
        html += `<tr><td style="padding:7px;border:1px solid #eee;">${s.id}</td><td style="padding:7px;border:1px solid #eee;">${s.name}</td><td style="padding:7px;border:1px solid #eee;">${s.class}</td></tr>`;
    });
    if (excelStudentsData.length > 10) {
        html += `<tr><td colspan="3" style="padding:8px;text-align:center;color:#888;font-style:italic;">...×•×¢×•×“ ${excelStudentsData.length - 10} ×ª×œ××™×“×™× × ×•×¡×¤×™×</td></tr>`;
    }
    html += '</tbody></table>';
    document.getElementById('excelTable').innerHTML = html;
}

function importAllStudents() {
    if (excelStudentsData.length === 0) return;
    const updates = {};
    excelStudentsData.forEach(s => { updates['students/' + s.id] = { name: s.name, class: s.class }; });
    db.ref().update(updates).then(() => {
        alert(`âœ… ×™×•×‘××• ${excelStudentsData.length} ×ª×œ××™×“×™× ×‘×”×¦×œ×—×”!`);
        document.getElementById('excelPreview').style.display = 'none';
        document.getElementById('excelFile').value = '';
        excelStudentsData = [];
        loadStudentsTable();
    }).catch(err => alert('×©×’×™××”: ' + err.message));
}

// ===== Firebase =====
const firebaseConfig = {
    apiKey: "AIzaSyBtjSP6XAO3jR7dnpANo62aVW3TNKghyS0",
    authDomain: "tikdigitalilamed.firebaseapp.com",
    projectId: "tikdigitalilamed",
    storageBucket: "tikdigitalilamed.firebasestorage.app",
    messagingSenderId: "610609459996",
    appId: "1:610609459996:web:2bc2ab02c18233769c40d9",
    databaseURL: "https://tikdigitalilamed-default-rtdb.europe-west1.firebasedatabase.app"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

// ===== ××©×ª× ×™× ×’×œ×•×‘×œ×™×™× =====
let currentUser = null;
let currentRole = null;
let micPasswordEntered = false;
const MIC_PASSWORD = 'mic2025';
const ADMIN_USER = 'admin';
const ADMIN_PASS = '14041963';

// ===== ××ª×—×•×œ: ×™×¦×™×¨×ª ××•×¨×” ×¨××©×•× ×™ =====
function initializeSystem() {
    db.ref('teachers/0001').once('value').then(snap => {
        if (!snap.exists()) {
            db.ref('teachers/0001').set({
                username: '0001',
                password: '0000',
                name: '×œ×™××•×¨ ×“×•××§',
                classes: ['×™ ×œ××“']
            });
        }
    });
}
initializeSystem();

// ===== ×˜××‘×™× ×©×œ ×›× ×™×¡×” =====
function switchLoginTab(tab) {
    document.getElementById('loginStudent').style.display = tab === 'student' ? 'block' : 'none';
    document.getElementById('loginTeacher').style.display = tab === 'teacher' ? 'block' : 'none';
    document.getElementById('loginAdmin').style.display = tab === 'admin' ? 'block' : 'none';
    document.querySelectorAll('.login-tab').forEach((t, i) => {
        t.classList.toggle('active', ['student','teacher','admin'][i] === tab);
    });
    document.getElementById('loginError').style.display = 'none';
}

// ===== ×›× ×™×¡×ª ×ª×œ××™×“ =====
function loginStudent() {
    const id = document.getElementById('studentId').value.trim();
    if (!id) { showError('×× × ×”×›× ×¡ ×ª×¢×•×“×ª ×–×”×•×ª'); return; }
    db.ref('students/' + id).once('value').then(snap => {
        if (snap.exists()) {
            const student = snap.val();
            currentUser = { id, ...student };
            currentRole = 'student';
            document.getElementById('studentTopbarName').textContent = 'ğŸ‘¤ ' + student.name + ' | ' + student.class;
            document.getElementById('loginScreen').style.display = 'none';
            document.getElementById('studentScreen').style.display = 'block';
            loadStudentData(id);
            addMicButtons();
        } else {
            showError('×ª×¢×•×“×ª ×–×”×•×ª ×œ× × ××¦××” ×‘××¢×¨×›×ª');
        }
    });
}

// ===== ×›× ×™×¡×ª ××•×¨×” =====
function loginTeacher() {
    const username = document.getElementById('teacherUsername').value.trim();
    const password = document.getElementById('teacherPassword').value.trim();
    db.ref('teachers').once('value').then(snap => {
        let found = false;
        snap.forEach(child => {
            const t = child.val();
            if (t.username === username && t.password === password) {
                found = true;
                currentUser = { key: child.key, ...t };
                currentRole = 'teacher';
                document.getElementById('teacherTopbarName').textContent = 'ğŸ‘©â€ğŸ« ' + t.name;
                document.getElementById('teacherClassTitle').textContent = 'ğŸ‘©â€ğŸ« ' + t.name + ' â€“ ×›×™×ª×•×ª: ' + t.classes.join(', ');
                document.getElementById('loginScreen').style.display = 'none';
                document.getElementById('teacherScreen').style.display = 'block';
                loadTeacherStudents(t.classes);
            }
        });
        if (!found) showError('×©× ××©×ª××© ××• ×¡×™×¡××” ×©×’×•×™×™×');
    });
}

// ===== ×›× ×™×¡×ª ×× ×”×œ =====
function loginAdmin() {
    const u = document.getElementById('adminUsername').value.trim();
    const p = document.getElementById('adminPassword').value.trim();
    if (u === ADMIN_USER && p === ADMIN_PASS) {
        currentRole = 'admin';
        document.getElementById('loginScreen').style.display = 'none';
        document.getElementById('adminScreen').style.display = 'block';
        loadAdminData();
    } else {
        showError('×¤×¨×˜×™ ×›× ×™×¡×” ×©×’×•×™×™×');
    }
}

function showError(msg) {
    const el = document.getElementById('loginError');
    el.textContent = 'âŒ ' + msg;
    el.style.display = 'block';
}

function logout() {
    currentUser = null;
    currentRole = null;
    document.getElementById('loginScreen').style.display = 'flex';
    document.getElementById('studentScreen').style.display = 'none';
    document.getElementById('teacherScreen').style.display = 'none';
    document.getElementById('adminScreen').style.display = 'none';
    document.getElementById('loginError').style.display = 'none';
    clearStudentForm();
}

// ===== × ×™×•×•×˜ ×ª×œ××™×“ =====
function showPage(pageId, btn) {
    document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
    document.getElementById(pageId).classList.add('active');
    document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
    if (btn) btn.classList.add('active');
    window.scrollTo(0, 0);
    if (pageId === 'dashboard') updateDashboard();
}

function toggleChapter(header) {
    const content = header.nextElementSibling;
    const btn = header.querySelector('.btn-open-chapter');
    const isOpen = content.style.display === 'block';
    content.style.display = isOpen ? 'none' : 'block';
    btn.textContent = isOpen ? '×¤×ª×—' : '×¡×’×•×¨';
}

// ===== ×©××™×¨×” ×œ×¢× ×Ÿ =====
function saveToCloud() {
    if (!currentUser || currentRole !== 'student') return;
    const allInputs = document.querySelectorAll('#studentScreen input[type="text"]:not(.allow-paste), #studentScreen textarea:not(.teacher-notes-textarea)');
    const data = {};
    allInputs.forEach((inp, i) => { data['f' + i] = inp.value || ''; });
    data['lastSaved'] = new Date().toISOString();
    db.ref('studentData/' + currentUser.id).set(data).then(() => {
        showSaveToast();
        updateDashboard();
    }).catch(err => alert('×©×’×™××” ×‘×©××™×¨×”: ' + err.message));
}

// ===== ×˜×¢×™× ×ª × ×ª×•× ×™ ×ª×œ××™×“ =====
function loadStudentData(id) {
    db.ref('studentData/' + id).once('value').then(snap => {
        if (!snap.exists()) return;
        const data = snap.val();
        const allInputs = document.querySelectorAll('#studentScreen input[type="text"]:not(.allow-paste), #studentScreen textarea:not(.teacher-notes-textarea)');
        allInputs.forEach((inp, i) => {
            if (data['f' + i] !== undefined) inp.value = data['f' + i];
        });
        // ×˜×¢×™× ×ª ×”×¢×¨×•×ª ××•×¨×”
        loadTeacherNotes(id);
        updateDashboard();
    });
}

// ===== ×˜×¢×™× ×ª ×”×¢×¨×•×ª ××•×¨×” ×œ×ª×œ××™×“ =====
function loadTeacherNotes(studentId) {
    db.ref('teacherNotes/' + studentId).once('value').then(snap => {
        if (!snap.exists()) return;
        const notes = snap.val();
        ['al','1','2','3','4','5','6','7','8','9'].forEach(z => {
            const el = document.getElementById('notes-' + z);
            if (el && notes['z' + z]) el.value = notes['z' + z];
        });
    });
}

function clearStudentForm() {
    document.querySelectorAll('#studentScreen input[type="text"], #studentScreen textarea').forEach(el => el.value = '');
}

// ===== ×ª××•× ×ª ××¦×‘ =====
function updateDashboard() {
    const arenas = ['z-al','z-1','z-2','z-3','z-4','z-5','z-6','z-7','z-8','z-9'];
    const arenaColors = {'z-al':'#6c5ce7','z-1':'#0984e3','z-2':'#00cec9','z-3':'#d63031','z-4':'#e1b12c','z-5':'#00b894','z-6':'#e17055','z-7':'#be2edd','z-8':'#4834d4','z-9':'#e84393'};
    const arenaNames = {'z-al':'×–×™×¨×ª ×”×¢×œ','z-1':'××¦×™××•×ª ×ª×§×©×•×¨×ª×™×ª','z-2':'×’×œ×•×‘×œ×™×–×¦×™×”','z-3':'×—×“×©×•×ª ×•×¦×™×œ×•×','z-4':'×”×•××•×¨ ×•×¡××˜×™×¨×”','z-5':'×ª×¨×‘×•×ª ×“×™×’×™×˜×œ×™×ª','z-6':'×¨×™××œ×™×˜×™','z-7':'×§×œ×™×¤×™×','z-8':'×¡×¤×•×¨×˜','z-9':'×¤×¨×¡×•×'};
    let totalFields=0, filledFields=0, completedArenas=0, totalConcepts=0, totalDilemmas=0;
    let arenaListHTML='';
    const arenaProgressMap={};
    arenas.forEach(arenaId => {
        const arena = document.getElementById(arenaId);
        if (!arena) return;
        const inputs = arena.querySelectorAll('input[type="text"]:not(.allow-paste), textarea:not(.teacher-notes-textarea)');
        let arenaTotal=inputs.length, arenaFilled=0;
        inputs.forEach(inp => { if(inp.value.trim()!=='') arenaFilled++; });
        totalFields+=arenaTotal; filledFields+=arenaFilled;
        const arenaProgress = arenaTotal>0?Math.round((arenaFilled/arenaTotal)*100):0;
        arenaProgressMap[arenaId]=arenaProgress;
        if(arenaProgress===100) completedArenas++;
        arena.querySelectorAll('.full-concept-card').forEach(card=>{
            const ci=card.querySelectorAll('input,textarea'); let cf=true;
            ci.forEach(i=>{if(i.value.trim()==='')cf=false;});
            if(cf&&ci.length>0)totalConcepts++;
        });
        arena.querySelectorAll('h3').forEach(h3=>{
            if(h3.textContent.includes('×“×™×œ××”')){
                const p=h3.closest('div[style*="border-right"]');
                if(p){const di=p.querySelectorAll('input,textarea');let df=true;di.forEach(i=>{if(i.value.trim()==='')df=false;});if(df&&di.length>0)totalDilemmas++;}
            }
        });
        const bClass=arenaProgress===100?'badge-complete':arenaProgress>0?'badge-partial':'badge-empty';
        const bText=arenaProgress===100?'×”×•×©×œ×':arenaProgress>0?'×‘×ª×”×œ×™×š':'×œ× ×”×ª×—×™×œ';
        arenaListHTML+=`<div class="arena-status" style="border-color:${arenaColors[arenaId]};"><div class="arena-name" style="color:${arenaColors[arenaId]};">${arenaNames[arenaId]}</div><div class="arena-progress"><span class="badge ${bClass}">${bText}</span><div class="mini-progress"><div class="mini-progress-fill" style="width:${arenaProgress}%;background:${arenaColors[arenaId]};"></div></div><span style="font-weight:bold;color:#555;">${arenaProgress}%</span></div></div>`;
    });
    const totalProgress=totalFields>0?Math.round((filledFields/totalFields)*100):0;
    document.getElementById('totalProgress').textContent=totalProgress+'%';
    document.getElementById('totalProgressBar').style.width=totalProgress+'%';
    document.getElementById('conceptsCount').textContent=totalConcepts;
    document.getElementById('dilemmasCount').textContent=totalDilemmas;
    document.getElementById('arenasCount').textContent=completedArenas+'/10';
    document.getElementById('arenasList').innerHTML=arenaListHTML;
    document.querySelectorAll('.card').forEach((card,index)=>{
        const arenaId=arenas[index]; if(!arenaId)return;
        const ap=arenaProgressMap[arenaId]||0;
        let ind=card.querySelector('.progress-indicator');
        if(!ind){ind=document.createElement('div');ind.className='progress-indicator';card.appendChild(ind);}
        ind.style.setProperty('--progress',ap+'%');
        ind.innerHTML=`<span>${ap}%</span>`;
        let badge=card.querySelector('.completion-badge');
        if(ap===100){if(!badge){badge=document.createElement('div');badge.className='completion-badge';badge.innerHTML='âœ“';card.appendChild(badge);}}
        else if(badge)badge.remove();
    });
}

// ===== ××•×¨×”: ×˜×¢×™× ×ª ×ª×œ××™×“×™× =====
function loadTeacherStudents(classes) {
    db.ref('students').once('value').then(snap => {
        const grid = document.getElementById('studentsGrid');
        grid.innerHTML = '';
        const students = [];
        snap.forEach(child => {
            const s = child.val();
            if (classes.some(c => s.class && s.class.includes(c.trim()))) {
                students.push({ id: child.key, ...s });
            }
        });
        if (students.length === 0) {
            grid.innerHTML = '<p style="color:#888;">×œ× × ××¦××• ×ª×œ××™×“×™× ×‘×›×™×ª×•×ª ××œ×•. ×‘×§×© ××”×× ×”×œ ×œ×”×•×¡×™×£ ×ª×œ××™×“×™×.</p>';
            return;
        }
        students.forEach(s => {
            db.ref('studentData/' + s.id).once('value').then(dataSnap => {
                const data = dataSnap.val() || {};
                const progress = calcProgress(data);
                const card = document.createElement('div');
                card.className = 'student-card';
                card.innerHTML = `
                    <div class="student-name">ğŸ‘¤ ${s.name}</div>
                    <div class="student-class">${s.class}</div>
                    <div class="student-progress-bar"><div class="student-progress-fill" style="width:${progress}%"></div></div>
                    <div class="student-progress-text">×”×ª×§×“××•×ª: ${progress}%</div>
                `;
                card.onclick = () => openStudentView(s, data);
                grid.appendChild(card);
            });
        });
    });
}

function calcProgress(data) {
    const keys = Object.keys(data).filter(k => k.startsWith('f'));
    if (keys.length === 0) return 0;
    const filled = keys.filter(k => data[k] && data[k].trim() !== '').length;
    return Math.round((filled / keys.length) * 100);
}

// ===== ××•×¨×”: ×¦×¤×™×™×” ×‘×ª×™×§ ×ª×œ××™×“ =====
function openStudentView(student, data) {
    document.getElementById('viewingStudentName').textContent = 'ğŸ“‚ ×ª×™×§ ×©×œ ' + student.name;
    document.getElementById('teacherViewModal').style.display = 'block';

    // ×˜×¢×™× ×ª ×”×¢×¨×•×ª ××•×¨×” ×§×™×™××•×ª
    db.ref('teacherNotes/' + student.id).once('value').then(snap => {
        const notes = snap.val() || {};
        const arenas = ['al','1','2','3','4','5','6','7','8','9'];
        const arenaNames = {'al':'×–×™×¨×ª ×”×¢×œ','1':'××¦×™××•×ª ×ª×§×©×•×¨×ª×™×ª','2':'×’×œ×•×‘×œ×™×–×¦×™×”','3':'×—×“×©×•×ª ×•×¦×™×œ×•×','4':'×”×•××•×¨ ×•×¡××˜×™×¨×”','5':'×ª×¨×‘×•×ª ×“×™×’×™×˜×œ×™×ª','6':'×¨×™××œ×™×˜×™','7':'×§×œ×™×¤×™×','8':'×¡×¤×•×¨×˜','9':'×¤×¨×¡×•×'};
        const arenaColors = {'al':'#6c5ce7','1':'#0984e3','2':'#00cec9','3':'#d63031','4':'#e1b12c','5':'#00b894','6':'#e17055','7':'#be2edd','8':'#4834d4','9':'#e84393'};

        let html = `<div style="background:white;border-radius:15px;padding:20px;margin-bottom:20px;box-shadow:0 5px 15px rgba(0,0,0,0.07);">
            <h3 style="color:var(--primary);margin-top:0;">ğŸ“Š ×”×ª×§×“××•×ª: ${calcProgress(data)}%</h3>
            <div style="background:#f0f0f0;height:12px;border-radius:10px;overflow:hidden;">
                <div style="width:${calcProgress(data)}%;height:100%;background:linear-gradient(90deg,#667eea,#764ba2);border-radius:10px;"></div>
            </div>
        </div>`;

        arenas.forEach(z => {
            const color = arenaColors[z];
            html += `<div style="background:white;border-radius:15px;padding:20px;margin-bottom:15px;border-right:5px solid ${color};box-shadow:0 3px 10px rgba(0,0,0,0.06);">
                <h3 style="color:${color};margin-top:0;">${arenaNames[z]}</h3>
                <div style="background:#fff9e6;border:2px solid #ffc107;border-radius:10px;padding:15px;margin-top:10px;">
                    <label style="font-weight:700;color:#f57f17;display:block;margin-bottom:8px;">âœï¸ ×”×¢×¨×ª ××•×¨×”:</label>
                    <textarea id="tnote-${z}" rows="3" style="width:100%;padding:10px;border:1px solid #ffe082;border-radius:8px;font-family:inherit;font-size:0.95rem;" placeholder="×›×ª×•×‘ ×”×¢×¨×” ×œ×ª×œ××™×“...">${notes['z'+z]||''}</textarea>
                </div>
                <button onclick="saveTeacherNote('${student.id}','${z}')" style="margin-top:10px;padding:8px 18px;background:linear-gradient(45deg,#f1c40f,#f39c12);color:white;border:none;border-radius:20px;cursor:pointer;font-weight:700;font-family:inherit;">ğŸ’¾ ×©××•×¨ ×”×¢×¨×”</button>
            </div>`;
        });

        document.getElementById('teacherStudentContent').innerHTML = html;
    });
}

function saveTeacherNote(studentId, zone) {
    const text = document.getElementById('tnote-' + zone).value;
    db.ref('teacherNotes/' + studentId + '/z' + zone).set(text).then(() => {
        showSaveToast('âœ… ×”×¢×¨×” × ×©××¨×”!');
    });
}

function closeStudentView() {
    document.getElementById('teacherViewModal').style.display = 'none';
}

// ===== ×× ×”×œ: ×˜×¢×™× ×ª × ×ª×•× ×™× =====
function loadAdminData() {
    loadStudentsTable();
    loadTeachersTable();
    loadOverview();
}

function loadStudentsTable() {
    db.ref('students').once('value').then(snap => {
        const tbody = document.getElementById('studentsTableBody');
        tbody.innerHTML = '';
        let count = 0;
        snap.forEach(child => {
            count++;
            const s = child.val();
            db.ref('studentData/' + child.key).once('value').then(dataSnap => {
                const progress = calcProgress(dataSnap.val() || {});
                const tr = document.createElement('tr');
                tr.innerHTML = `<td>${child.key}</td><td>${s.name}</td><td>${s.class}</td>
                    <td><div style="display:flex;align-items:center;gap:8px;">
                        <div style="flex:1;background:#f0f0f0;height:8px;border-radius:5px;overflow:hidden;">
                            <div style="width:${progress}%;height:100%;background:linear-gradient(90deg,#667eea,#764ba2);border-radius:5px;"></div>
                        </div><span style="font-weight:700;font-size:0.85rem;">${progress}%</span></div></td>
                    <td><button class="btn-admin btn-danger" onclick="deleteStudent('${child.key}')">××—×§</button></td>`;
                tbody.appendChild(tr);
            });
        });
        document.getElementById('adminTotalStudents').textContent = count;
    });
}

function loadTeachersTable() {
    db.ref('teachers').once('value').then(snap => {
        const tbody = document.getElementById('teachersTableBody');
        tbody.innerHTML = '';
        let count = 0;
        snap.forEach(child => {
            count++;
            const t = child.val();
            const classes = Array.isArray(t.classes) ? t.classes.join(', ') : t.classes;
            const tr = document.createElement('tr');
            tr.innerHTML = `<td>${t.username}</td><td>${t.name}</td>
                <td>${classes}</td>
                <td><button class="btn-admin btn-danger" onclick="deleteTeacher('${child.key}')">××—×§</button></td>`;
            tbody.appendChild(tr);
        });
        document.getElementById('adminTotalTeachers').textContent = count;
    });
}

function loadOverview() {
    db.ref('students').once('value').then(snap => {
        const classes = {};
        const promises = [];
        snap.forEach(child => {
            const s = child.val();
            if (!classes[s.class]) classes[s.class] = { students: [], progresses: [] };
            classes[s.class].students.push(s.name);
            promises.push(
                db.ref('studentData/' + child.key).once('value').then(dataSnap => {
                    classes[s.class].progresses.push(calcProgress(dataSnap.val() || {}));
                })
            );
        });
        Promise.all(promises).then(() => {
            let html = '';
            Object.keys(classes).forEach(cls => {
                const avg = classes[cls].progresses.length > 0
                    ? Math.round(classes[cls].progresses.reduce((a,b) => a+b, 0) / classes[cls].progresses.length)
                    : 0;
                html += `<div style="background:#f8f9ff;border-radius:12px;padding:15px;margin-bottom:12px;border-right:4px solid #667eea;">
                    <div style="display:flex;justify-content:space-between;align-items:center;">
                        <div><strong>${cls}</strong> â€“ ${classes[cls].students.length} ×ª×œ××™×“×™×</div>
                        <span style="font-weight:900;color:#667eea;">${avg}%</span>
                    </div>
                    <div style="background:#e0e0e0;height:8px;border-radius:5px;overflow:hidden;margin-top:8px;">
                        <div style="width:${avg}%;height:100%;background:linear-gradient(90deg,#667eea,#764ba2);border-radius:5px;"></div>
                    </div>
                </div>`;
            });
            document.getElementById('classesOverview').innerHTML = html || '<p style="color:#888;">××™×Ÿ × ×ª×•× ×™× ×¢×“×™×™×Ÿ</p>';
            const allProgresses = Object.values(classes).flatMap(c => c.progresses);
            const avgAll = allProgresses.length > 0
                ? Math.round(allProgresses.reduce((a,b) => a+b, 0) / allProgresses.length)
                : 0;
            document.getElementById('adminAvgProgress').textContent = avgAll + '%';
        });
    });
}

function addStudent() {
    const id = document.getElementById('newStudentId').value.trim();
    const name = document.getElementById('newStudentName').value.trim();
    const cls = document.getElementById('newStudentClass').value.trim();
    if (!id || !name || !cls) { alert('×× × ××œ× ××ª ×›×œ ×”×©×“×•×ª'); return; }
    db.ref('students/' + id).set({ name, class: cls }).then(() => {
        alert('âœ… ×ª×œ××™×“ × ×•×¡×£ ×‘×”×¦×œ×—×”!');
        document.getElementById('newStudentId').value = '';
        document.getElementById('newStudentName').value = '';
        document.getElementById('newStudentClass').value = '';
        loadStudentsTable();
    });
}

function addTeacher() {
    const username = document.getElementById('newTeacherUsername').value.trim();
    const password = document.getElementById('newTeacherPassword').value.trim();
    const name = document.getElementById('newTeacherName').value.trim();
    const classesStr = document.getElementById('newTeacherClasses').value.trim();
    if (!username || !password || !name || !classesStr) { alert('×× × ××œ× ××ª ×›×œ ×”×©×“×•×ª'); return; }
    const classes = classesStr.split(',').map(c => c.trim());
    db.ref('teachers/' + username).set({ username, password, name, classes }).then(() => {
        alert('âœ… ××•×¨×” × ×•×¡×£ ×‘×”×¦×œ×—×”!');
        document.getElementById('newTeacherUsername').value = '';
        document.getElementById('newTeacherPassword').value = '';
        document.getElementById('newTeacherName').value = '';
        document.getElementById('newTeacherClasses').value = '';
        loadTeachersTable();
    });
}

function deleteStudent(id) {
    if (!confirm('×œ××—×•×§ ××ª ×”×ª×œ××™×“? ×”× ×ª×•× ×™× ×™×™×©××¨×•.')) return;
    db.ref('students/' + id).remove().then(() => loadStudentsTable());
}

function deleteTeacher(key) {
    if (!confirm('×œ××—×•×§ ××ª ×”××•×¨×”?')) return;
    db.ref('teachers/' + key).remove().then(() => loadTeachersTable());
}

function filterStudents() {
    const q = document.getElementById('searchStudent').value.toLowerCase();
    document.querySelectorAll('#studentsTableBody tr').forEach(tr => {
        tr.style.display = tr.textContent.toLowerCase().includes(q) ? '' : 'none';
    });
}

function switchAdminTab(tab) {
    document.querySelectorAll('.admin-panel').forEach(p => p.classList.remove('active'));
    document.querySelectorAll('.admin-tab-btn').forEach(b => b.classList.remove('active'));
    document.getElementById('admin' + tab.charAt(0).toUpperCase() + tab.slice(1)).classList.add('active');
    event.target.classList.add('active');
    if (tab === 'overview') loadOverview();
}

// ===== ××™×§×¨×•×¤×•×Ÿ =====
function addMicButtons() {
    document.querySelectorAll('#studentScreen input[type="text"]:not(.allow-paste), #studentScreen textarea:not(.teacher-notes-textarea)').forEach(field => {
        if (field.parentElement.classList.contains('input-mic-wrapper')) return;
        const wrapper = document.createElement('div');
        wrapper.className = 'input-mic-wrapper';
        field.parentNode.insertBefore(wrapper, field);
        wrapper.appendChild(field);
        const btn = document.createElement('button');
        btn.type = 'button'; btn.className = 'mic-btn'; btn.title = '×œ×—×¥ ×œ×“×™×‘×•×¨';
        btn.innerHTML = '<span class="material-icons-round">mic</span>';
        btn.addEventListener('click', () => startDictation(field, btn));
        wrapper.appendChild(btn);
    });
}

function checkMicPassword() {
    if (micPasswordEntered) return true;
    const input = prompt('ğŸ” × ×“×¨×©×ª ×¡×™×¡××” ×œ×”×¤×¢×œ×ª ×”××™×§×¨×•×¤×•×Ÿ:');
    if (input === MIC_PASSWORD) { micPasswordEntered = true; return true; }
    if (input !== null) alert('âŒ ×¡×™×¡××” ×©×’×•×™×”.');
    return false;
}

function startDictation(field, btn) {
    if (!checkMicPassword()) return;
    const SR = window.SpeechRecognition || window.webkitSpeechRecognition;
    if (!SR) { alert('×”×“×¤×“×¤×Ÿ ×œ× ×ª×•××š ×‘×”×›×ª×‘×” ×§×•×œ×™×ª. × ×¡×” Chrome.'); return; }
    if (btn.classList.contains('listening')) { if (btn._r) btn._r.stop(); return; }
    const r = new SR();
    r.lang = 'he-IL'; r.interimResults = false; r.maxAlternatives = 1;
    btn._r = r; btn.classList.add('listening');
    r.onresult = e => { field.value += (field.value.trim() ? ' ' : '') + e.results[0][0].transcript; };
    r.onerror = e => console.error(e.error);
    r.onend = () => { btn.classList.remove('listening'); btn.title = '×œ×—×¥ ×œ×“×™×‘×•×¨'; };
    r.start();
}

// ===== ×—×¡×™××ª copy/paste =====
document.addEventListener('copy', e => { if(e.target.classList?.contains('allow-paste'))return; e.preventDefault(); showCopyWarning(); });
document.addEventListener('cut', e => { if(e.target.classList?.contains('allow-paste'))return; e.preventDefault(); showCopyWarning(); });
document.addEventListener('paste', e => { if(e.target.classList?.contains('allow-paste'))return; e.preventDefault(); showCopyWarning(); });
function showCopyWarning() { const w=document.getElementById('copyWarning'); w.style.display='block'; setTimeout(()=>w.style.display='none',2000); }

// ===== toast =====
function showSaveToast(msg) {
    const t = document.getElementById('saveToast');
    t.textContent = msg || 'â˜ï¸ × ×©××¨ ×‘×”×¦×œ×—×”!';
    t.style.display = 'block';
    setTimeout(() => t.style.display = 'none', 3000);
}

// ===== ×©××™×¨×” ××•×˜×•××˜×™×ª =====
setInterval(() => { if (currentRole === 'student' && currentUser) saveToCloud(); }, 60000);

// Enter ×‘×›× ×™×¡×”
document.getElementById('studentId').addEventListener('keypress', e => { if(e.key==='Enter') loginStudent(); });
document.getElementById('teacherPassword').addEventListener('keypress', e => { if(e.key==='Enter') loginTeacher(); });
document.getElementById('adminPassword').addEventListener('keypress', e => { if(e.key==='Enter') loginAdmin(); });
</script>
</body>
</html>
