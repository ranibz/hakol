<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>××•×ª×• ××™×¨×•×¢, ×¡×™×¤×•×¨ ××—×¨ â€” ×¡×™××•×œ×¦×™×™×ª ××™×¡×’×•×¨ ×ª×§×©×•×¨×ª×™</title>
<link href="https://fonts.googleapis.com/css2?family=David+Libre:wght@400;500;700&family=Frank+Ruhl+Libre:wght@300;400;500;700;900&family=Noto+Sans+Hebrew:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
<style>
:root{--ink:#1a1410;--paper:#f8f5ef;--pbr:#fefcf7;--accent:#6366f1;--accent-dk:#4f46e5;--slate:#2c3e50;--muted:#8a8070;--border:#d4cfc5;--bl:#e8e4dc;--fd:'Frank Ruhl Libre','David Libre',serif;--fb:'David Libre','Noto Sans Hebrew',serif;--fu:'Noto Sans Hebrew','David Libre',sans-serif;--r:8px;--rl:12px}
*{margin:0;padding:0;box-sizing:border-box}html{scroll-behavior:smooth}body{font-family:var(--fb);background:var(--paper);color:var(--ink);min-height:100vh;line-height:1.6}
@keyframes fadeIn{from{opacity:0}to{opacity:1}}
@keyframes slideUp{from{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}
@keyframes spin{to{transform:rotate(360deg)}}

.landing{min-height:100vh;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:40px 20px;text-align:center;background:linear-gradient(180deg,#f8f5ef,#ece6db)}
.landing-logo{font-size:4rem;margin-bottom:10px}
.landing h1{font-family:var(--fd);font-size:2.2rem;font-weight:900;margin-bottom:2px}
.landing .tagline{font-size:1rem;color:var(--muted);margin-bottom:4px}
.landing .credit{font-size:.78rem;color:#b0a898;margin-bottom:28px}
.landing-card{background:#fff;border-radius:16px;padding:26px 24px;max-width:480px;width:92%;border:2px solid var(--bl);box-shadow:0 4px 20px rgba(0,0,0,.08);text-align:right}
.landing-card .ci{font-size:2rem;margin-bottom:5px;text-align:center}
.landing-card h2{font-family:var(--fd);font-size:1.1rem;margin-bottom:5px;text-align:center}
.landing-card p{font-size:.81rem;color:var(--muted);line-height:1.7;margin-bottom:10px}
.landing-card ol{font-size:.78rem;color:#666;line-height:1.8;padding-right:18px;margin-bottom:10px}
.lbtn{display:block;width:100%;padding:11px;font-size:.93rem;font-family:var(--fu);font-weight:700;border:none;border-radius:var(--r);cursor:pointer;text-align:center;background:var(--slate);color:#fff;transition:all .25s}.lbtn:hover{background:#1a2a3a}
.landing-hint{font-size:.76rem;color:#aaa;margin-top:7px;text-align:center}
.landing-footer{margin-top:28px;font-size:.72rem;color:#c0b8a8}

.modal-overlay{position:fixed;inset:0;background:rgba(20,16,10,.75);backdrop-filter:blur(6px);display:flex;align-items:center;justify-content:center;z-index:1000;animation:fadeIn .3s}
.modal-card{background:var(--pbr);border-radius:16px;padding:28px 30px;box-shadow:0 24px 80px rgba(0,0,0,.35);max-width:520px;width:92%;animation:slideUp .4s;text-align:right}
.modal-card h2{font-family:var(--fd);font-size:1.25rem;font-weight:900;margin-bottom:3px;text-align:center}
.modal-sub{color:var(--muted);font-size:.82rem;margin-bottom:14px;text-align:center;line-height:1.6}
.modal-card label{display:block;font-size:.81rem;font-weight:700;font-family:var(--fu);margin-bottom:3px;margin-top:8px}
.modal-input{width:100%;padding:9px 12px;font-size:.9rem;border:2px solid var(--border);border-radius:var(--r);font-family:var(--fb);outline:none;background:#fff}.modal-input:focus{border-color:var(--accent)}
.modal-btn{width:100%;padding:10px;font-size:.92rem;font-family:var(--fu);font-weight:700;border:none;border-radius:var(--r);cursor:pointer;margin-top:9px}.modal-btn.primary{background:var(--accent);color:#fff}.modal-btn.primary:hover{background:var(--accent-dk)}.modal-btn:disabled{background:var(--border);color:#999;cursor:default}

.instructions-box{background:#f5f0ff;border:1px solid #e0d4f5;border-radius:var(--rl);padding:13px 18px;margin-bottom:14px}
.instructions-box h3{font-size:.9rem;color:#6366f1;margin-bottom:3px;font-family:var(--fu)}
.instructions-box ol{font-size:.79rem;color:#666;line-height:1.8;padding-right:18px}
.instructions-box p{font-size:.79rem;color:#888;line-height:1.6;margin-top:4px}

.app-header{background:var(--ink);color:var(--pbr);padding:0 18px;height:50px;display:flex;justify-content:space-between;align-items:center;position:sticky;top:0;z-index:100;box-shadow:0 2px 16px rgba(0,0,0,.25)}
.header-brand{display:flex;align-items:center;gap:9px}
.header-brand .logo{font-size:1.15rem}.header-brand h1{font-family:var(--fd);font-size:.98rem;font-weight:700}.header-brand .meta{font-size:.64rem;opacity:.5}
.phase-indicators{display:flex;gap:3px}
.phase-pill{padding:3px 9px;border-radius:20px;font-size:.67rem;font-weight:600;font-family:var(--fu);background:rgba(255,255,255,.08);color:rgba(255,255,255,.3);transition:all .3s;white-space:nowrap}
.phase-pill.active{background:var(--accent);color:#fff}.phase-pill.done{background:rgba(255,255,255,.15);color:rgba(255,255,255,.6)}

.container{max-width:900px;margin:0 auto;padding:20px 18px}
.info-box{background:#fff;border-radius:var(--rl);padding:15px 20px;margin-bottom:14px;border:1px solid var(--bl)}
.info-box h2{font-family:var(--fd);font-size:1.12rem;margin-bottom:3px}.info-box p{color:var(--muted);font-size:.82rem;line-height:1.7}
.btn{display:inline-flex;align-items:center;gap:5px;padding:9px 20px;border-radius:var(--r);font-size:.85rem;font-weight:700;font-family:var(--fu);border:none;cursor:pointer;transition:all .25s}.btn:active{transform:scale(.97)}
.btn-accent{background:var(--accent);color:#fff}.btn-accent:hover{background:var(--accent-dk)}
.btn-dark{background:var(--slate);color:#fff}.btn-dark:hover{background:#1a2a3a}
.btn-muted{background:#b0a898;color:#fff}.btn-muted:hover{background:#9a9080}
.btn-center{display:flex;justify-content:center;gap:12px;margin-top:20px;flex-wrap:wrap}

/* Link */
.link-result{margin-top:12px;padding:12px;background:#f0f5ff;border:2px solid #6366f1;border-radius:var(--r);animation:slideUp .3s}
.link-result h3{font-size:.86rem;color:#4f46e5;margin-bottom:4px;font-family:var(--fu);text-align:center}
.link-url{width:100%;padding:7px;background:#fff;border:1px solid #c7d2fe;border-radius:6px;font-family:monospace;font-size:.66rem;direction:ltr;text-align:left;word-break:break-all;margin-bottom:5px;resize:none;min-height:40px;outline:none}
.link-actions{display:flex;gap:7px}
.link-actions button{flex:1;padding:7px;font-family:var(--fu);font-weight:600;font-size:.8rem;border:none;border-radius:6px;cursor:pointer}
.copy-btn{background:#6366f1;color:#fff}.copy-btn:hover{background:#4f46e5}
.new-btn{background:#3498db;color:#fff}.new-btn:hover{background:#2980b9}
.np-item{padding:6px;border-bottom:1px solid #f0f0f0;font-size:.78rem}.np-item:last-child{border:none}.np-item strong{font-family:var(--fd);font-size:.83rem}

/* Fact file */
.fact-file{background:#fff;border:2px solid var(--accent);border-radius:var(--rl);padding:20px;margin-bottom:16px;position:relative}
.fact-file::before{content:'ğŸ“‹ ×ª×™×§ ×¢×•×‘×“×•×ª';position:absolute;top:-11px;right:14px;background:var(--accent);color:#fff;padding:2px 12px;border-radius:20px;font-size:.74rem;font-weight:700;font-family:var(--fu)}
.fact-file h3{font-family:var(--fd);font-size:1.1rem;margin:6px 0 8px}
.fact-file .context{font-size:.79rem;color:var(--muted);margin-bottom:10px;padding:6px 10px;background:#faf9f5;border-radius:6px}
.fact-list{list-style:none;padding:0}
.fact-list li{padding:5px 10px;margin-bottom:3px;background:#f8f7f3;border-radius:5px;font-size:.82rem;line-height:1.55;border-right:3px solid var(--accent)}

/* Topic cards */
.topic-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:10px;margin-bottom:14px}
.topic-card{background:#fff;border:2px solid var(--bl);border-radius:10px;padding:14px;cursor:pointer;transition:all .25s;position:relative;overflow:hidden}
.topic-card:hover{border-color:#c0b8a8;box-shadow:0 3px 10px rgba(0,0,0,.08);transform:translateY(-2px)}
.topic-card.selected{border-color:var(--accent);background:#f5f0ff;box-shadow:0 0 0 1px var(--accent)}
.topic-card .topic-icon{font-size:1.6rem;margin-bottom:4px;text-align:center}
.topic-card .topic-name{font-family:var(--fu);font-size:.88rem;font-weight:700;text-align:center;margin-bottom:4px}
.topic-card .topic-facts{font-size:.72rem;color:var(--muted);text-align:center}
.topic-card .check{position:absolute;top:5px;left:5px;background:var(--accent);color:#fff;border-radius:50%;width:18px;height:18px;font-size:.55rem;display:flex;align-items:center;justify-content:center}

/* Framing options */
.framing-options{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:14px}
.framing-card{background:#fff;border:2px solid var(--bl);border-radius:10px;padding:14px;cursor:pointer;transition:all .25s;position:relative}
.framing-card:hover{border-color:#c0b8a8;box-shadow:0 3px 10px rgba(0,0,0,.08)}
.framing-card.selected{border-width:3px}
.framing-card .fc-label{font-size:.72rem;font-weight:700;font-family:var(--fu);padding:2px 10px;border-radius:20px;color:#fff;display:inline-block;margin-bottom:6px}
.framing-card h3{font-family:var(--fd);font-size:1rem;font-weight:800;line-height:1.3;margin-bottom:3px}
.framing-card .fc-sub{font-size:.8rem;color:#666;line-height:1.4}
.framing-card .check{position:absolute;top:5px;left:5px;color:#fff;border-radius:50%;width:20px;height:20px;font-size:.6rem;display:flex;align-items:center;justify-content:center}

/* Justify textarea */
.justify-box{background:#fff;border-radius:var(--rl);padding:16px 20px;margin-bottom:14px;border:1px solid var(--bl)}
.justify-box h3{font-family:var(--fd);font-size:1rem;margin-bottom:6px}
.justify-box p{font-size:.82rem;color:var(--muted);margin-bottom:6px}
.justify-textarea{width:100%;padding:9px 12px;border:1px solid var(--border);border-radius:var(--r);font-family:var(--fb);font-size:.86rem;line-height:1.7;resize:vertical;outline:none;min-height:70px}.justify-textarea:focus{border-color:var(--accent)}

/* Write article */
.write-panel{background:#fff;border:2px solid var(--bl);border-radius:var(--rl);padding:18px;margin-bottom:14px}
.write-panel label{display:block;font-size:.81rem;font-weight:700;font-family:var(--fu);margin:8px 0 3px;color:var(--slate)}
.write-input{width:100%;padding:9px 11px;border:1px solid var(--border);border-radius:var(--r);font-family:var(--fd);font-weight:700;font-size:1rem;outline:none}.write-input:focus{border-color:var(--accent)}
.write-textarea{width:100%;padding:9px 11px;border:1px solid var(--border);border-radius:var(--r);font-family:var(--fb);font-size:.86rem;line-height:1.7;resize:vertical;outline:none;min-height:90px}.write-textarea:focus{border-color:var(--accent)}
.relevant-facts{background:#f5f0ff;border:1px solid #e0d4f5;border-radius:var(--r);padding:10px 14px;margin-bottom:10px}
.relevant-facts h4{font-size:.82rem;font-family:var(--fu);color:var(--accent);margin-bottom:5px}
.relevant-facts li{font-size:.8rem;line-height:1.55;margin-bottom:2px;list-style:disc;margin-right:16px}

/* Preview / Result */
.result-newspaper{background:var(--pbr);border:2px solid var(--ink);border-radius:3px;padding:24px;box-shadow:0 8px 30px rgba(0,0,0,.15);margin-bottom:16px}
.result-newspaper .rn-header{text-align:center;border-bottom:3px double var(--ink);padding-bottom:10px;margin-bottom:14px}
.result-newspaper .rn-header h1{font-family:var(--fd);font-size:1.8rem;font-weight:900;line-height:1.2;margin-bottom:3px}
.result-newspaper .rn-header .rn-sub{font-size:.88rem;color:#555;line-height:1.4}
.result-newspaper .rn-body{font-size:.88rem;line-height:1.7;text-align:justify}
.result-newspaper .rn-byline{font-size:.72rem;color:var(--muted);font-family:var(--fu);margin-top:10px;text-align:left;border-top:1px solid var(--border);padding-top:6px}

.decision-trail{background:#fff;border-radius:var(--rl);padding:16px 20px;border:1px solid var(--bl);margin-bottom:14px}
.decision-trail h3{font-family:var(--fd);font-size:1rem;margin-bottom:10px}
.dt-step{padding:8px 12px;margin-bottom:6px;border-radius:6px;border-right:3px solid var(--accent);background:#faf9f5}
.dt-step .dt-q{font-size:.78rem;color:var(--accent);font-weight:700;font-family:var(--fu)}
.dt-step .dt-a{font-size:.84rem;font-weight:600;margin-top:1px}
.dt-step .dt-why{font-size:.8rem;color:#666;margin-top:2px;line-height:1.5}

/* Teacher sub card */
.sub-card{background:#fff;border:1px solid var(--bl);border-radius:var(--rl);padding:16px;margin-bottom:14px}
.sub-card h4{font-family:var(--fd);font-size:1.02rem;margin-bottom:4px}
.sub-meta{font-size:.74rem;color:var(--muted);margin-bottom:8px}

/* Frame colors */
.fc-economic{background:#f59e0b;border-color:#f59e0b}.fc-social{background:#ec4899;border-color:#ec4899}
.fc-environmental{background:#22c55e;border-color:#22c55e}.fc-security{background:#ef4444;border-color:#ef4444}
.fc-human{background:#f97316;border-color:#f97316}.fc-political{background:#8b5cf6;border-color:#8b5cf6}
.fc-tech{background:#0ea5e9;border-color:#0ea5e9}.fc-health{background:#e11d48;border-color:#e11d48}

@media print{.app-header,.info-box,.instructions-box,.btn,.btn-center,.decision-trail,.credit-bar{display:none!important}body{background:#fff}.result-newspaper{box-shadow:none;border:1px solid #000}}
.credit-bar{background:linear-gradient(135deg,#6366f108,#ec489908);border:1px solid #e0d4f5;border-radius:20px;padding:4px 16px;font-size:.72rem;color:#6366f1;font-family:var(--fu);font-weight:500;text-align:center;margin-bottom:10px}
@media(max-width:768px){.framing-options{grid-template-columns:1fr}.topic-grid{grid-template-columns:1fr 1fr}.container{padding:12px 10px}.phase-indicators{display:none}}
</style>
</head>
<body>
<div id="app"></div>
<script>
// ============ FIREBASE ============
const firebaseConfig={apiKey:"AIzaSyCh8TMjXeatpegwaJGOiT64VU0cXeWMwLA",authDomain:"newspaper-editor.firebaseapp.com",databaseURL:"https://newspaper-editor-default-rtdb.europe-west1.firebasedatabase.app",projectId:"newspaper-editor",storageBucket:"newspaper-editor.firebasestorage.app",messagingSenderId:"1056483646622",appId:"1:1056483646622:web:1afdb41dbcfacff9106f8f"};
let db;try{firebase.initializeApp(firebaseConfig);db=firebase.database()}catch(e){console.warn(e)}

const FRAME_META={
  economic:{name:"×›×œ×›×œ×™",icon:"ğŸ’°",color:"#f59e0b",desc:"×¢×œ×•×ª, ×ª×•×¢×œ×ª, ×¨×•×•×—, ×”×¤×¡×“"},
  social:{name:"×—×‘×¨×ª×™",icon:"ğŸ‘¥",color:"#ec4899",desc:"×¦×“×§, ×©×•×•×™×•×Ÿ, ×§×”×™×œ×”, ×¤×¢×¨×™×"},
  environmental:{name:"×¡×‘×™×‘×ª×™",icon:"ğŸŒ¿",color:"#22c55e",desc:"×˜×‘×¢, ×–×™×”×•×, ×§×™×™××•×ª"},
  security:{name:"×‘×™×˜×—×•× ×™",icon:"ğŸ›¡ï¸",color:"#ef4444",desc:"××™×•×, ×”×’× ×”, ×¡×™×›×•×Ÿ"},
  human:{name:"×¢× ×™×™×Ÿ ×× ×•×©×™",icon:"â¤ï¸",color:"#f97316",desc:"×¡×™×¤×•×¨ ××™×©×™, ×¨×’×©, ×’×•×¨×œ"},
  political:{name:"×¤×•×œ×™×˜×™",icon:"ğŸ›ï¸",color:"#8b5cf6",desc:"×××‘×§ ×›×•×—, ××™× ×˜×¨×¡×™×"},
  tech:{name:"×˜×›× ×•×œ×•×’×™",icon:"ğŸ’»",color:"#0ea5e9",desc:"×—×“×©× ×•×ª, ×©×™× ×•×™ ×˜×›× ×•×œ×•×’×™"},
  health:{name:"×‘×¨×™××•×ª×™",icon:"ğŸ¥",color:"#e11d48",desc:"×‘×¨×™××•×ª, ×¡×™×›×•×Ÿ ×¨×¤×•××™"},
};
const getFrame=id=>FRAME_META[id]||{name:id,icon:"ğŸ“„",color:"#888",desc:""};

const TOPIC_ICONS={"×›×œ×›×œ×”":"ğŸ’°","×—×‘×¨×”":"ğŸ‘¥","×¡×‘×™×‘×”":"ğŸŒ¿","×‘×™×˜×—×•×Ÿ":"ğŸ›¡ï¸","×¤×•×œ×™×˜×™×§×”":"ğŸ›ï¸","×˜×›× ×•×œ×•×’×™×”":"ğŸ’»","×‘×¨×™××•×ª":"ğŸ¥","×× ×©×™×":"â¤ï¸","×—×™× ×•×š":"ğŸ“š","×¢×‘×•×“×”":"ğŸ‘·","×“×™×•×¨":"ğŸ ","×ª×—×‘×•×¨×”":"ğŸš‡","×¤×¨×˜×™×•×ª":"ğŸ”’","××©×¤×˜":"âš–ï¸"};

// ============ EVENTS DATABASE ============
const ALL_EVENTS=[
{
  id:1,title:"×”×§××ª 3 ×©×›×•× ×•×ª ×—×“×©×•×ª ×‘×¤×¨×™×¤×¨×™×”",
  context:"×”×××©×œ×” ××™×©×¨×” ×ª×•×›× ×™×ª ×‘× ×™×™×” ×’×“×•×œ×” ×‘×“×¨×•× ×”××¨×¥",
  topics:{
    "×›×œ×›×œ×”":["×ª×§×¦×™×‘ ×©×œ 2 ××™×œ×™××¨×“ â‚ª ×œ×¤×¨×•×™×§×˜","×¦×¤×™ ×œ×™×¦×™×¨×ª 3,000 ××§×•××•×ª ×¢×‘×•×“×”","40% ××”×“×™×¨×•×ª ×‘××—×™×¨ ×œ××©×ª×›×Ÿ"],
    "×—×‘×¨×”":["8,000 ×™×—×™×“×•×ª ×“×™×•×¨ ×™×™×‘× ×•","120 ×—×§×œ××™× ×™×¤×•× ×• ×××“××•×ª×™×”×","×¨××© ×”×¢×™×¨: '×”×–×“×× ×•×ª ×”×™×¡×˜×•×¨×™×ª ×œ× ×’×‘'"],
    "×¡×‘×™×‘×”":["×”×©×˜×— ×”×•× ×‘×™×ª ×’×™×“×•×œ ×©×œ 3 ××™× ×™ ×¦×™×¤×•×¨×™× ××•×’× ×•×ª","××¨×’×•× ×™ ×¡×‘×™×‘×” ×”×’×™×©×• ×¢×ª×™×¨×” ×œ×‘×’\"×¥","×©×˜×— ×¤×ª×•×— ×‘× ×’×‘ ×™×™×”×¤×š ×œ××–×•×¨ ×‘× ×•×™"],
    "×¤×•×œ×™×˜×™×§×”":["×”×××©×œ×” ××™×©×¨×” ××ª ×”×ª×•×›× ×™×ª ×œ×§×¨××ª ×‘×—×™×¨×•×ª","×¨××© ×”×¢×™×¨ ×”×¦×”×™×¨ ×ª××™×›×”","××¨×’×•× ×™ ×¡×‘×™×‘×” ×”×’×™×©×• ×¢×ª×™×¨×” ×œ×‘×’\"×¥"]
  },
  framings:[
    {id:"economic",headline:"2 ××™×œ×™××¨×“ â‚ª ×œ×¤×¨×™×¤×¨×™×”: ×× ×•×¢ ×¦××™×—×” ××• ×‘×–×‘×•×–?",subtitle:"3,000 ××§×•××•×ª ×¢×‘×•×“×” ×—×“×©×™× ×¦×¤×•×™×™× â€” ××‘×œ ×”××—×™×¨ ×›×‘×“"},
    {id:"social",headline:"8,000 ××©×¤×—×•×ª ×™×§×‘×œ×• ×‘×™×ª â€” 120 ×—×§×œ××™× ×™××‘×“×• ××ª ×©×œ×”×",subtitle:"×ª×•×›× ×™×ª ×”×“×™×•×¨ ×”×—×“×©×” ××‘×˜×™×—×” ×¤×ª×¨×•×Ÿ â€” ××‘×œ ×œ× ×œ×›×•×œ×"},
    {id:"environmental",headline:"×‘×™×ª ×’×™×“×•×œ ×©×œ ××™× ×™× ××•×’× ×™× ×™×™×”×¨×¡ ×œ×˜×•×‘×ª ×©×›×•× ×•×ª",subtitle:"××¨×’×•× ×™ ×¡×‘×™×‘×” × ×œ×—××™× ×‘×‘×’\"×¥ × ×’×“ ×‘× ×™×™×” ×‘× ×’×‘"},
    {id:"political",headline:"×©×›×•× ×•×ª ×œ×§×¨××ª ×‘×—×™×¨×•×ª? ×”×××©×œ×” ×××©×¨×ª ×ª×•×›× ×™×ª ×¢× ×§",subtitle:"×¨××© ×”×¢×™×¨ ××¨×™×¢, ×”××•×¤×•×–×™×¦×™×” ×××©×™××” ×‘×¤×•×¤×•×œ×™×–×"}
  ]
},
{
  id:2,title:"××¤×¢×œ ×˜×›× ×•×œ×•×’×™×” ×‘×™× ×œ××•××™ × ×¤×ª×— ×‘×’×œ×™×œ",
  context:"×—×‘×¨×ª ×˜×›× ×•×œ×•×’×™×” ×¨×‘-×œ××•××™×ª ×”×§×™××” ××¤×¢×œ ×™×™×¦×•×¨ ×‘×¦×¤×•×Ÿ",
  topics:{
    "×›×œ×›×œ×”":["×”×©×§×¢×” ×©×œ 800 ××™×œ×™×•×Ÿ ×“×•×œ×¨","500 ×¢×•×‘×“×™×, ××©×›×•×¨×ª ×××•×¦×¢×ª 25,000 â‚ª","×”×˜×‘×•×ª ××¡ ×œ-10 ×©× ×™× ××”××“×™× ×”"],
    "×¡×‘×™×‘×”":["×”××¤×¢×œ ×™×¤×œ×•×˜ 200 ×˜×•×Ÿ ×¤×¡×•×œ×ª ×›×™××™×ª ×‘×©× ×”","××¢×¨×›×ª ×¡×™× ×•×Ÿ ×‘×¢×œ×•×ª 50 ××™×œ×™×•×Ÿ â‚ª","3 ×‘×ª×™ ×¡×¤×¨ ×‘××¨×—×§ ×¤×—×•×ª ××§\"×"],
    "×‘×¨×™××•×ª":["×ª×•×©×‘×™× ×—×•×©×©×™× ×œ×‘×¨×™××•×ª ×”×™×œ×“×™×","3 ×‘×ª×™ ×¡×¤×¨ ×¡××•×›×™× ×œ××¤×¢×œ","×¤×¡×•×œ×ª ×›×™××™×ª ×¢×œ×•×œ×” ×œ×’×¨×•× ×œ× ×–×§ ×‘×¨×™××•×ª×™"],
    "×—×‘×¨×”":["70% ××”×¢×•×‘×“×™× ×™×”×™×• ××”××–×•×¨","×¨××© ×”××•×¢×¦×”: '×™×•× ×—×’ ×œ×’×œ×™×œ'","×ª×•×©×‘×™× ×”×’×™×©×• ×”×ª× ×’×“×•×ª"]
  },
  framings:[
    {id:"economic",headline:"800 ××™×œ×™×•×Ÿ ×“×•×œ×¨ × ×©×¤×›×™× ×œ×’×œ×™×œ: ×ª×—×™×™×” ×›×œ×›×œ×™×ª",subtitle:"500 ××§×•××•×ª ×¢×‘×•×“×” ×¢× ××©×›×•×¨×•×ª ×›×¤×•×œ×•×ª ××”×××•×¦×¢"},
    {id:"environmental",headline:"200 ×˜×•×Ÿ ×¤×¡×•×œ×ª ×›×™××™×ª ×‘×©× ×”: ×”××—×™×¨ ×”×××™×ª×™ ×©×œ ×”×”×©×§×¢×”",subtitle:"××¤×¢×œ ×—×“×© ×××™×™× ×¢×œ ×”×¡×‘×™×‘×” â€” ××˜×¨×™× ××‘×ª×™ ×¡×¤×¨"},
    {id:"health",headline:"×™×œ×“×™× ×œ×•××“×™× 800 ××˜×¨ ×××¤×¢×œ ×›×™××™×§×œ×™× ×—×“×©",subtitle:"×”×•×¨×™× ×“×•×¨×©×™× ×‘×“×™×§×•×ª â€” ×”×—×‘×¨×” ××‘×˜×™×—×” ×¡×™× ×•×Ÿ"},
    {id:"social",headline:"×”×’×œ×™×œ ××ª×¢×•×¨×¨: 500 ××©×¤×—×•×ª ×™×•×›×œ×• ×œ×”×ª×¤×¨× ×¡ ×‘×›×‘×•×“",subtitle:"××‘×œ ×œ× ×›×•×œ× ×©××—×™× â€” ×ª×•×©×‘×™× ××•×—×™× × ×’×“ ×”×–×™×”×•×"}
  ]
},
{
  id:3,title:"×‘×™× ×” ××œ××›×•×ª×™×ª ××—×œ×™×¤×” 200 ×¢×•×‘×“×™× ×‘×—×‘×¨×ª ×‘×™×˜×•×—",
  context:"×—×‘×¨×ª ×‘×™×˜×•×— ××•×‘×™×œ×” ×”×•×“×™×¢×” ×¢×œ ××¢×‘×¨ ×œ××¢×¨×›×ª AI",
  topics:{
    "×˜×›× ×•×œ×•×’×™×”":["××¢×¨×›×ª AI ×ª×˜×¤×œ ×‘-80% ××”×¤× ×™×•×ª","×–××Ÿ ×”××ª× ×” ×™×¨×“ ×-12 ×“×§×•×ª ×œ-30 ×©× ×™×•×ª","×—×‘×¨×•×ª × ×•×¡×¤×•×ª ×¦×¤×•×™×•×ª ×œ×××¥ ×˜×›× ×•×œ×•×’×™×” ×“×•××”"],
    "×¢×‘×•×“×”":["200 ×¢×•×‘×“×™ ×©×™×¨×•×ª ×œ×§×•×—×•×ª ×¤×•×˜×¨×•","×’×™×œ ×××•×¦×¢ ×©×œ ×”××¤×•×˜×¨×™×: 48","××¢× ×§ ×”×¡×ª×’×œ×•×ª ×œ-6 ×—×•×“×©×™× ×‘×œ×‘×“"],
    "×›×œ×›×œ×”":["×—×™×¡×›×•×Ÿ ×©×œ 60 ××™×œ×™×•×Ÿ â‚ª ×‘×©× ×”","×”×”×¡×ª×“×¨×•×ª ×××™×™××ª ×‘×©×‘×™×ª×”","×”×× ×›\"×œ: '××™ ×©×œ× ×™×©×ª× ×” â€” ×™×™×¢×œ×'"],
    "×× ×©×™×":["×’×™×œ ×××•×¦×¢ 48, ×§×©×” ×œ××¦×•× ×¢×‘×•×“×” ×—×“×©×”","45% ××”×œ×§×•×—×•×ª ××¢×“×™×¤×™× × ×¦×™×’ ×× ×•×©×™","××¢× ×§ ×œ-6 ×—×•×“×©×™× â€” ×•××– ××”?"]
  },
  framings:[
    {id:"tech",headline:"××”×¤×›×”: AI ××˜×¤×œ ×‘-80% ××”×¤× ×™×•×ª ×ª×•×š 30 ×©× ×™×•×ª",subtitle:"×—×‘×¨×ª ×‘×™×˜×•×— ×”×•×¤×›×ª ×œ×—×œ×•×¦×” â€” ×œ×§×•×—×•×ª ×›×‘×¨ × ×”× ×™×"},
    {id:"social",headline:"200 ×¢×•×‘×“×™× ×‘× ×™ 48+ ×–×¨×§×• ×œ×¨×—×•×‘ â€” ×¨×•×‘×•×˜ ××—×œ×™×£ ××•×ª×",subtitle:"×”×”×¡×ª×“×¨×•×ª ×××™×™××ª ×‘×©×‘×™×ª×”, ×”×× ×›\"×œ: '×–×” ×”×¢×ª×™×“'"},
    {id:"economic",headline:"60 ××™×œ×™×•×Ÿ â‚ª ×—×™×¡×›×•×Ÿ: ×”××”×œ×š ×©××©× ×” ××ª ×¢× ×£ ×”×‘×™×˜×•×—",subtitle:"××—×¨×™ ×—×‘×¨×” ××—×ª â€” ×›×œ ×”×©×•×§ ×¦×¤×•×™ ×œ×œ×›×ª ×‘×¢×§×‘×•×ª×™×”"},
    {id:"human",headline:"×™×•×¡×™, ×‘×Ÿ 52, ×¤×•×˜×¨ ××—×¨×™ 20 ×©× ×” â€” ×¨×•×‘×•×˜ ×œ×§×— ××ª ××§×•××•",subtitle:"'×§×™×‘×œ×ª×™ ××¢× ×§ ×œ-6 ×—×•×“×©×™×. ×•××– ××”?'"}
  ]
},
{
  id:4,title:"×©×¨×™×¤×” ×’×“×•×œ×” ×‘××¤×¢×œ ×›×™××™×§×œ×™× ×‘×—×™×¤×”",
  context:"×©×¨×™×¤×” ×¤×¨×¦×” ×‘××¤×¢×œ ×‘×ª×¢×©×™×™×” ×”×¤×˜×¨×•×›×™××™×ª ×‘××¤×¨×¥ ×—×™×¤×”",
  topics:{
    "×¡×‘×™×‘×”":["×¢× ×Ÿ ×¢×©×Ÿ ×©×—×•×¨ ×›×™×¡×” ××ª ×—×™×¤×” 6 ×©×¢×•×ª","×—×•××¨×™× ××¡×¨×˜× ×™× × ××¦××• ×‘××¨×—×§ 2 ×§\"×","×–×”×• ×”××™×¨×•×¢ ×”×©×œ×™×©×™ ×‘××¤×¢×œ ×‘-5 ×©× ×™×"],
    "×‘×¨×™××•×ª":["15 ×¢×•×‘×“×™× ×¤×•× ×•, 3 ××•×©×¤×–×•","××©×¨×“ ×”×‘×¨×™××•×ª ×”×•×¨×” ×œ×¡×’×•×¨ ×—×œ×•× ×•×ª","×ª×•×©×‘×ª: '×”×™×œ×“×™× ×©×œ×™ ××©×ª×¢×œ×™× ×›×œ ×œ×™×œ×”'"],
    "×›×œ×›×œ×”":["×”××¤×¢×œ ××¢×¡×™×§ 800 ×¢×•×‘×“×™×","× ×§× ×¡ 2 ××™×œ×™×•×Ÿ â‚ª ×‘××™×¨×•×¢ ×§×•×“×","×”×¢×™×¨×™×™×” ×“×•×¨×©×ª ×¡×’×™×¨×”, ×‘×¢×œ×™× ××ª× ×’×“×™×"],
    "×× ×©×™×":["3 ×¢×•×‘×“×™× ××•×©×¤×–×• ×¢× ×©××™×¤×ª ×¢×©×Ÿ","×ª×•×©×‘×ª × ×•×•×” ×©×× ×Ÿ: '×”×™×œ×“×™× ××©×ª×¢×œ×™×'","×©×¨×™×¤×” ×‘-3 ×‘×œ×™×œ×” ×”×¤×ª×™×¢×” ×ª×•×©×‘×™×"]
  },
  framings:[
    {id:"environmental",headline:"×¤×¢× ×©×œ×™×©×™×ª: ××¤×¢×œ ×”×›×™××™×§×œ×™× ×©×•×‘ ××¨×¢×™×œ ××ª ×—×™×¤×”",subtitle:"×—×•××¨×™× ××¡×¨×˜× ×™× ×‘××¨×—×§ 2 ×§\"× â€” ×•×”××¤×¢×œ ×××©×™×š ×œ×¤×¢×•×œ"},
    {id:"health",headline:"×™×œ×“×™ ×—×™×¤×” ×‘×¡×›× ×”: ×¢× ×Ÿ ×¨×¢×œ×™× ×›×™×¡×” ××ª ×”×¢×™×¨ 6 ×©×¢×•×ª",subtitle:"×ª×•×©×‘×ª: '×”×™×œ×“×™× ×©×œ×™ ××©×ª×¢×œ×™× ×›×œ ×œ×™×œ×”'"},
    {id:"economic",headline:"800 ××§×•××•×ª ×¢×‘×•×“×” ××•×œ ×‘×¨×™××•×ª ×”×¦×™×‘×•×¨: ×”×“×™×œ××” ×©×œ ×—×™×¤×”",subtitle:"×¡×’×™×¨×ª ×”××¤×¢×œ ×ª×¤×’×¢ ×‘×›×œ×›×œ×ª ×”××–×•×¨ â€” ××‘×œ ××” ×”××—×™×¨?"},
    {id:"human",headline:"'×‘-3 ×‘×œ×™×œ×” ×”×™×œ×“×™× ×”×ª×¢×•×¨×¨×• ×‘×‘×”×œ×”': ×”×©×¨×™×¤×” ×©××—×–×™×¨×” ××ª ×”×¤×—×“",subtitle:"××©×¤×—×•×ª × ×•×•×” ×©×× ×Ÿ ×—×™×•×ª ×‘×¤×—×“ ××ª××™×“ â€” ×•××£ ××—×“ ×œ× ×¢×•×–×¨"}
  ]
},
{
  id:5,title:"×—×•×§ ×—×“×©: ××¦×œ××•×ª ×–×™×”×•×™ ×¤× ×™× ×‘×¨×—×•×‘×•×ª",
  context:"×”×›× ×¡×ª ××™×©×¨×” ×—×•×§ ×œ×”×ª×§× ×ª ××¦×œ××•×ª ×—×›××•×ª ×‘××¨×—×‘ ×”×¦×™×‘×•×¨×™",
  topics:{
    "×‘×™×˜×—×•×Ÿ":["×¦×¤×™ ×œ×™×¨×™×“×” ×©×œ 40% ×‘×¤×©×™×¢×”","×”××¢×¨×›×ª ×ª×–×”×” ××‘×•×§×©×™× ×‘×–××Ÿ ×××ª","62% ××”×¦×™×‘×•×¨ ×ª×•××›×™×"],
    "×¤×¨×˜×™×•×ª":["××¨×’×•× ×™ ×–×›×•×™×•×ª ××“×: '××“×™× ×ª ××¢×§×‘'","×”× ×ª×•× ×™× ×™×™×©××¨×• 7 ×©× ×™×","××™×Ÿ ×¤×™×§×•×— ×¢×œ ××™ ×¦×•×¤×” ×‘××¦×œ××•×ª"],
    "×˜×›× ×•×œ×•×’×™×”":["10,000 ××¦×œ××•×ª ×–×™×”×•×™ ×¤× ×™×","×”××¢×¨×›×ª ×˜×•×¢×” ×‘-15% ×‘×–×™×”×•×™ ×›×”×™ ×¢×•×¨","×‘×¡×™×Ÿ ××¢×¨×›×ª ×“×•××” ×©×™××©×” ×œ×“×™×›×•×™"],
    "×—×‘×¨×”":["×˜×¢×•×™×•×ª ×–×™×”×•×™ ×¤×•×’×¢×•×ª ×‘××•×›×œ×•×¡×™×•×ª ××•×—×œ×©×•×ª","28% ××”×¦×™×‘×•×¨ ××ª× ×’×“×™×","×¢×œ×•×ª: 500 ××™×œ×™×•×Ÿ â‚ª ××›×¡×¤×™ ×”×¦×™×‘×•×¨"]
  },
  framings:[
    {id:"security",headline:"×”××œ×—××” ×‘×¤×©×¢: 10,000 ××¦×œ××•×ª ×—×›××•×ª ×™×–×”×• ×¤×•×©×¢×™× ×‘×¨×—×•×‘",subtitle:"×”××©×˜×¨×” ××‘×˜×™×—×” ×™×¨×™×“×” ×“×¨××˜×™×ª ×‘×¤×©×™×¢×”"},
    {id:"political",headline:"×”××— ×”×’×“×•×œ ×›×‘×¨ ×›××Ÿ: ×™×©×¨××œ ×”×•×¤×›×ª ×œ××“×™× ×ª ××¢×§×‘",subtitle:"7 ×©× ×™× ×©×œ ××¢×§×‘ â€” ×•××£ ××—×“ ×œ× ××¤×§×— ×¢×œ ×”××©×˜×¨×”"},
    {id:"tech",headline:"×”××¦×œ××” ×©×˜×•×¢×” ×‘-15%: ×–×™×”×•×™ ×¤× ×™× ×©××¤×œ×” ×›×”×™ ×¢×•×¨",subtitle:"×˜×›× ×•×œ×•×’×™×” ×¤×’×•××”, ×‘×œ×™ ×‘×™×§×•×¨×ª â€” ××” ×™×›×•×œ ×œ×”×©×ª×‘×©?"},
    {id:"social",headline:"××¦×œ××•×ª ×œ×¢×©×™×¨×™×, ××¢×§×‘ ×œ×¢× ×™×™×: ××™ ×‘×××ª ×™×™×¤×’×¢?",subtitle:"××¨×’×•× ×™ ×–×›×•×™×•×ª: '××•×›×œ×•×¡×™×•×ª ××•×—×œ×©×•×ª ×™×©×œ××• ××ª ×”××—×™×¨'"}
  ]
},
{
  id:6,title:"×—×‘×¨×ª ×ª×¨×•×¤×•×ª ××¡×¨×‘×ª ×œ×”×•×–×™×œ ×ª×¨×•×¤×” ××¦×™×œ×ª ×—×™×™×",
  context:"×•×™×›×•×— ×¦×™×‘×•×¨×™ ×¡×‘×™×‘ ××—×™×¨ ×ª×¨×•×¤×” ×—×“×©×” ×œ×¡×¨×˜×Ÿ",
  topics:{
    "×‘×¨×™××•×ª":["×”×ª×¨×•×¤×” ×××¨×™×›×” ×—×™×™× ×‘-3 ×©× ×™×","300 ×—×•×œ×™× ×–×§×•×§×™× ×•×œ× ×™×›×•×œ×™× ×œ×©×œ×","×‘×”×•×“×• ×’×¨×¡×” ×’× ×¨×™×ª ×‘-5,000 â‚ª ×œ×—×•×“×©"],
    "×›×œ×›×œ×”":["××—×™×¨: 80,000 â‚ª ×œ×—×•×“×©","×¢×œ×•×ª ×™×™×¦×•×¨: 3,000 â‚ª","×”×—×‘×¨×” ×”×©×§×™×¢×” 2 ××™×œ×™××¨×“ â‚ª ×‘-15 ×©× ×•×ª ××—×§×¨"],
    "×× ×©×™×":["××©×¤×—×” ××•×›×¨×ª ××ª ×”×‘×™×ª ×›×“×™ ×œ×©×œ×","300 ×—×•×œ×™× ×××ª×™× ×™×","×”×× ×›\"×œ: '×‘×œ×™ ×¨×•×•×— ××™×Ÿ ××—×§×¨ ×¢×ª×™×“×™'"],
    "×¤×•×œ×™×˜×™×§×”":["78% ××”×¦×™×‘×•×¨ ×ª×•××›×™× ×‘×›×¤×™×™×ª ×”×•×–×œ×”","××©×¨×“ ×”×‘×¨×™××•×ª ×“×•×¨×© ×”×›×œ×œ×” ×‘×¡×œ","×”×—×‘×¨×” ××¡×¨×‘×ª â€” ×•××™ ×™×›×¨×™×—?"]
  },
  framings:[
    {id:"health",headline:"300 ×—×•×œ×™ ×¡×¨×˜×Ÿ ×™××•×ª×• â€” ×›×™ ××™×Ÿ ×œ×”× 80,000 â‚ª ×‘×—×•×“×©",subtitle:"×ª×¨×•×¤×” ×§×™×™××ª, ××¦×™×œ×” ×—×™×™× â€” ××‘×œ ×¨×§ ×œ××™ ×©×™×›×•×œ ×œ×©×œ×"},
    {id:"economic",headline:"×¢×œ×•×ª ×™×™×¦×•×¨ 3,000 â‚ª, ××—×™×¨ 80,000 â‚ª: ×”×¨×•×•×— ×©×”×•×¨×’",subtitle:"××™ ×‘×××ª ××©×œ× ×¢×œ 15 ×©× ×•×ª ××—×§×¨?"},
    {id:"human",headline:"'×× ×—× ×• ××•×›×¨×™× ××ª ×”×‘×™×ª': ×”××©×¤×—×” ×©× ×œ×—××ª ×‘×¡×¨×˜×Ÿ ×•×‘×—×‘×¨×ª ×ª×¨×•×¤×•×ª",subtitle:"×›×©×ª×¨×•×¤×” ××¦×™×œ×ª ×—×™×™× ×”×•×¤×›×ª ×œ×’×–×¨ ×“×™×Ÿ ×›×œ×›×œ×™"},
    {id:"political",headline:"×”×›× ×¡×ª ××•×œ ×—×‘×¨×ª ×”×ª×¨×•×¤×•×ª: ××™ ×™×›×¨×™×— ××ª ×”×”×•×–×œ×”?",subtitle:"78% ××”×¦×™×‘×•×¨ ×“×•×¨×©×™× â€” ××‘×œ ×”×œ×•×‘×™ ×—×–×§ ×™×•×ª×¨"}
  ]
},
{
  id:7,title:"×¨×©×ª ××–×•×Ÿ ×¤×™×˜×¨×” 1,000 ×§×•×¤××™×•×ª ×•×”×—×œ×™×¤×” ×‘×§×•×¤×•×ª ××•×˜×•××˜×™×•×ª",
  context:"×¨×©×ª ×¡×•×¤×¨××¨×§×˜×™× ×’×“×•×œ×” ×¢×‘×¨×” ×œ××•×˜×•××¦×™×” ××œ××”",
  topics:{
    "×¢×‘×•×“×”":["1,000 ×§×•×¤××™× ×¤×•×˜×¨×•","×¨×•×‘ ×”××¤×•×˜×¨×™×: × ×©×™× 45-60 ×œ×œ× ×ª×•××¨","×”×›×©×¨×” ×”×•×¦×¢×” ×œ-200 ×‘×œ×‘×“"],
    "×˜×›× ×•×œ×•×’×™×”":["60 ×§×•×¤×•×ª ××•×˜×•××˜×™×•×ª ×‘×›×œ ×¡× ×™×£","×œ×§×•×—×•×ª ××‘×•×’×¨×™× ××ª×§×©×™× ×‘×ª×¤×¢×•×œ","3 ×¨×©×ª×•×ª × ×•×¡×¤×•×ª ×™×¢×§×‘×•"],
    "×›×œ×›×œ×”":["×—×™×¡×›×•×Ÿ ×©×œ 150 ××™×œ×™×•×Ÿ â‚ª ×‘×©× ×”","××—×™×¨×™× ×™×¨×“×• 3%","55% ××”×¦×¨×›× ×™× ××¨×•×¦×™×"],
    "×× ×©×™×":["× ×©×™× ×‘× ×•×ª 50+ ×‘×œ×™ ×¡×™×›×•×™ ×œ×¢×‘×•×“×” ×—×“×©×”","×”×”×¡×ª×“×¨×•×ª: '×’×–×¨ ×“×™×Ÿ ×œ××©×¤×—×•×ª'","×”×›×©×¨×” ×œ-200 ××ª×•×š 1,000"]
  },
  framings:[
    {id:"economic",headline:"××—×™×¨×™× ×™×¨×“×• 3%: ×”××•×˜×•××¦×™×” ×©×—×•×¡×›×ª ×œ×¦×¨×›× ×™× ××™×œ×™×•× ×™×",subtitle:"×”×§×•×¤×” ×”××•×˜×•××˜×™×ª ×× ×¦×—×ª â€” ×•×”×œ×§×•×—×•×ª × ×”× ×™×"},
    {id:"social",headline:"1,000 × ×©×™× ×‘× ×•×ª 50+ × ×–×¨×§×• ×œ×¨×—×•×‘ â€” ×¨×•×‘×•×˜ ×¢×•×©×” ××ª ×¢×‘×•×“×ª×Ÿ",subtitle:"×”×›×©×¨×”? ×¨×§ ×œ-200. ×•×”×©××¨?"},
    {id:"human",headline:"'×‘×’×™×œ 55 ××£ ××—×“ ×œ× ×™×™×§×— ××•×ª×™': ×”×§×•×¤××™×ª ×©×”×¨×•×‘×•×˜ ×”×—×œ×™×£",subtitle:"××—×¨×™ 20 ×©× ×” ×‘×§×•×¤×”, ××¨×™× ××—×¤×©×ª ×¢×‘×•×“×” â€” ×•×œ× ××•×¦××ª"},
    {id:"tech",headline:"×¡×•×¤×¨××¨×§×˜ ×‘×œ×™ ×‘× ×™ ××“×: ×›×š × ×¨××” ×”×¢×ª×™×“ ×©×œ ×”×§× ×™×•×ª",subtitle:"60 ×§×•×¤×•×ª ××•×˜×•××˜×™×•×ª, ××¤×¡ ×ª×•×¨ â€” ××‘×œ ××” ×¢× ×¡×‘×ª×?"}
  ]
},
{
  id:8,title:'×“×œ×™×¤×ª ××¡××›×™×: ×× ×›"×œ ×—×‘×¨×” ×××©×œ×ª×™×ª ××¨×•×•×™×— 300,000 â‚ª',
  context:"×—×©×™×¤×” ×¢×™×ª×•× ××™×ª ×©×œ ×©×›×¨ ×‘×›×™×¨×™× ×‘×—×‘×¨×•×ª ×××©×œ×ª×™×•×ª",
  topics:{
    "×›×œ×›×œ×”":["×©×›×¨ 300,000 â‚ª ×›×•×œ×œ ×‘×•× ×•×¡×™×","×”×—×‘×¨×” ×”×¤×¡×™×“×” 800 ××™×œ×™×•×Ÿ â‚ª","×©×›×¨ ×××•×¦×¢ ×‘××©×§: 12,500 â‚ª â€” ×¤×™ 24 ×¤×—×•×ª"],
    "×—×‘×¨×”":["300 ×¢×•×‘×“×™ ×§×‘×œ×Ÿ ××¨×•×•×™×—×™× ××™× ×™××•×","×¢×•×‘×“×™× ×–×•×˜×¨×™× ×œ×œ× ×”×¢×œ××” 3 ×©× ×™×","×‘×“× ××¨×§ ×¤×¢×¨ ××§×¡×™××œ×™ ×¤×™ 6"],
    "×¤×•×œ×™×˜×™×§×”":["×—\"×›: '×©×•×“ ×›×¡×¤×™ ×¦×™×‘×•×¨'","×”×“×™×¨×§×˜×•×¨×™×•×Ÿ ××™×©×¨ ×›×“×™×Ÿ","×•×¢×“ ×¢×•×‘×“×™× ×“×•×¨×© ×”×¢×œ××”"],
    "×× ×©×™×":["300 ×¢×•×‘×“×™ ×§×‘×œ×Ÿ ×¢× ×©×›×¨ ××™× ×™××•×","×¤×¢×¨ ×©×œ ×¤×™ 24 ×‘×©×›×¨","×”×¢×•×‘×“×™× ×”×–×•×˜×¨×™× ××¨×’×™×©×™× ××•×©×¤×œ×™×"]
  },
  framings:[
    {id:"economic",headline:"300,000 â‚ª ×‘×—×•×“×© â€” ×‘×—×‘×¨×” ×©××¤×¡×™×“×” 800 ××™×œ×™×•×Ÿ",subtitle:"××™×š ×× ×›\"×œ ××§×‘×œ ×‘×•× ×•×¡ ×›×©×”×—×‘×¨×” ×©×•×§×¢×ª?"},
    {id:"social",headline:"×¤×™ 24 ××”×¢×•×‘×“ ×”×§×˜×Ÿ: ×”×©×›×¨ ×©×—×•×©×£ ××ª ×¤×¢×¨×™ ×™×©×¨××œ",subtitle:"300 ×¢×•×‘×“×™ ×§×‘×œ×Ÿ ××¨×•×•×™×—×™× ××™× ×™××•× â€” ×•×”×× ×›\"×œ 300 ××œ×£"},
    {id:"political",headline:"'×©×•×“ ×¦×™×‘×•×¨×™': ×”×›× ×¡×ª ×“×•×¨×©×ª ×—×§×™×¨×” ×¢×œ ×©×›×¨ ×”×× ×›\"×œ×™×",subtitle:"××™ ××¤×§×—? ××™ ×××©×¨? ×•×œ××” ××£ ××—×“ ×œ× ×¢×•×¦×¨ ××ª ×–×”?"},
    {id:"human",headline:"'×× ×™ ×¢×•×‘×“ 10 ×©×¢×•×ª ×‘×™×•× ×•×—×™ ×‘××•×‘×¨×“×¨××¤×˜ â€” ×•×”×•× ××§×‘×œ 300 ××œ×£'",subtitle:"×¢×•×‘×“ ×”×§×‘×œ×Ÿ ××•×œ ×”×× ×›\"×œ: ×©× ×™ ×¢×•×œ××•×ª ×‘××•×ª×” ×—×‘×¨×”"}
  ]
}
];

function pickRandomEvent(){return ALL_EVENTS[Math.floor(Math.random()*ALL_EVENTS.length)]}
// ============ STATE ============
const S={
  mode:"landing",studentName:"",teacherName:"",sessionId:"",
  event:null,
  selectedTopic:null,     // chosen topic string
  topicReason:"",         // why they chose this topic
  selectedFraming:null,   // index into event.framings
  framingReason:"",       // why they chose this framing
  articleSubtitle:"",     // student writes subtitle
  articleBody:"",         // student writes body
  submissions:[],
};

const esc=s=>{const d=document.createElement('div');d.textContent=s;return d.innerHTML};
function encodeToHash(data){try{return btoa(unescape(encodeURIComponent(JSON.stringify(data))))}catch(e){return""}}
function decodeFromHash(hash){try{return JSON.parse(decodeURIComponent(escape(atob(hash))))}catch(e){return null}}
function getBaseUrl(){return window.location.href.split('#')[0]}
function checkUrl(){const h=window.location.hash.substring(1);if(h&&h.length>10){const d=decodeFromHash(h);if(d&&d.event&&d.session)return d}return null}
function saveToFirebase(data){if(!db||!S.sessionId)return Promise.resolve();const key=S.studentName.replace(/[.#$/[\]]/g,'_');return db.ref(`framing2/${S.sessionId}/submissions/${key}`).set(data).catch(e=>console.warn(e))}
function loadSubmissions(){if(!db||!S.sessionId)return Promise.resolve([]);return db.ref(`framing2/${S.sessionId}/submissions`).once('value').then(snap=>{const v=snap.val();return v?Object.values(v):[]}).catch(()=>[])}

function render(){
  document.getElementById("app").innerHTML=
    S.mode==="landing"?renderLanding():
    S.mode==="teacher"?renderTeacher():
    S.mode==="teacher-view"?renderTeacherView():
    S.mode==="student-name"?renderStudentName():
    renderApp();
  attachEvents();
}

function renderLanding(){
  return`<div class="landing">
    <div class="landing-logo">ğŸ”€</div><h1>××•×ª×• ××™×¨×•×¢, ×¡×™×¤×•×¨ ××—×¨</h1>
    <div class="tagline">×¡×™××•×œ×¦×™×™×ª ××™×¡×’×•×¨ ×ª×§×©×•×¨×ª×™</div>
    <div class="credit">×¤×™×ª×•×—: ×¨× ×™ ×‘×Ÿ ×–××‘</div>
    <div class="landing-card">
      <div class="ci">ğŸ‘¨â€ğŸ«</div><h2>××–×•×¨ ××•×¨×”</h2>
      <p>×¦×•×¨ ×ª×¨×’×™×œ ×œ×›×™×ª×”: ××™×¨×•×¢ ××§×¨××™ ××”×××’×¨, ×›×œ ×”×ª×œ××™×“×™× ×™×¢×‘×“×• ×¢×œ ××•×ª×• ××™×¨×•×¢ ×•×™×‘×—×¨×• ××¡×’×•×¨ ×©×•× ×”.</p>
      <ol><li>×”×–×Ÿ ×©× â†’ ×¦×•×¨ ×ª×¨×’×™×œ</li><li>×©×œ×— ×§×™×©×•×¨ ×œ×ª×œ××™×“×™×</li><li>×¦×¤×” ×‘×”×’×©×•×ª ×•×”×©×•×•×” ×‘×›×™×ª×”</li></ol>
      <button class="lbtn" data-action="goto-teacher">×™×¦×™×¨×ª ×ª×¨×’×™×œ ×œ×›×™×ª×” â†’</button>
      <p class="landing-hint">ğŸ’¡ ×”×ª×œ××™×“×™× ××§×‘×œ×™× ×§×™×©×•×¨ ×™×©×™×¨</p>
    </div>
    <div class="landing-footer">×¡×™××•×œ×¦×™×™×ª ××™×¡×’×•×¨ ×ª×§×©×•×¨×ª×™ â€¢ ×ª×§×©×•×¨×ª ×•×—×‘×¨×”</div>
  </div>`;
}

function renderTeacher(){
  const hasEv=!!S.event;
  const preview=hasEv?`<div style="margin-top:12px;background:#fff;border-radius:var(--rl);padding:14px;border:1px solid var(--bl)">
    <h3 style="font-family:var(--fd);font-size:1rem;margin-bottom:4px">ğŸ“‹ ${esc(S.event.title)}</h3>
    <p style="font-size:.8rem;color:var(--muted);margin-bottom:8px">${esc(S.event.context)}</p>
    <div style="font-size:.78rem;color:#666"><strong>× ×•×©××™×:</strong> ${Object.keys(S.event.topics).join(', ')}</div>
    <div style="font-size:.78rem;color:#666;margin-top:3px"><strong>××¡×’×•×¨×™×:</strong> ${S.event.framings.map(f=>'<span style="background:'+getFrame(f.id).color+'15;color:'+getFrame(f.id).color+';padding:1px 8px;border-radius:10px;font-size:.72rem;margin-left:3px">'+getFrame(f.id).name+'</span>').join('')}</div>
  </div>`:"";
  const sLink=S.sessionId?getBaseUrl()+"#"+encodeToHash({event:S.event,teacher:S.teacherName,session:S.sessionId}):"";
  const tLink=S.sessionId?getBaseUrl()+"#"+encodeToHash({teacherView:true,teacher:S.teacherName,session:S.sessionId,event:S.event}):"";
  const linkHtml=S.sessionId?`<div class="link-result"><h3>âœ… ××•×›×Ÿ!</h3>
    <p style="font-size:.76rem;color:#555;text-align:center;margin-bottom:4px"><strong>×œ×ª×œ××™×“×™×:</strong></p><textarea class="link-url" id="studentLink" readonly>${sLink}</textarea><div class="link-actions"><button class="copy-btn" data-action="copy-student-link">ğŸ“‹ ×”×¢×ª×§</button></div>
    <p style="font-size:.76rem;color:#555;text-align:center;margin:7px 0 3px"><strong>×œ××•×¨×”:</strong></p><textarea class="link-url" id="teacherLink" readonly>${tLink}</textarea><div class="link-actions"><button class="copy-btn" data-action="copy-teacher-link">ğŸ“‹ ×”×¢×ª×§</button><button class="new-btn" data-action="regenerate">ğŸ”„ ××™×¨×•×¢ ××—×¨</button></div>
  </div>`:"";
  return`<div class="container" style="max-width:620px;margin-top:22px">
    <div class="credit-bar">×¤×™×ª×•×— ×”×¡×™××•×œ×¦×™×”: ×¨× ×™ ×‘×Ÿ ×–××‘</div>
    <button class="btn btn-muted" data-action="goto-landing" style="margin-bottom:10px;font-size:.78rem">â†’ ×—×–×¨×”</button>
    <div class="info-box"><h2>ğŸ‘¨â€ğŸ« ×™×¦×™×¨×ª ×ª×¨×’×™×œ ××™×¡×’×•×¨</h2><p>×”×–×Ÿ ×©×, ×¦×•×¨ ××™×¨×•×¢, ×©×œ×— ×§×™×©×•×¨ ×œ×›×™×ª×”.</p></div>
    <div style="background:#fff;border-radius:var(--rl);padding:14px 18px;border:1px solid var(--bl)">
      <label style="font-size:.81rem;font-weight:700;font-family:var(--fu);display:block;margin-bottom:3px">×©× ×”××•×¨×”</label>
      <input type="text" class="modal-input" id="teacherNameInput" placeholder="×œ××©×œ: ×™×•×¡×™ ×›×”×Ÿ" value="${esc(S.teacherName)}" style="text-align:center;font-family:var(--fd);font-weight:700;margin-bottom:7px">
      <button class="modal-btn primary" data-action="generate-event">ğŸ² ×¦×•×¨ ×ª×¨×’×™×œ</button>
    </div>${preview}${linkHtml}
  </div>`;
}

function renderTeacherView(){
  if(!S.submissions.length)return`<div class="container" style="max-width:900px;margin-top:22px">
    <div class="credit-bar">×¤×™×ª×•×— ×”×¡×™××•×œ×¦×™×”: ×¨× ×™ ×‘×Ÿ ×–××‘</div>
    <button class="btn btn-muted" data-action="goto-landing" style="margin-bottom:10px;font-size:.78rem">â†’ ×—×–×¨×”</button>
    <div class="info-box"><h2>ğŸ“Š ×”×’×©×•×ª â€” ${esc(S.teacherName)}</h2><p>0 ×”×’×©×•×ª â€¢ <button class="btn btn-dark" data-action="refresh-subs" style="padding:4px 9px;font-size:.74rem">ğŸ”„ ×¨×¢× ×Ÿ</button></p></div>
    <div style="text-align:center;padding:30px;color:var(--muted)"><div style="font-size:2.2rem;margin-bottom:5px">ğŸ“­</div><h3>×¢×“×™×™×Ÿ ××™×Ÿ ×”×’×©×•×ª</h3></div></div>`;

  // Topic popularity
  const topicCounts={};S.submissions.forEach(s=>{if(s.selectedTopic)topicCounts[s.selectedTopic]=(topicCounts[s.selectedTopic]||0)+1});
  // Framing popularity
  const frameCounts={};S.submissions.forEach(s=>{const fr=S.event?.framings?.[s.selectedFraming];if(fr)frameCounts[fr.id]=(frameCounts[fr.id]||0)+1});

  const topicBar=Object.entries(topicCounts).sort((a,b)=>b[1]-a[1]).map(([t,c])=>{const pct=Math.round(c/S.submissions.length*100);return`<div style="margin-bottom:5px"><div style="display:flex;justify-content:space-between;font-size:.8rem"><span>${TOPIC_ICONS[t]||'ğŸ“„'} ${t}</span><span style="color:#888">${c} (${pct}%)</span></div><div style="height:4px;background:#f0f0f0;border-radius:3px"><div style="height:100%;width:${pct}%;background:var(--accent);border-radius:3px"></div></div></div>`}).join("");

  const frameBar=Object.entries(frameCounts).sort((a,b)=>b[1]-a[1]).map(([fid,c])=>{const f=getFrame(fid);const pct=Math.round(c/S.submissions.length*100);return`<div style="margin-bottom:5px"><div style="display:flex;justify-content:space-between;font-size:.8rem"><span>${f.icon} ${f.name}</span><span style="color:#888">${c} (${pct}%)</span></div><div style="height:4px;background:#f0f0f0;border-radius:3px"><div style="height:100%;width:${pct}%;background:${f.color};border-radius:3px"></div></div></div>`}).join("");

  // All headlines
  const headlinesHtml=S.submissions.map(sub=>{
    const fr=S.event?.framings?.[sub.selectedFraming];if(!fr)return'';const f=getFrame(fr.id);
    return`<div style="padding:6px 0;border-bottom:1px solid #f5f5f0;display:flex;gap:7px;align-items:flex-start">
      <span style="background:${f.color};color:#fff;padding:1px 7px;border-radius:10px;font-size:.66rem;font-family:var(--fu);white-space:nowrap">${f.name}</span>
      <div><strong style="font-family:var(--fd);font-size:.86rem">${esc(fr.headline)}</strong><span style="font-size:.7rem;color:#aaa;margin-right:6px">â€” ${esc(sub.studentName)}</span></div>
    </div>`;
  }).join("");

  // Full submissions
  const subCards=S.submissions.map(sub=>{
    const fr=S.event?.framings?.[sub.selectedFraming];const f=fr?getFrame(fr.id):{name:'',icon:'',color:'#888'};
    return`<div class="sub-card">
      <h4>ğŸ‘¤ ${esc(sub.studentName)}</h4>
      <div class="sub-meta">${sub.timestamp?new Date(sub.timestamp).toLocaleString("he-IL"):''}</div>
      <div style="margin-bottom:8px">
        <div style="font-size:.8rem;margin-bottom:3px"><strong>× ×•×©× ×©× ×‘×—×¨:</strong> ${TOPIC_ICONS[sub.selectedTopic]||''} ${esc(sub.selectedTopic||'')}</div>
        <div style="font-size:.78rem;color:#666;background:#faf9f5;padding:4px 8px;border-radius:4px;border-right:3px solid var(--accent)">${esc(sub.topicReason||'')}</div>
      </div>
      <div style="margin-bottom:8px">
        <div style="font-size:.8rem;margin-bottom:3px"><strong>××¡×’×•×¨:</strong> <span style="background:${f.color};color:#fff;padding:1px 7px;border-radius:10px;font-size:.7rem">${f.icon} ${f.name}</span></div>
        <div style="font-size:.78rem;color:#666;background:#faf9f5;padding:4px 8px;border-radius:4px;border-right:3px solid ${f.color}">${esc(sub.framingReason||'')}</div>
      </div>
      ${fr?`<div style="background:var(--pbr);border:1.5px solid var(--ink);border-radius:3px;padding:14px;margin-top:6px">
        <div style="text-align:center;border-bottom:2px double var(--ink);padding-bottom:7px;margin-bottom:9px">
          <h3 style="font-family:var(--fd);font-size:1.15rem;font-weight:900;line-height:1.2">${esc(fr.headline)}</h3>
          <p style="font-size:.82rem;color:#555">${esc(sub.articleSubtitle||fr.subtitle)}</p>
        </div>
        <p style="font-size:.84rem;line-height:1.65;text-align:justify">${esc(sub.articleBody||'')}</p>
        <div style="font-size:.68rem;color:var(--muted);margin-top:7px;text-align:left;border-top:1px solid var(--border);padding-top:4px">×›×ª×‘/×”: ${esc(sub.studentName)}</div>
      </div>`:''}
    </div>`;
  }).join("");

  return`<div class="container" style="max-width:900px;margin-top:22px">
    <div class="credit-bar">×¤×™×ª×•×— ×”×¡×™××•×œ×¦×™×”: ×¨× ×™ ×‘×Ÿ ×–××‘</div>
    <button class="btn btn-muted" data-action="goto-landing" style="margin-bottom:10px;font-size:.78rem">â†’ ×—×–×¨×”</button>
    <div class="info-box"><h2>ğŸ“Š ×”×’×©×•×ª â€” ${esc(S.teacherName)}</h2><p>××™×¨×•×¢: <strong>${esc(S.event?.title||'')}</strong> â€¢ ${S.submissions.length} ×”×’×©×•×ª â€¢ <button class="btn btn-dark" data-action="refresh-subs" style="padding:4px 9px;font-size:.74rem">ğŸ”„ ×¨×¢× ×Ÿ</button></p></div>
    <div class="info-box"><h3 style="font-family:var(--fd);margin-bottom:6px">ğŸ“Š × ×•×©××™× ×©× ×‘×—×¨×•</h3>${topicBar}</div>
    <div class="info-box"><h3 style="font-family:var(--fd);margin-bottom:6px">ğŸ”€ ××¡×’×•×¨×™× ×©× ×‘×—×¨×•</h3>${frameBar}</div>
    <div class="info-box"><h3 style="font-family:var(--fd);margin-bottom:8px">ğŸ“° ×›×•×ª×¨×•×ª â€” ××•×ª×• ××™×¨×•×¢!</h3>${headlinesHtml}</div>
    ${subCards}
  </div>`;
}

function renderStudentName(){
  return`<div class="modal-overlay"><div class="modal-card" style="text-align:center">
    <div style="font-size:2.6rem;margin-bottom:4px">ğŸ”€</div>
    <h2>××•×ª×• ××™×¨×•×¢, ×¡×™×¤×•×¨ ××—×¨</h2>
    <div class="modal-sub">×¡×™××•×œ×¦×™×™×ª ××™×¡×’×•×¨ ×ª×§×©×•×¨×ª×™<br><span style="font-size:.72rem;color:#b0a898">×¤×™×ª×•×—: ×¨× ×™ ×‘×Ÿ ×–××‘${S.teacherName?' â€¢ ××•×¨×”: '+esc(S.teacherName):''}</span></div>
    <div class="instructions-box" style="text-align:right;margin-bottom:10px"><h3>ğŸ“‹ ××” ×¢×•×©×™×?</h3>
      <ol><li>×§×¨××• "×ª×™×§ ×¢×•×‘×“×•×ª" â€” ××™×¨×•×¢ ×¢× × ×ª×•× ×™× ×™×‘×©×™×</li><li>×‘×—×¨×• × ×•×©× ×©×—×©×•×‘ ×œ×›× ××ª×•×š ×”×¢×•×‘×“×•×ª</li><li>×¨××• 4 ×›×•×ª×¨×•×ª ×©×•× ×•×ª â€” ×›×œ ××—×ª ×××¡×’×¨×ª ××ª ×”××™×¨×•×¢ ××—×¨×ª</li><li>×‘×—×¨×• ×›×•×ª×¨×ª, ×›×ª×‘×• ×›×ª×‘×” ×§×¦×¨×”</li><li>×©×œ×—×• ×œ××•×¨×”</li></ol>
    </div>
    <label style="text-align:right;font-size:.81rem;font-weight:700;font-family:var(--fu);display:block">×”×©× ×©×œ×š</label>
    <input type="text" class="modal-input" id="nameInput" placeholder="×©× ××œ×..." style="text-align:center;font-family:var(--fd);font-weight:700" autofocus>
    <button class="modal-btn primary" id="startBtn" disabled data-action="start-exercise">×”×ª×—×œ/×™ â†</button>
  </div></div>`;
}

function renderApp(){return renderHeader()+renderPhase()}
function renderHeader(){
  const phases=[{id:"facts",l:"â‘  ×¢×•×‘×“×•×ª"},{id:"topic",l:"â‘¡ × ×•×©×"},{id:"framing",l:"â‘¢ ××¡×’×•×¨"},{id:"write",l:"â‘£ ×›×ª×™×‘×”"},{id:"preview",l:"â‘¤ ×©×œ×™×—×”"}];
  const order=["facts","topic","framing","write","preview"];const ci=order.indexOf(S.mode);
  const pills=phases.map(p=>{const i=order.indexOf(p.id);let c="phase-pill";if(p.id===S.mode)c+=" active";else if(i<ci)c+=" done";return`<div class="${c}">${p.l}</div>`}).join("");
  return`<div class="app-header"><div class="header-brand"><span class="logo">ğŸ”€</span><div><h1>××•×ª×• ××™×¨×•×¢, ×¡×™×¤×•×¨ ××—×¨</h1><div class="meta">${esc(S.studentName)}</div></div></div><div class="phase-indicators">${pills}</div></div><div class="credit-bar">×¤×™×ª×•×— ×”×¡×™××•×œ×¦×™×”: ×¨× ×™ ×‘×Ÿ ×–××‘</div>`;
}
function renderPhase(){switch(S.mode){case"facts":return renderFacts();case"topic":return renderTopic();case"framing":return renderFraming();case"write":return renderWrite();case"preview":return renderPreview();default:return""}}

function renderFacts(){
  const ev=S.event;const allFacts=Object.entries(ev.topics).map(([t,facts])=>facts).flat();
  return`<div class="container">
    <div class="info-box"><h2>×©×œ×‘ 1: ×§×¨××• ××ª ×ª×™×§ ×”×¢×•×‘×“×•×ª</h2><p>×œ×¤× ×™×›× ××™×¨×•×¢ ×¢× ×¢×•×‘×“×•×ª ×™×‘×©×•×ª ×‘×œ×‘×“. ×§×¨××• ×‘×¢×™×•×Ÿ â€” ×‘×©×œ×‘ ×”×‘× ×ª×‘×—×¨×• ×¢×œ ××” ×œ×”×ª××§×“.</p></div>
    <div class="fact-file"><h3>${esc(ev.title)}</h3><div class="context">${esc(ev.context)}</div>
      <ul class="fact-list">${allFacts.map(f=>`<li>${esc(f)}</li>`).join("")}</ul>
    </div>
    <div class="btn-center"><button class="btn btn-accent" data-action="goto-topic">×”×‘× ×ª×™, ×××©×™×š â†</button></div>
  </div>`;
}

function renderTopic(){
  const ev=S.event;const topics=Object.keys(ev.topics);
  const cards=topics.map(t=>{const sel=S.selectedTopic===t;const icon=TOPIC_ICONS[t]||'ğŸ“„';const facts=ev.topics[t];
    return`<div class="topic-card ${sel?'selected':''}" data-action="select-topic" data-topic="${esc(t)}">
      ${sel?'<div class="check">âœ“</div>':''}
      <div class="topic-icon">${icon}</div>
      <div class="topic-name">${esc(t)}</div>
      <div class="topic-facts">${facts.length} ×¢×•×‘×“×•×ª</div>
    </div>`;
  }).join("");
  const factsPreview=S.selectedTopic?`<div class="relevant-facts" style="margin-top:12px"><h4>${TOPIC_ICONS[S.selectedTopic]||''} ×¢×•×‘×“×•×ª ×‘× ×•×©× "${S.selectedTopic}":</h4><ul>${S.event.topics[S.selectedTopic].map(f=>`<li>${esc(f)}</li>`).join("")}</ul></div>`:'';
  const justifyHtml=S.selectedTopic?`<div class="justify-box"><h3>ğŸ¤” ××“×•×¢ ×‘×—×¨×ª ×‘× ×•×©× "${S.selectedTopic}"?</h3><p>×”×¡×‘×¨/×™ ×œ××” × ×•×©× ×–×” ×—×©×•×‘ ×™×•×ª×¨ ××”××—×¨×™× ×œ×“×¢×ª×š.</p><textarea class="justify-textarea" id="topicReasonInput" placeholder="×›×ª×•×‘/×™ ×›××Ÿ...">${esc(S.topicReason)}</textarea></div>`:'';
  return`<div class="container">
    <div class="info-box"><h2>×©×œ×‘ 2: ×‘×—×¨×• × ×•×©×</h2><p>×”×¢×•×‘×“×•×ª ××—×•×œ×§×•×ª ×œ× ×•×©××™×. <strong>×¢×œ ××” ×”×™×™×ª× ××ª××§×“×™× ×‘×›×ª×‘×”?</strong> ×‘×—×¨×• ××ª ×”× ×•×©× ×©×”×›×™ ×—×©×•×‘ ×œ×“×¢×ª×›×.</p></div>
    <div class="topic-grid">${cards}</div>
    ${factsPreview}${justifyHtml}
    ${S.selectedTopic&&S.topicReason.length>5?'<div class="btn-center"><button class="btn btn-accent" data-action="goto-framing">×”××©×š ×œ×‘×—×™×¨×ª ××¡×’×•×¨ â†</button></div>':''}
    <div class="btn-center"><button class="btn btn-muted" data-action="goto-facts">â†’ ×—×–×¨×”</button></div>
  </div>`;
}

function renderFraming(){
  const ev=S.event;const topicFacts=ev.topics[S.selectedTopic]||[];
  const options=ev.framings.map((fr,i)=>{const f=getFrame(fr.id);const sel=S.selectedFraming===i;
    return`<div class="framing-card ${sel?'selected':''}" data-action="select-framing" data-idx="${i}" style="${sel?'border-color:'+f.color+';background:'+f.color+'08':''}">
      ${sel?`<div class="check" style="background:${f.color}">âœ“</div>`:''}
      <div class="fc-label" style="background:${f.color}">${f.icon} ${f.name}</div>
      <h3>${esc(fr.headline)}</h3>
      <div class="fc-sub">${esc(fr.subtitle)}</div>
    </div>`;
  }).join("");
  const justifyHtml=S.selectedFraming!==null?`<div class="justify-box"><h3>ğŸ¤” ××“×•×¢ ×‘×—×¨×ª ×‘××¡×’×•×¨ ×”×–×”?</h3><p>×”×¡×‘×¨/×™: ×œ××” ×”×›×•×ª×¨×ª ×”×–×• ××™×™×¦×’×ª ××ª ×”×¡×™×¤×•×¨ ×”×›×™ ×˜×•×‘ ×œ×“×¢×ª×š?</p><textarea class="justify-textarea" id="framingReasonInput" placeholder="×›×ª×•×‘/×™...">${esc(S.framingReason)}</textarea></div>`:'';
  return`<div class="container">
    <div class="info-box"><h2>×©×œ×‘ 3: ×‘×—×¨×• ××¡×’×•×¨ (×›×•×ª×¨×ª)</h2><p>××•×ª×Ÿ ×¢×•×‘×“×•×ª â€” 4 ×›×•×ª×¨×•×ª ×©×•× ×•×ª! ×›×œ ××—×ª ×××¡×’×¨×ª ××ª ×”××™×¨×•×¢ ××–×•×•×™×ª ××—×¨×ª. <strong>××™×–×• ×›×•×ª×¨×ª ×”×™×™×ª× ×©××™× ×‘×“×£ ×”×¨××©×•×Ÿ?</strong></p></div>
    <div class="relevant-facts"><h4>${TOPIC_ICONS[S.selectedTopic]||''} ×”×¢×•×‘×“×•×ª ×©×‘×—×¨×ª ×œ×”×ª××§×“ ×‘×”×Ÿ:</h4><ul>${topicFacts.map(f=>`<li>${esc(f)}</li>`).join("")}</ul></div>
    <div class="framing-options">${options}</div>
    ${justifyHtml}
    ${S.selectedFraming!==null&&S.framingReason.length>5?'<div class="btn-center"><button class="btn btn-accent" data-action="goto-write">×”××©×š ×œ×›×ª×™×‘×” â†</button></div>':''}
    <div class="btn-center"><button class="btn btn-muted" data-action="goto-topic">â†’ ×—×–×¨×”</button></div>
  </div>`;
}

function renderWrite(){
  const fr=S.event.framings[S.selectedFraming];const f=getFrame(fr.id);const topicFacts=S.event.topics[S.selectedTopic]||[];
  return`<div class="container">
    <div class="info-box"><h2>×©×œ×‘ 4: ×›×ª×™×‘×ª ×”×›×ª×‘×”</h2><p>×›×ª×•×‘/×™ ×›×ª×‘×” ×§×¦×¨×” ×œ×¤×™ ×”××¡×’×•×¨ ×©×‘×—×¨×ª. ×”×›×•×ª×¨×ª ×›×‘×¨ × ×‘×—×¨×” â€” ×¢×›×©×™×• ×›×ª×•×‘/×™ ×›×•×ª×¨×ª ××©× ×” ×•××ª ×’×•×£ ×”×›×ª×‘×”.</p></div>
    <div class="relevant-facts"><h4>${TOPIC_ICONS[S.selectedTopic]||''} ×”×¢×•×‘×“×•×ª ×©×œ×š:</h4><ul>${topicFacts.map(f=>`<li>${esc(f)}</li>`).join("")}</ul></div>
    <div class="write-panel">
      <div style="text-align:center;margin-bottom:10px">
        <span class="fc-label" style="background:${f.color};display:inline-block;padding:3px 14px;border-radius:20px;font-size:.78rem;font-family:var(--fu);color:#fff">${f.icon} ××¡×’×•×¨ ${f.name}</span>
      </div>
      <div style="background:var(--pbr);border:1px solid var(--ink);border-radius:3px;padding:12px;margin-bottom:10px;text-align:center">
        <h3 style="font-family:var(--fd);font-size:1.15rem;font-weight:900;line-height:1.25">${esc(fr.headline)}</h3>
      </div>
      <label>×›×•×ª×¨×ª ××©× ×”</label>
      <input type="text" class="write-input" id="subtitleInput" value="${esc(S.articleSubtitle)}" placeholder="×›×ª×•×‘/×™ ×›×•×ª×¨×ª ××©× ×”...">
      <label>×’×•×£ ×”×›×ª×‘×”</label>
      <textarea class="write-textarea" id="bodyInput" placeholder="×›×ª×•×‘/×™ ××ª ×”×›×ª×‘×”... ×”×©×ª××©/×™ ×‘×¢×•×‘×“×•×ª ×©×‘×—×¨×ª.">${esc(S.articleBody)}</textarea>
    </div>
    <div class="btn-center"><button class="btn btn-muted" data-action="goto-framing">â†’ ×—×–×¨×”</button><button class="btn btn-accent" data-action="goto-preview">×¦×¤×™×™×” ×•×©×œ×™×—×” â†</button></div>
  </div>`;
}

function renderPreview(){
  const fr=S.event.framings[S.selectedFraming];const f=getFrame(fr.id);
  return`<div class="container">
    <div style="background:#fff;border-radius:var(--rl);padding:12px 18px;margin-bottom:14px;border:1px solid var(--bl);display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:8px">
      <div><h2 style="font-family:var(--fd);font-size:1.08rem">ğŸ“° ×”×›×ª×‘×” ×©×œ×™</h2><p style="font-size:.78rem;color:var(--muted)">${esc(S.studentName)} â€¢ ${esc(S.event.title)}</p></div>
      <div style="display:flex;gap:6px"><button class="btn btn-muted" data-action="goto-write" style="padding:6px 11px;font-size:.78rem">â†’ ×—×–×¨×”</button><button class="btn btn-dark" data-action="submit-work" style="padding:6px 11px;font-size:.78rem">ğŸ“¤ ×©×œ×— ×œ××•×¨×”</button><button class="btn btn-accent" data-action="print" style="padding:6px 11px;font-size:.78rem">ğŸ–¨ï¸</button></div>
    </div>
    <div class="result-newspaper">
      <div class="rn-header">
        <span style="background:${f.color};color:#fff;padding:2px 12px;border-radius:20px;font-size:.72rem;font-family:var(--fu)">${f.icon} ${f.name}</span>
        <h1>${esc(fr.headline)}</h1>
        <div class="rn-sub">${esc(S.articleSubtitle||fr.subtitle)}</div>
      </div>
      <div class="rn-body">${esc(S.articleBody).replace(/\n/g,'<br>')}</div>
      <div class="rn-byline">×›×ª×‘/×”: ${esc(S.studentName)}</div>
    </div>
    <div class="decision-trail"><h3>ğŸ—ºï¸ ××¡×œ×•×œ ×”×”×—×œ×˜×•×ª ×©×œ×™</h3>
      <div class="dt-step"><div class="dt-q">× ×•×©× ×©×‘×—×¨×ª×™:</div><div class="dt-a">${TOPIC_ICONS[S.selectedTopic]||''} ${esc(S.selectedTopic||'')}</div><div class="dt-why">${esc(S.topicReason)}</div></div>
      <div class="dt-step" style="border-right-color:${f.color}"><div class="dt-q">××¡×’×•×¨ ×©×‘×—×¨×ª×™:</div><div class="dt-a">${f.icon} ${f.name} â€” ${esc(fr.headline)}</div><div class="dt-why">${esc(S.framingReason)}</div></div>
    </div>
  </div>`;
}

// ============ EVENTS ============
function attachEvents(){
  const ni=document.getElementById("nameInput"),sb=document.getElementById("startBtn");
  if(ni&&sb){ni.addEventListener("input",()=>{sb.disabled=!ni.value.trim()});ni.addEventListener("keydown",e=>{if(e.key==="Enter"&&ni.value.trim()){S.studentName=ni.value.trim();S.mode="facts";render()}});sb.addEventListener("click",()=>{if(ni.value.trim()){S.studentName=ni.value.trim();S.mode="facts";render()}});ni.focus()}
  const ti=document.getElementById("teacherNameInput");if(ti)ti.addEventListener("input",()=>{S.teacherName=ti.value});
  const tri=document.getElementById("topicReasonInput");if(tri)tri.addEventListener("input",()=>{S.topicReason=tri.value});
  const fri=document.getElementById("framingReasonInput");if(fri)fri.addEventListener("input",()=>{S.framingReason=fri.value});
  const si=document.getElementById("subtitleInput");if(si)si.addEventListener("input",()=>{S.articleSubtitle=si.value});
  const bi=document.getElementById("bodyInput");if(bi)bi.addEventListener("input",()=>{S.articleBody=bi.value});
  document.removeEventListener("click",handleAction);document.addEventListener("click",handleAction);
}

async function handleAction(e){
  const el=e.target.closest("[data-action]");if(!el)return;const a=el.dataset.action;
  if(a==="select-topic"){S.selectedTopic=el.dataset.topic;S.selectedFraming=null;S.framingReason="";render();return}
  if(a==="select-framing"){S.selectedFraming=parseInt(el.dataset.idx);render();return}
  if(a==="goto-landing"){S.mode="landing";render();return}
  if(a==="goto-teacher"){S.mode="teacher";render();return}
  if(a==="generate-event"){if(!S.teacherName.trim()){alert("×”×–×Ÿ ×©×");return}S.event=pickRandomEvent();S.sessionId='fr2_'+Date.now().toString(36)+Math.random().toString(36).substr(2,4);render();return}
  if(a==="regenerate"){S.event=pickRandomEvent();S.sessionId='fr2_'+Date.now().toString(36)+Math.random().toString(36).substr(2,4);render();return}
  if(a==="copy-student-link"||a==="copy-teacher-link"){const id=a.includes("student")?"studentLink":"teacherLink";const ta=document.getElementById(id);if(ta){ta.select();try{await navigator.clipboard.writeText(ta.value)}catch(x){document.execCommand("copy")}el.textContent="âœ… ×”×•×¢×ª×§!";setTimeout(()=>{el.textContent="ğŸ“‹ ×”×¢×ª×§"},1800)}return}
  if(a==="submit-work"){const data={studentName:S.studentName,timestamp:new Date().toISOString(),selectedTopic:S.selectedTopic,topicReason:S.topicReason,selectedFraming:S.selectedFraming,framingReason:S.framingReason,articleSubtitle:S.articleSubtitle,articleBody:S.articleBody,eventId:S.event.id};await saveToFirebase(data);el.textContent="âœ… × ×©×œ×—!";el.style.background="#22c55e";setTimeout(()=>{el.textContent="ğŸ“¤ ×©×œ×— ×œ××•×¨×”";el.style.background=""},2500);return}
  if(a==="refresh-subs"){S.submissions=await loadSubmissions();render();return}
  if(a==="print"){window.print();return}
  const nav={"goto-facts":"facts","goto-topic":"topic","goto-framing":"framing","goto-write":"write","goto-preview":"preview","start-exercise":"facts"};
  if(nav[a]){S.mode=nav[a];render();window.scrollTo(0,0)}
}

const urlData=checkUrl();
if(urlData){
  if(urlData.teacherView){S.teacherName=urlData.teacher;S.sessionId=urlData.session;S.event=urlData.event;S.mode="teacher-view";loadSubmissions().then(subs=>{S.submissions=subs;render()})}
  else{S.event=urlData.event;S.teacherName=urlData.teacher;S.sessionId=urlData.session;S.mode="student-name"}
}
render();
</script></body></html>
