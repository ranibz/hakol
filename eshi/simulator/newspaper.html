<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>×¢×•×¨×š ×”×¢×™×ª×•×Ÿ â€” ×¡×™××•×œ×¦×™×” ×œ×¢×¨×™×›×” ×—×“×©×•×ª×™×ª</title>
<link href="https://fonts.googleapis.com/css2?family=David+Libre:wght@400;500;700&family=Frank+Ruhl+Libre:wght@300;400;500;700;900&family=Noto+Sans+Hebrew:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
<style>
:root{--ink:#1a1410;--paper:#f8f5ef;--pbr:#fefcf7;--accent:#b8292f;--accent-dk:#8a1f23;--slate:#2c3e50;--muted:#8a8070;--border:#d4cfc5;--bl:#e8e4dc;--fd:'Frank Ruhl Libre','David Libre',serif;--fb:'David Libre','Noto Sans Hebrew',serif;--fu:'Noto Sans Hebrew','David Libre',sans-serif;--r:8px;--rl:12px}
*{margin:0;padding:0;box-sizing:border-box}html{scroll-behavior:smooth}body{font-family:var(--fb);background:var(--paper);color:var(--ink);min-height:100vh;line-height:1.6}
@keyframes fadeIn{from{opacity:0}to{opacity:1}}
@keyframes slideUp{from{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}
@keyframes spin{to{transform:rotate(360deg)}}

/* Landing */
.landing{min-height:100vh;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:40px 20px;text-align:center;background:linear-gradient(180deg,#f8f5ef,#efe9de)}
.landing-logo{font-size:4rem;margin-bottom:10px}
.landing h1{font-family:var(--fd);font-size:2.3rem;font-weight:900;margin-bottom:3px}
.landing .tagline{font-size:1rem;color:var(--muted);margin-bottom:6px}
.landing .credit{font-size:.78rem;color:#b0a898;margin-bottom:32px}
.landing-cards{display:flex;gap:20px;flex-wrap:wrap;justify-content:center;max-width:820px;width:100%}
.landing-card{background:#fff;border-radius:16px;padding:30px 26px;flex:1;min-width:280px;max-width:390px;border:2px solid var(--bl);box-shadow:0 4px 20px rgba(0,0,0,.08);text-align:right;transition:all .3s}
.landing-card:hover{box-shadow:0 8px 30px rgba(0,0,0,.12);transform:translateY(-3px)}
.landing-card .ci{font-size:2.2rem;margin-bottom:8px;text-align:center}
.landing-card h2{font-family:var(--fd);font-size:1.15rem;margin-bottom:6px;text-align:center}
.landing-card p{font-size:.83rem;color:var(--muted);line-height:1.7;margin-bottom:14px}
.landing-card ol{font-size:.8rem;color:#666;line-height:1.8;padding-right:20px;margin-bottom:14px}
.landing-card ol li{margin-bottom:3px}
.lbtn{display:block;width:100%;padding:12px;font-size:.98rem;font-family:var(--fu);font-weight:700;border:none;border-radius:var(--r);cursor:pointer;transition:all .25s;text-align:center}
.lbtn.teacher{background:var(--slate);color:#fff}.lbtn.teacher:hover{background:#1a2a3a}
.lbtn.student{background:var(--accent);color:#fff}.lbtn.student:hover{background:var(--accent-dk)}
.landing-footer{margin-top:36px;font-size:.72rem;color:#c0b8a8}

/* Modal */
.modal-overlay{position:fixed;inset:0;background:rgba(20,16,10,.75);backdrop-filter:blur(6px);display:flex;align-items:center;justify-content:center;z-index:1000;animation:fadeIn .3s}
.modal-card{background:var(--pbr);border-radius:16px;padding:32px 36px;box-shadow:0 24px 80px rgba(0,0,0,.35);max-width:540px;width:92%;animation:slideUp .4s;text-align:right}
.modal-card h2{font-family:var(--fd);font-size:1.35rem;font-weight:900;margin-bottom:4px;text-align:center}
.modal-sub{color:var(--muted);font-size:.86rem;margin-bottom:18px;text-align:center;line-height:1.6}
.modal-card label{display:block;font-size:.83rem;font-weight:700;font-family:var(--fu);margin-bottom:3px;margin-top:10px}
.modal-input{width:100%;padding:10px 13px;font-size:.93rem;border:2px solid var(--border);border-radius:var(--r);font-family:var(--fb);outline:none;transition:border-color .2s;background:#fff}
.modal-input:focus{border-color:var(--accent)}
.modal-btn{width:100%;padding:11px;font-size:.95rem;font-family:var(--fu);font-weight:700;border:none;border-radius:var(--r);cursor:pointer;transition:all .25s;margin-top:12px}
.modal-btn.primary{background:var(--accent);color:#fff}.modal-btn.primary:hover{background:var(--accent-dk)}
.modal-btn.secondary{background:var(--bl);color:var(--ink);margin-top:7px}.modal-btn.secondary:hover{background:var(--border)}
.modal-btn:disabled{background:var(--border);cursor:default;color:#999}

/* Instructions */
.instructions-box{background:#fff9f0;border:1px solid #f0dfc0;border-radius:var(--rl);padding:14px 20px;margin-bottom:16px}
.instructions-box h3{font-size:.95rem;color:#b8860b;margin-bottom:5px;font-family:var(--fu)}
.instructions-box ol{font-size:.82rem;color:#666;line-height:1.8;padding-right:20px}
.instructions-box ol li{margin-bottom:2px}
.instructions-box p{font-size:.82rem;color:#888;line-height:1.6;margin-top:6px}

/* Header */
.app-header{background:var(--ink);color:var(--pbr);padding:0 20px;height:52px;display:flex;justify-content:space-between;align-items:center;position:sticky;top:0;z-index:100;box-shadow:0 2px 16px rgba(0,0,0,.25)}
.header-brand{display:flex;align-items:center;gap:10px}
.header-brand .logo{font-size:1.2rem}
.header-brand h1{font-family:var(--fd);font-size:1.05rem;font-weight:700}
.header-brand .meta{font-size:.68rem;opacity:.5}
.phase-indicators{display:flex;gap:4px}
.phase-pill{padding:4px 10px;border-radius:20px;font-size:.7rem;font-weight:600;font-family:var(--fu);background:rgba(255,255,255,.08);color:rgba(255,255,255,.3);transition:all .3s;white-space:nowrap}
.phase-pill.active{background:var(--accent);color:#fff}.phase-pill.done{background:rgba(255,255,255,.15);color:rgba(255,255,255,.6)}

/* Containers & Common */
.container{max-width:1140px;margin:0 auto;padding:22px 20px}
.container-wide{max-width:1300px;margin:0 auto;padding:22px 20px}
.info-box{background:#fff;border-radius:var(--rl);padding:16px 22px;margin-bottom:16px;border:1px solid var(--bl)}
.info-box h2{font-family:var(--fd);font-size:1.18rem;margin-bottom:4px}
.info-box p{color:var(--muted);font-size:.84rem;line-height:1.7}
.btn{display:inline-flex;align-items:center;gap:5px;padding:10px 22px;border-radius:var(--r);font-size:.87rem;font-weight:700;font-family:var(--fu);border:none;cursor:pointer;transition:all .25s}
.btn:active{transform:scale(.97)}
.btn-accent{background:var(--accent);color:#fff}.btn-accent:hover{background:var(--accent-dk)}
.btn-dark{background:var(--slate);color:#fff}.btn-dark:hover{background:#1a2a3a}
.btn-muted{background:#b0a898;color:#fff}.btn-muted:hover{background:#9a9080}
.btn-center{display:flex;justify-content:center;gap:12px;margin-top:22px;flex-wrap:wrap}
.counter-badge{display:inline-block;margin-top:10px;padding:5px 15px;border-radius:20px;font-size:.82rem;font-weight:700;font-family:var(--fu)}
.counter-badge.inc{background:#fff8e8;color:#d4950a}.counter-badge.ok{background:#e8f8e8;color:#1e8a3e}
.loading-screen{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:80vh;gap:18px}
.spinner{width:48px;height:48px;border:3px solid var(--border);border-top-color:var(--accent);border-radius:50%;animation:spin .9s linear infinite}
.loading-screen h2{font-family:var(--fd);font-size:1.2rem}.loading-screen p{color:var(--muted);font-size:.86rem}

/* Link result */
.link-result{margin-top:14px;padding:14px;background:#f0fff4;border:2px solid #27ae60;border-radius:var(--r);animation:slideUp .3s}
.link-result h3{font-size:.9rem;color:#1e8a3e;margin-bottom:6px;font-family:var(--fu);text-align:center}
.link-url{width:100%;padding:9px;background:#fff;border:1px solid #b8e6c8;border-radius:6px;font-family:monospace;font-size:.7rem;direction:ltr;text-align:left;word-break:break-all;margin-bottom:7px;resize:none;min-height:50px;outline:none}
.link-actions{display:flex;gap:8px}
.link-actions button{flex:1;padding:8px;font-family:var(--fu);font-weight:600;font-size:.83rem;border:none;border-radius:6px;cursor:pointer;transition:all .2s}
.link-actions .copy-btn{background:#27ae60;color:#fff}.link-actions .copy-btn:hover{background:#1e8a3e}
.link-actions .new-btn{background:#3498db;color:#fff}.link-actions .new-btn:hover{background:#2980b9}

/* News preview teacher */
.np-list{margin-top:12px;max-height:280px;overflow-y:auto;border:1px solid var(--bl);border-radius:var(--r);padding:6px}
.np-item{display:flex;align-items:flex-start;gap:7px;padding:7px;border-bottom:1px solid #f0f0f0;font-size:.8rem}
.np-item:last-child{border:none}
.np-num{background:var(--accent);color:#fff;min-width:20px;height:20px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:.68rem;font-weight:700;font-family:var(--fu)}
.np-info{flex:1}.np-info strong{font-family:var(--fd);font-size:.85rem}.np-cat{font-size:.68rem;font-weight:600;font-family:var(--fu)}

/* Rate phase */
.rate-card{background:#fff;border:1px solid var(--bl);border-radius:10px;margin-bottom:11px;overflow:hidden;transition:all .3s}
.rate-card.expanded{box-shadow:0 4px 12px rgba(0,0,0,.1)}
.rate-card-header{padding:12px 15px;cursor:pointer;display:flex;justify-content:space-between;align-items:flex-start;gap:10px}
.rate-card-header:hover{background:#fdfcf8}
.rate-card-header .rs{flex:1}.rate-card-header .ls{display:flex;flex-direction:column;align-items:center;gap:3px;min-width:48px}
.rate-card-header h3{font-family:var(--fd);font-size:.93rem;font-weight:700;line-height:1.4;margin-bottom:2px}
.rate-card-header .subtitle{font-size:.77rem;color:#666;line-height:1.45}
.tag-row{display:flex;gap:4px;flex-wrap:wrap;margin-bottom:5px;align-items:center}
.tag{padding:2px 9px;border-radius:12px;font-size:.68rem;font-weight:600;font-family:var(--fu)}
.tag-time{font-size:.64rem;color:#888;background:#f5f3ef;padding:2px 7px;border-radius:8px;font-family:var(--fu)}
.toggle-icon{font-size:1rem;color:#bbb;transition:transform .3s}.rate-card.expanded .toggle-icon{transform:rotate(180deg)}
.rate-card-body{padding:0 15px 13px;border-top:1px solid #f0ece4;display:none}.rate-card.expanded .rate-card-body{display:block}
.summary-text{font-size:.82rem;color:#555;line-height:1.6;padding:9px 0;border-bottom:1px solid #f0f0f0;margin-bottom:9px}
.criteria-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(255px,1fr));gap:6px}
.criterion-row{display:flex;align-items:center;gap:7px;padding:5px 8px;background:#faf9f5;border-radius:7px;border:1px solid #eee}
.criterion-icon{font-size:1.05rem;min-width:22px;text-align:center}
.criterion-info{flex:1}.criterion-name{font-size:.76rem;font-weight:700;font-family:var(--fu)}.criterion-desc{font-size:.64rem;color:var(--muted);line-height:1.3}
.star-rating{display:flex;gap:1px;direction:ltr}
.star-btn{background:none;border:none;font-size:1.15rem;cursor:pointer;padding:0 1px;transition:transform .12s;color:#ddd;line-height:1}.star-btn:hover{transform:scale(1.15)}.star-btn.filled{color:#f0a500}
.avg-score{text-align:center;margin-top:7px;padding:5px;background:#fff8e8;border-radius:7px;font-family:var(--fu);font-size:.78rem;font-weight:600;color:#b8860b}
.meta-badges{display:flex;gap:4px;flex-wrap:wrap;margin-top:4px}
.meta-tag{font-size:.64rem;color:#999;background:#f5f3ef;padding:2px 6px;border-radius:6px;font-family:var(--fu)}
.score-mini{font-family:var(--fu);font-size:.69rem;font-weight:700;color:#b8860b;background:#fff8e8;padding:2px 7px;border-radius:10px;white-space:nowrap}
.score-mini.empty{color:#ccc;background:#f5f5f0}

/* Select */
.news-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(305px,1fr));gap:11px}
.news-card{background:#fff;border:2px solid var(--bl);border-radius:10px;padding:14px;cursor:pointer;transition:all .25s;position:relative;overflow:hidden}
.news-card:hover{border-color:#c0b8a8;box-shadow:0 4px 12px rgba(0,0,0,.1);transform:translateY(-2px)}
.news-card.selected{background:#fffdf5;border-color:var(--accent)}.news-card.disabled{opacity:.4;cursor:not-allowed;pointer-events:none}
.news-card .check-badge{position:absolute;top:0;right:0;background:var(--accent);color:#fff;padding:3px 11px;border-bottom-left-radius:8px;font-size:.68rem;font-weight:700}
.news-card h3{font-family:var(--fd);font-size:.93rem;font-weight:700;line-height:1.4;margin-bottom:2px}
.news-card .subtitle{font-size:.77rem;color:#666;line-height:1.4}
.news-card .card-footer{margin-top:7px;display:flex;gap:5px;flex-wrap:wrap;align-items:center}

/* Arrange */
.arrange-layout{display:flex;gap:16px;flex-wrap:wrap}
.arrange-sidebar{flex:0 0 255px;display:flex;flex-direction:column;gap:9px}
.sidebar-section{background:#fff;border-radius:10px;padding:12px;border:1px solid var(--bl)}
.sidebar-section label{display:block;font-size:.8rem;font-weight:700;margin-bottom:4px;font-family:var(--fu)}
.name-input{width:100%;padding:7px 10px;border:1px solid var(--border);border-radius:6px;font-family:var(--fd);font-weight:700;font-size:1rem;text-align:center;outline:none}.name-input:focus{border-color:var(--accent)}
.layout-btn{display:block;width:100%;background:#f5f3ef;color:#444;border:2px solid transparent;border-radius:6px;padding:7px 10px;cursor:pointer;text-align:right;font-family:var(--fu);font-size:.8rem;transition:all .2s;margin-bottom:3px}
.layout-btn:hover{border-color:var(--border)}.layout-btn.active{background:var(--ink);color:#fff;border-color:var(--ink)}
.layout-btn strong{display:block;font-size:.84rem}.layout-btn .desc{font-size:.67rem;opacity:.6;margin-top:1px}
.drag-item{background:#fff;border:1px solid var(--bl);border-radius:6px;padding:6px 9px;cursor:grab;transition:all .2s;margin-bottom:3px;border-right:3px solid var(--accent)}
.drag-item:hover{box-shadow:0 1px 3px rgba(0,0,0,.08)}.drag-item:active{cursor:grabbing;opacity:.7}
.drag-item.placed{opacity:.3;cursor:default}
.drag-item .cat{font-size:.68rem;font-weight:600;margin-bottom:1px;font-family:var(--fu)}
.drag-item h4{font-family:var(--fd);font-size:.8rem;font-weight:700;line-height:1.3}
.drag-item .drag-score{font-size:.64rem;color:#b8860b;font-family:var(--fu);margin-top:1px}

/* Newspaper */
.newspaper-area{flex:1;min-width:0}
.newspaper-frame{background:var(--pbr);border:2px solid var(--ink);border-radius:3px;padding:18px;box-shadow:0 8px 30px rgba(0,0,0,.15)}
.newspaper-header{text-align:center;border-bottom:3px double var(--ink);padding-bottom:11px;margin-bottom:13px}
.newspaper-header .date{font-size:.68rem;color:var(--muted);font-family:var(--fu)}
.newspaper-header h1{font-family:var(--fd);font-size:2.1rem;font-weight:900;letter-spacing:.04em;margin:3px 0}
.newspaper-header .byline{font-size:.66rem;color:var(--muted);border-top:1px solid var(--border);padding-top:3px;margin-top:3px;font-family:var(--fu)}
.newspaper-grid{display:grid;grid-template-columns:repeat(6,1fr);gap:6px}

.slot{border:2px dashed var(--border);border-radius:4px;padding:7px;display:flex;flex-direction:column;justify-content:center;align-items:center;transition:all .25s;position:relative;min-height:65px;background:#fafaf5}
.slot.drag-over{border-color:var(--accent);background:#fff5f0}
.slot.filled{border:1px solid #ccc;justify-content:flex-start;align-items:stretch;border-radius:5px}
.slot-placeholder{text-align:center;color:#bbb}
.slot-placeholder .slot-icon{font-size:1.2rem;margin-bottom:1px}.slot-placeholder .slot-label{font-size:.68rem;font-weight:600;font-family:var(--fu)}.slot-placeholder .slot-hint{font-size:.6rem;margin-top:1px}
.slot .remove-btn{position:absolute;top:2px;left:2px;background:var(--accent);color:#fff;border:none;border-radius:50%;width:18px;height:18px;font-size:.55rem;cursor:pointer;display:flex;align-items:center;justify-content:center;opacity:0;transition:opacity .2s;z-index:5}.slot:hover .remove-btn{opacity:1}
.slot .news-cat{font-size:.6rem;font-weight:700;letter-spacing:.03em;font-family:var(--fu);position:absolute;top:3px;right:5px}
.slot .img-placeholder{background:rgba(255,255,255,.5);border-radius:3px;height:55px;display:flex;align-items:center;justify-content:center;margin:10px 0 2px;font-size:1.6rem}
.slot .news-headline{font-family:var(--fd);font-weight:800;line-height:1.2;margin:2px 0}
.slot .news-subtitle{font-size:.7rem;color:rgba(0,0,0,.6);line-height:1.35}
.slot .news-summary{font-size:.67rem;color:rgba(0,0,0,.5);line-height:1.45;margin-top:2px}
.font-xxl .news-headline{font-size:1.5rem}.font-xl .news-headline{font-size:1.2rem}.font-lg .news-headline{font-size:.95rem}.font-md .news-headline{font-size:.82rem}.font-sm .news-headline{font-size:.73rem}.font-xs .news-headline{font-size:.67rem}

.news-bg-0{background:#fdf2f0}.news-bg-1{background:#f0f6fd}.news-bg-2{background:#f5f0fd}.news-bg-3{background:#f0fdf4}.news-bg-4{background:#fdf9f0}
.news-bg-5{background:#f0fdfc}.news-bg-6{background:#fdf0f8}.news-bg-7{background:#f4fdf0}.news-bg-8{background:#f0f0fd}.news-bg-9{background:#fdfaf0}

/* Justify */
.justify-card{background:#fff;border-radius:var(--rl);padding:14px 18px;margin-bottom:9px;border:1px solid var(--bl)}
.slot-tag{display:inline-block;padding:2px 8px;border-radius:4px;font-size:.68rem;font-weight:700;color:#fff;font-family:var(--fu)}
.slot-tag.main{background:var(--accent)}.slot-tag.other{background:var(--slate)}
.justify-card h3{font-family:var(--fd);font-size:.93rem;margin:5px 0}
.justify-textarea{width:100%;padding:8px 11px;border:1px solid var(--border);border-radius:var(--r);font-size:.83rem;font-family:var(--fb);line-height:1.7;resize:vertical;outline:none;min-height:60px}.justify-textarea:focus{border-color:var(--accent)}
.rejected-box{background:#fffaf0;border-radius:var(--rl);padding:14px 20px;margin-bottom:16px;border:1px solid #f0e0c0}
.rejected-box h3{font-size:.95rem;color:#c07000;margin-bottom:5px}
.rejected-box>p{color:var(--muted);font-size:.8rem;margin-bottom:8px}
.rejected-item{background:#fff;border-radius:var(--r);padding:9px;margin-bottom:6px;border:1px solid #eee}
.rejected-item h4{font-size:.83rem;font-family:var(--fd);margin-bottom:4px}

/* Preview */
.preview-header{background:#fff;border-radius:var(--rl);padding:13px 20px;margin-bottom:16px;border:1px solid var(--bl);display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:10px}
.preview-header h2{font-family:var(--fd);font-size:1.1rem}
.final-newspaper{background:var(--pbr);border:2px solid var(--ink);border-radius:3px;padding:22px;box-shadow:0 8px 30px rgba(0,0,0,.15)}
.final-newspaper .newspaper-header h1{font-size:2.5rem}
.final-slot{padding:7px 5px;position:relative;border-radius:4px}
.final-slot .cat-label{font-size:.62rem;font-weight:700;letter-spacing:.03em;font-family:var(--fu)}
.final-slot .img-area{background:rgba(255,255,255,.5);border-radius:2px;height:70px;display:flex;align-items:center;justify-content:center;margin:4px 0;font-size:2rem}
.final-slot h3{font-family:var(--fd);font-weight:800;line-height:1.2;margin:3px 0}
.final-slot .sub{font-size:.76rem;color:rgba(0,0,0,.6);line-height:1.4;margin:1px 0}
.final-slot .summ{font-size:.73rem;color:rgba(0,0,0,.5);line-height:1.45;margin-top:3px}

.justification-summary{background:#fff;border-radius:var(--rl);padding:18px 22px;margin-top:18px;border:1px solid var(--bl)}
.justification-summary h3{font-family:var(--fd);font-size:1rem;margin-bottom:12px}
.just-item{border-bottom:1px solid #f0f0f0;padding-bottom:9px;margin-bottom:9px}.just-item:last-child{border:none;margin:0;padding:0}
.just-item .tag-line{display:flex;gap:5px;align-items:center;margin-bottom:2px;flex-wrap:wrap}
.mini-tag{padding:1px 6px;border-radius:4px;font-size:.64rem;font-weight:700;color:#fff;font-family:var(--fu)}
.just-item strong{font-size:.83rem}.just-item p{color:#555;font-size:.82rem;line-height:1.6;margin-top:1px}
.rejected-summary h4{font-size:.9rem;color:#c07000;margin:12px 0 5px}

.ratings-table{width:100%;border-collapse:collapse;font-size:.75rem;font-family:var(--fu)}
.ratings-table th{padding:6px 4px;background:#f5f3ef;border-bottom:2px solid var(--border);font-size:.7rem;white-space:nowrap}
.ratings-table td{padding:5px 4px;border-bottom:1px solid #f0f0f0;text-align:center}
.ratings-table td:first-child{text-align:right;font-weight:700;font-size:.78rem;max-width:160px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}

/* Teacher submissions view */
.sub-card{background:#fff;border:1px solid var(--bl);border-radius:var(--r);padding:14px;margin-bottom:10px}
.sub-card h4{font-family:var(--fd);font-size:1rem;margin-bottom:6px}
.sub-card .sub-meta{font-size:.78rem;color:var(--muted);margin-bottom:8px}
.sub-mini-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:4px;margin-bottom:8px}
.sub-mini-slot{background:#f5f3ef;border-radius:3px;padding:5px;font-size:.7rem;font-family:var(--fu)}
.sub-mini-slot.main-slot{background:#fdf2f0;border:1px solid var(--accent)}
.sub-mini-slot strong{display:block;font-family:var(--fd);font-size:.76rem}

/* Print */
@media print{.app-header,.info-box,.instructions-box,.btn,.btn-center,.preview-header,.justification-summary,.ratings-wrap{display:none!important}.final-newspaper{border:1px solid #000;box-shadow:none}body{background:#fff}}
@media(max-width:768px){.news-grid{grid-template-columns:1fr}.arrange-layout{flex-direction:column}.arrange-sidebar{flex:none;width:100%}.newspaper-grid{grid-template-columns:repeat(3,1fr)!important}.phase-indicators{display:none}.container,.container-wide{padding:12px 10px}.criteria-grid{grid-template-columns:1fr}.landing-cards{flex-direction:column;align-items:center}}
</style>
</head>
<body>
<div id="app"></div>
<script>
// ============ FIREBASE ============
const firebaseConfig={
  apiKey:"AIzaSyCh8TMjXeatpegwaJGOiT64VU0cXeWMwLA",
  authDomain:"newspaper-editor.firebaseapp.com",
  databaseURL:"https://newspaper-editor-default-rtdb.europe-west1.firebasedatabase.app",
  projectId:"newspaper-editor",
  storageBucket:"newspaper-editor.firebasestorage.app",
  messagingSenderId:"1056483646622",
  appId:"1:1056483646622:web:1afdb41dbcfacff9106f8f"
};
let db;
try{firebase.initializeApp(firebaseConfig);db=firebase.database()}catch(e){console.warn("Firebase init failed:",e)}

// ============ CONSTANTS ============
const CC={"×¤×•×œ×™×˜×™×§×”":"#c0392b","×›×œ×›×œ×”":"#27ae60","×—×‘×¨×”":"#8e44ad","×˜×›× ×•×œ×•×’×™×”":"#2980b9","×‘×™× ×œ××•××™":"#d35400","×‘×™×˜×—×•×Ÿ":"#c0392b","×¡×‘×™×‘×”":"#16a085","×—×™× ×•×š":"#f39c12","×‘×¨×™××•×ª":"#e74c3c","×ª×¨×‘×•×ª":"#9b59b6","×¡×¤×•×¨×˜":"#3498db","××“×¢":"#1abc9c"};
const CI={"×¤×•×œ×™×˜×™×§×”":"ğŸ›ï¸","×›×œ×›×œ×”":"ğŸ“Š","×—×‘×¨×”":"ğŸ‘¥","×˜×›× ×•×œ×•×’×™×”":"ğŸ’»","×‘×™× ×œ××•××™":"ğŸŒ","×‘×™×˜×—×•×Ÿ":"ğŸ›¡ï¸","×¡×‘×™×‘×”":"ğŸŒ¿","×—×™× ×•×š":"ğŸ“š","×‘×¨×™××•×ª":"ğŸ¥","×ª×¨×‘×•×ª":"ğŸ­","×¡×¤×•×¨×˜":"âš½","××“×¢":"ğŸ”¬"};
const TL={"breaking":"ğŸ”´ ××‘×–×§","today":"ğŸ“… ×”×™×•×","developing":"ğŸ”„ ××ª×¤×ª×—","feature":"ğŸ“ ×›×ª×‘×”"};
const IL={"high":"×’×‘×•×”×”","medium":"×‘×™× ×•× ×™×ª","low":"× ××•×›×”"};

const CRITERIA=[
  {key:"importance",name:"×—×©×™×‘×•×ª",icon:"âš¡",desc:"××™×¨×•×¢ ×©××ª×™×™×—×¡ ×œ×—×™×™ ×”××“× ×•×—×©×•×‘ ×œ××¦×‘×• ×”×§×™×•××™"},
  {key:"relevance",name:"×¨×œ×•×•× ×˜×™×•×ª",icon:"ğŸ¯",desc:"××™×¨×•×¢ ×©× ×•×’×¢ ×œ×§×”×œ ×”×™×¢×“ ×©×œ ×”×ª×§×©×•×¨×ª"},
  {key:"uniqueness",name:"×™×™×—×•×“×™×•×ª",icon:"ğŸ’",desc:"××™×¨×•×¢ ×—×¨×™×’, ×©×•× ×” ×•××¤×ª×™×¢"},
  {key:"celebrity",name:"××™×©×™×•×ª ××¤×•×¨×¡××ª",icon:"â­",desc:"××¢×•×¨×‘×™× ×‘×• ×× ×©×™ ×¦×™×‘×•×¨ ×•×¡×œ×‘×¨×™×˜××™×"},
  {key:"humanInterest",name:"×¢× ×™×™×Ÿ ×× ×•×©×™",icon:"â¤ï¸",desc:"×¡×™×¤×•×¨ ××¨×’×©, ×”×˜×¢×•×Ÿ ×‘×¨×’×©×•×ª ×¢×–×™× ××• ×’×•×‘×œ ×‘× ×¡"},
  {key:"timeliness",name:"×¢×“×›× ×™×•×ª",icon:"ğŸ•",desc:"××™×“×¢ ×—×“×© ×”×ª×•×¨× ×œ×”×‘× ×ª ×”××¦×™××•×ª"},
];

const LAYOUTS={
  classic:{name:"×§×œ××¡×™",desc:"×™×“×™×¢×” ×¨××©×™×ª ×¨×—×‘×”, ×”×™×¨×¨×›×™×” ×™×•×¨×“×ª",cols:"repeat(6,1fr)",rows:"auto auto auto auto",
    slots:[{id:"main",label:"×™×“×™×¢×” ×¨××©×™×ª",x:1,y:1,w:4,h:2,font:"xxl",isMain:true},{id:"s1",label:"××©× ×™×ª",x:5,y:1,w:2,h:2,font:"lg"},{id:"s2",label:"×©×œ×™×©×™×ª",x:1,y:3,w:2,h:1,font:"md"},{id:"s3",label:"×¨×‘×™×¢×™×ª",x:3,y:3,w:2,h:1,font:"md"},{id:"s4",label:"×—××™×©×™×ª",x:5,y:3,w:2,h:1,font:"sm"},{id:"s5",label:"×©×™×©×™×ª",x:1,y:4,w:6,h:1,font:"sm"}]},
  hierarchy:{name:"×”×™×¨×¨×›×™",desc:"×’×“×œ×™× ×™×•×¨×“×™× ××œ××¢×œ×” ×œ××˜×”",cols:"repeat(6,1fr)",rows:"auto auto auto auto",
    slots:[{id:"main",label:"×™×“×™×¢×” ×¨××©×™×ª",x:1,y:1,w:6,h:2,font:"xxl",isMain:true},{id:"s1",label:"×©× ×™×™×”",x:1,y:3,w:3,h:1,font:"lg"},{id:"s2",label:"×©×œ×™×©×™×ª",x:4,y:3,w:3,h:1,font:"lg"},{id:"s3",label:"×¨×‘×™×¢×™×ª",x:1,y:4,w:2,h:1,font:"md"},{id:"s4",label:"×—××™×©×™×ª",x:3,y:4,w:2,h:1,font:"sm"},{id:"s5",label:"×©×™×©×™×ª",x:5,y:4,w:2,h:1,font:"sm"}]},
  magazine:{name:"××’×–×™× ×™",desc:"×¨××©×™×ª ×‘××¨×›×–, ×§×˜× ×•×ª ×¡×‘×™×‘",cols:"repeat(6,1fr)",rows:"auto auto auto",
    slots:[{id:"s1",label:"×¢×œ×™×•× ×” ×©×××œ",x:1,y:1,w:2,h:1,font:"md"},{id:"main",label:"×™×“×™×¢×” ×¨××©×™×ª",x:3,y:1,w:2,h:2,font:"xl",isMain:true},{id:"s2",label:"×¢×œ×™×•× ×” ×™××™×Ÿ",x:5,y:1,w:2,h:1,font:"md"},{id:"s3",label:"×¦×“×“×™×ª",x:1,y:2,w:2,h:1,font:"sm"},{id:"s4",label:"×¦×“×“×™×ª",x:5,y:2,w:2,h:1,font:"sm"},{id:"s5",label:"×ª×—×ª×•× ×”",x:1,y:3,w:6,h:1,font:"lg"}]},
  tabloid:{name:"×˜××‘×œ×•××™×“",desc:"×›×•×ª×¨×ª ×¢× ×§×™×ª, ×“×’×© ×¢×œ ×“×¨××”",cols:"repeat(6,1fr)",rows:"auto auto auto auto",
    slots:[{id:"main",label:"×™×“×™×¢×” ×¨××©×™×ª",x:1,y:1,w:6,h:1,font:"xxl",isMain:true},{id:"s1",label:"×©× ×™×™×”",x:1,y:2,w:3,h:2,font:"xl"},{id:"s2",label:"×©×œ×™×©×™×ª",x:4,y:2,w:3,h:1,font:"lg"},{id:"s3",label:"×¨×‘×™×¢×™×ª",x:4,y:3,w:3,h:1,font:"md"},{id:"s4",label:"×—××™×©×™×ª",x:1,y:4,w:4,h:1,font:"sm"},{id:"s5",label:"×©×™×©×™×ª",x:5,y:4,w:2,h:1,font:"xs"}]}
};

// ============ NEWS DATABASE (40 items) ============
const ALL_NEWS=[
  {id:1,headline:"×¨××© ×”×××©×œ×” ×”×•×“×™×¢ ×¢×œ ×ª×•×›× ×™×ª ×›×œ×›×œ×™×ª ×—×“×©×” ×‘×”×™×§×£ 50 ××™×œ×™××¨×“ ×©×§×œ",subtitle:"×”×ª×•×›× ×™×ª ×›×•×œ×œ×ª ×”×©×§×¢×•×ª ×‘×ª×©×ª×™×•×ª, ×—×™× ×•×š ×•×˜×›× ×•×œ×•×’×™×” ×œ×—××© ×©× ×™×",summary:"×¨××© ×”×××©×œ×” ×”×¦×™×’ ×‘×›× ×¡×ª ×ª×•×›× ×™×ª ×›×œ×›×œ×™×ª ×œ×¦××¦×•× ×¤×¢×¨×™× ×•×—×™×–×•×§ ×”×¦××™×—×”, ×”×›×•×œ×œ×ª ×§×¨×Ÿ ×”×©×§×¢×•×ª ×•××¢× ×§×™× ×œ×¢×¡×§×™× ×§×˜× ×™× ×‘×¤×¨×™×¤×¨×™×”.",category:"×¤×•×œ×™×˜×™×§×”",hasImage:true,timeliness:"breaking",emotionalImpact:"medium"},
  {id:2,headline:"×¨×¢×™×“×ª ××“××” ×‘×¢×•×¦××” 6.2 ×”×•×¨×’×©×” ×‘××–×¨×— ×˜×•×¨×§×™×”",subtitle:"×“×™×•×•×—×™× ×¢×œ × ×–×§ ×œ×‘× ×™×™× ×™×, ×¦×•×•×ª×™ ×—×™×œ×•×¥ ×”×•×–× ×§×• ×œ××§×•×",summary:"×¨×¢×™×“×ª ××“××” 6.2 ×¨×™×›×˜×¨ ×”×‘×•×§×¨ ×‘××–×¨×— ×˜×•×¨×§×™×”. ××‘× ×™× ×§×¨×¡×•, ×—×©×© ×œ×œ×›×•×“×™×. ×™×©×¨××œ ×”×¦×™×¢×” ×¡×™×•×¢ ×”×•×× ×™×˜×¨×™.",category:"×‘×™× ×œ××•××™",hasImage:true,timeliness:"breaking",emotionalImpact:"high"},
  {id:3,headline:"××—×§×¨ ×™×©×¨××œ×™: ×ª×¨×•×¤×” × ×™×¡×™×•× ×™×ª ××‘×˜×™×—×” × ×’×“ ××œ×¦×”×™×™××¨",subtitle:"×—×•×§×¨×™× ××ª\"× ×“×™×•×•×—×• ×¢×œ ×©×™×¤×•×¨ ×©×œ 40% ×‘×ª×¤×§×•×“ ×”×§×•×’× ×™×˜×™×‘×™",summary:"×××¦××™× ×× ×™×¡×•×™ ×§×œ×™× ×™ ×©×œ×‘ 3 ××¨××™× ×”××˜×” ××©××¢×•×ª×™×ª ×‘×”×ª×§×“××•×ª ××œ×¦×”×™×™××¨. ×¤×¨×™×¦×ª ×“×¨×š ××¤×©×¨×™×ª ×‘×˜×™×¤×•×œ ×‘××—×œ×”.",category:"××“×¢",hasImage:true,timeliness:"today",emotionalImpact:"high"},
  {id:4,headline:"×¢×™×¨×™×™×ª ×—×™×¤×” ××™×©×¨×” ×ª×•×›× ×™×ª ×œ×¨×•×‘×¢ ×˜×›× ×•×œ×•×’×™ ×—×“×©",subtitle:"200 ×“×•× ×, ××¨×›×–×™ ×—×“×©× ×•×ª ×•××¢×•× ×•×ª ×¡×˜×•×“× ×˜×™×",summary:"××•×¢×¦×ª ×”×¢×™×¨ ××™×©×¨×” ×¤×” ××—×“ ×¨×•×‘×¢ ×˜×›× ×•×œ×•×’×™ ×‘××¤×¨×¥ ×—×™×¤×”. ×¦×¤×™ ×œ-15,000 ××§×•××•×ª ×¢×‘×•×“×”.",category:"×˜×›× ×•×œ×•×’×™×”",hasImage:true,timeliness:"today",emotionalImpact:"medium"},
  {id:5,headline:"××©×˜×¨×” ×¤×™×¨×§×” ×¨×©×ª ×”×‘×¨×—×ª ×¡××™× ×‘×™× ×œ××•××™×ª ×‘×“×¨×•×",subtitle:"××‘×¦×¢ ××©×•×ª×£ ×¢× ××™× ×˜×¨×¤×•×œ, ×¡××™× ×‘×©×•×•×™ ×¢×©×¨×•×ª ××™×œ×™×•× ×™×",summary:"23 ×—×©×•×“×™× × ×¢×¦×¨×• ×‘××‘×¦×¢ ×¡××•×™ ×©× ××©×š ×—×•×“×©×™×. × ×ª×¤×¡×• ×›××•×™×•×ª ×’×“×•×œ×•×ª ×©×œ ×§×•×§××™×Ÿ ×•×”×¨×•××™×Ÿ.",category:"×‘×™×˜×—×•×Ÿ",hasImage:true,timeliness:"today",emotionalImpact:"medium"},
  {id:6,headline:"× ×‘×—×¨×ª ×™×©×¨××œ ×‘×›×“×•×¨×¡×œ × ×™×¦×—×” ××ª ×¦×¨×¤×ª ×‘×“×¨××”",subtitle:"87-84 ×‘×”××¨×›×”, ×™×©×¨××œ ×‘×¨×‘×¢ ×’××¨ ××œ×™×¤×•×ª ××™×¨×•×¤×”",summary:"× ×™×¦×—×•×Ÿ ×“×¨××˜×™ 87-84 ×‘×”××¨×›×”. ×“× ×™ ××‘×“×™×” ×”×•×‘×™×œ ×¢× 28 × ×§×•×“×•×ª.",category:"×¡×¤×•×¨×˜",hasImage:true,timeliness:"today",emotionalImpact:"high"},
  {id:7,headline:'×“×•"×—: 30% ××‘× ×™ ×”× ×•×¢×¨ ×‘×™×©×¨××œ ×—×•×•×™× ×‘×“×™×“×•×ª',subtitle:"××©×¨×“ ×”×—×™× ×•×š ××›×¨×™×– ×¢×œ ×ª×•×›× ×™×ª ×—×™×¨×•× ×œ×—×•×¡×Ÿ ×—×‘×¨×ª×™",summary:"××›×•×Ÿ ×‘×¨×•×§×“×™×™×œ ×—×•×©×£ ×‘×“×™×“×•×ª × ×¨×—×‘×ª ×‘×§×¨×‘ × ×•×¢×¨. ××©×¨×“ ×”×—×™× ×•×š ××©×§×™×¢ 200 ××™×œ×™×•×Ÿ ×©×§×œ.",category:"×—×™× ×•×š",hasImage:false,timeliness:"today",emotionalImpact:"high"},
  {id:8,headline:"××× ×™×ª ×™×©×¨××œ×™×ª ×–×›×ª×” ×‘×¤×¨×¡ ×‘×‘×™×× ×œ×” ×©×œ ×•× ×¦×™×”",subtitle:"××™×¦×‘ ×•×™×“××• ×¢×œ ×–×”×•×ª ×•×©×™×™×›×•×ª ×–×›×” ×‘×©×‘×—×™ ×”×‘×™×§×•×¨×ª",summary:"××™×›×œ ×¨×•×˜×©×™×œ×“ ×–×›×ª×” ×‘×¤×¨×¡ ××¨×™×” ×”×–×”×‘ â€” ×”×¤×¢× ×”×¨××©×•× ×” ×©×××Ÿ ×™×©×¨××œ×™ ×–×•×›×” ×‘×¤×¨×¡ ×”××¨×›×–×™.",category:"×ª×¨×‘×•×ª",hasImage:true,timeliness:"today",emotionalImpact:"low"},
  {id:9,headline:"××—×™×¨×™ ×”×“×™×¨×•×ª: ×©×™× ×—×“×© ×‘×¨×‘×¢×•×Ÿ ×”××—×¨×•×Ÿ",subtitle:"×¢×œ×™×™×” ×©×œ 8.5% ×‘×××•×¦×¢ ××¨×¦×™, ×‘××¨×›×– ×—×“×” ×™×•×ª×¨",summary:"×“×™×¨×ª 4 ×—×“×¨×™× ×‘××¨×›×– ×¢×‘×¨×” ××ª ×¨×£ 3 ××™×œ×™×•×Ÿ ×©×§×œ ×œ×¨××©×•× ×”. ×¢×œ×™×™×” ×œ×œ× ×¡×™×× ×™ ×”××˜×”.",category:"×—×‘×¨×”",hasImage:false,timeliness:"developing",emotionalImpact:"high"},
  {id:10,headline:'×’×Ÿ ×”×—×™×•×ª ×”×ª× "×›×™ ×§×œ×˜ ×–×•×’ × ××¨×™× × ×“×™×¨×™× ××¡×™×Ÿ',subtitle:"× ××¨ ×××•×¨ ×‘×¡×›× ×ª ×”×›×—×“×”, ×¤×—×•×ª ×-100 ×‘×˜×‘×¢",summary:"×–×•×’ × ××¨×™ ×××•×¨ ×”×’×™×¢ ××‘×™×™×’'×™× ×’ ×‘××¡×’×¨×ª ×ª×•×›× ×™×ª ×©×™××•×¨ ×‘×™× ×œ××•××™×ª.",category:"×¡×‘×™×‘×”",hasImage:true,timeliness:"feature",emotionalImpact:"medium"},
  {id:11,headline:"×©×‘×™×ª×” ×›×œ×œ×™×ª ×‘××¢×¨×›×ª ×”×‘×¨×™××•×ª: ×‘×ª×™ ×”×—×•×œ×™× ×¢×•×‘×¨×™× ×œ××ª×›×•× ×ª ×—×™×¨×•×",subtitle:"×”×”×¡×ª×“×¨×•×ª ×”×¨×¤×•××™×ª ×“×•×¨×©×ª ×ª×•×¡×¤×ª ×©×œ 5,000 ×ª×§× ×™ ×¨×•×¤××™×",summary:"×”×¨×•×¤××™× ×™×¦××• ×œ×©×‘×™×ª×” ×›×œ×œ×™×ª ×œ××—×¨ ×©×”××©× ×•××ª×Ÿ ×¢× ××©×¨×“ ×”×‘×¨×™××•×ª ×§×¨×¡. ×‘×ª×™ ×—×•×œ×™× ×‘×¨×—×‘×™ ×”××¨×¥ ×¢×•×‘×¨×™× ×œ××ª×›×•× ×ª ×—×™×¨×•×.",category:"×‘×¨×™××•×ª",hasImage:true,timeliness:"breaking",emotionalImpact:"high"},
  {id:12,headline:"×—×‘×¨×ª ×¡×˜××¨×˜××¤ ×™×©×¨××œ×™×ª ××’×™×™×¡×ª ××™×œ×™××¨×“ ×“×•×œ×¨ ×‘×”× ×¤×§×” ×‘×•×•×œ ×¡×˜×¨×™×˜",subtitle:"×”×—×‘×¨×” ×¤×™×ª×—×” ×˜×›× ×•×œ×•×’×™×” ×œ×™×™×¦×•×¨ ×× ×¨×’×™×” ×¡×•×œ××¨×™×ª ×‘×¢×œ×•×ª × ××•×›×”",summary:"×—×‘×¨×ª ×¡×•×œ××¨×™×¡ ×”×™×©×¨××œ×™×ª ×”×•× ×¤×§×” ×‘× ××¡×“\"×§ ×œ×¤×™ ×©×•×•×™ ×©×œ 8 ××™×œ×™××¨×“ ×“×•×œ×¨. ××“×•×‘×¨ ×‘×”× ×¤×§×” ×”×’×“×•×œ×” ×‘×™×•×ª×¨ ×©×œ ×—×‘×¨×” ×™×©×¨××œ×™×ª ×”×©× ×”.",category:"×›×œ×›×œ×”",hasImage:true,timeliness:"today",emotionalImpact:"medium"},
  {id:13,headline:"×™×œ×“ ×‘×Ÿ 8 ×”×¦×™×œ ××ª ×¡×‘×ª×• ××˜×‘×™×¢×” ×‘×—×•×£ ×”×¨×¦×œ×™×”",subtitle:"×”×™×œ×“ ×©×—×” 50 ××˜×¨ ×‘×™× ×¡×•×¢×¨ ×•××©×š ××ª ×¡×‘×ª×• ×œ×—×•×£ ×‘×©×œ×•×",summary:"×ª×•××¨ ×›×”×Ÿ, ×‘×Ÿ 8 ××”×¨×¦×œ×™×”, ×”×‘×—×™×Ÿ ×©×¡×‘×ª×• × ×¡×—×¤×ª ×‘×™× ×•×”×©×œ×™×š ×œ×” ×’×œ×’×œ ×”×¦×œ×”. ××¦×™×œ ×‘×—×•×£ ×©×™×‘×— ××ª ××•××¥ ×”×œ×‘ ×©×œ×•.",category:"×—×‘×¨×”",hasImage:true,timeliness:"today",emotionalImpact:"high"},
  {id:14,headline:"×‘×™× ×” ××œ××›×•×ª×™×ª ×™×©×¨××œ×™×ª ×××‘×—× ×ª ×¡×¨×˜×Ÿ ×‘×“×™×•×§ ×©×œ 97%",subtitle:"×”××¢×¨×›×ª ×× ×ª×—×ª ×¦×™×œ×•××™ ×¨× ×˜×’×Ÿ ×•××–×”×” ×’×™×“×•×œ×™× ×‘×©×œ×‘ ××•×§×“×",summary:"×—×•×§×¨×™× ××”×˜×›× ×™×•×Ÿ ×¤×™×ª×—×• ××¢×¨×›×ª AI ×©××–×”×” ×¡×¨×˜×Ÿ ×¨×™××” ×‘×©×œ×‘ ××•×§×“× ×××•×“. ×”××¢×¨×›×ª ×›×‘×¨ × ×‘×“×§×ª ×‘-3 ×‘×ª×™ ×—×•×œ×™×.",category:"×˜×›× ×•×œ×•×’×™×”",hasImage:false,timeliness:"today",emotionalImpact:"high"},
  {id:15,headline:"×©×¨ ×”×—×™× ×•×š ×”×•×“×™×¢: ×©×‘×•×¢ ×œ×™××•×“×™× ×©×œ 4 ×™××™× ×‘× ×™×¡×•×™ ××¨×¦×™",subtitle:"40 ×‘×ª×™ ×¡×¤×¨ ×™×©×ª×ª×¤×• ×‘× ×™×¡×•×™ ×©×™×™××©×š ×©× ×ª×™×™× ×”×—×œ ××¡×¤×˜××‘×¨",summary:"××©×¨×“ ×”×—×™× ×•×š ××›×¨×™×– ×¢×œ × ×™×¡×•×™ ××”×¤×›× ×™ ×©×œ ×©×‘×•×¢ ×œ×™××•×“×™× ××§×•×¦×¨. ×”×™×•× ×”×—××™×©×™ ×™×•×§×“×© ×œ×œ××™×“×” ×¢×¦×××™×ª ×•×¤×¨×•×™×§×˜×™×.",category:"×—×™× ×•×š",hasImage:true,timeliness:"today",emotionalImpact:"medium"},
  {id:16,headline:"×’×œ ×—×•× ×§×™×¦×•× ×™: ×˜××¤×¨×˜×•×¨×•×ª ×©×™× ×©×œ 48 ××¢×œ×•×ª ×‘×¢×¨×‘×”",subtitle:"××©×¨×“ ×”×‘×¨×™××•×ª ××–×”×™×¨ ××¤× ×™ ×™×¦×™××” ××”×‘×™×ª, 12 ×× ×©×™× ×¤×•× ×• ×œ×‘×ª×™ ×—×•×œ×™×",summary:"×’×œ ×—×•× ×—×¨×™×’ ×¤×•×§×“ ××ª ×™×©×¨××œ. ×‘×¢×¨×‘×” × ××“×“×• 48 ××¢×œ×•×ª â€” ×©×™× ×›×œ ×”×–×× ×™×. ×¦×¤×™ ×œ×¢×•×“ ×™×•××™×™× ×©×œ ×—×•× ×§×™×¦×•× ×™.",category:"×¡×‘×™×‘×”",hasImage:true,timeliness:"breaking",emotionalImpact:"high"},
  {id:17,headline:"×”×–××¨ ×”×™×©×¨××œ×™ ×¢×“×Ÿ ×‘×Ÿ ×–×§×Ÿ ××•× ×” ×œ×©×’×¨×™×¨ ×™×•× ×™×¦×£",subtitle:"×™×”×™×” ×©×’×¨×™×¨ ×˜×•×‘ ×¨×¦×•×Ÿ ×©×œ ×”××¨×’×•×Ÿ ×œ×§×™×“×•× ×–×›×•×™×•×ª ×™×œ×“×™×",summary:"×¢×“×Ÿ ×‘×Ÿ ×–×§×Ÿ ××•× ×” ×œ×©×’×¨×™×¨ ×˜×•×‘ ×¨×¦×•×Ÿ ×©×œ ×™×•× ×™×¦×£ ×•×™×¤×¢×œ ×œ×§×“× ××•×“×¢×•×ª ×œ×–×›×•×™×•×ª ×™×œ×“×™× ×‘××–×¨×— ×”×ª×™×›×•×Ÿ.",category:"×ª×¨×‘×•×ª",hasImage:true,timeliness:"today",emotionalImpact:"low"},
  {id:18,headline:"×¤×™×’×•×¢ ×¡×™×™×‘×¨ ×¢×œ ××¢×¨×›×ª ×”×—×©××œ: ×”×©×‘×ª×” ×©×œ ×©×¢×ª×™×™× ×‘×¦×¤×•×Ÿ",subtitle:"×’×•×¨××™× ×¢×•×™× ×™× × ×™×¡×• ×œ×©×‘×© ××ª ×¤×¢×™×œ×•×ª ×—×‘×¨×ª ×”×—×©××œ",summary:"××ª×§×¤×ª ×¡×™×™×‘×¨ ×¢×œ ×ª×©×ª×™×•×ª ×—×‘×¨×ª ×”×—×©××œ ×’×¨××” ×œ×”×¤×¡×§×•×ª ×—×©××œ ×‘×¦×¤×•×Ÿ. ××¢×¨×š ×”×¡×™×™×‘×¨ ×”×œ××•××™ ××˜×¤×œ ×‘××™×¨×•×¢.",category:"×‘×™×˜×—×•×Ÿ",hasImage:false,timeliness:"breaking",emotionalImpact:"high"},
  {id:19,headline:"×’×™×“×•×œ ×©×œ 300% ×‘××™××•×¥ ×›×œ×‘×™× ××¨×—×•×‘ ×‘×¢×§×‘×•×ª ×§××¤×™×™×Ÿ ×•×™×¨××œ×™",subtitle:"×¢××•×ª×•×ª ×‘×¢×œ×™ ×—×™×™× ××“×•×•×—×•×ª ×¢×œ ×¢×•××¡ ×—×™×•×‘×™ ×‘×‘×§×©×•×ª ××™××•×¥",summary:"×¡×¨×˜×•×Ÿ ×•×™×¨××œ×™ ×©×œ ×›×œ×‘ ×¨×—×•×‘ ×©××•××¥ ×–×›×” ×œ-10 ××™×œ×™×•×Ÿ ×¦×¤×™×•×ª ×•×’×¨× ×œ×’×œ ××™××•×¦×™× ×‘×¨×—×‘×™ ×”××¨×¥.",category:"×—×‘×¨×”",hasImage:true,timeliness:"developing",emotionalImpact:"medium"},
  {id:20,headline:"×™×©×¨××œ ×ª××¨×— ××ª ××œ×™×¤×•×ª ×”×¢×•×œ× ×‘××ª××˜×™×§×” ×œ× ×•×¢×¨",subtitle:"500 ×ª×œ××™×“×™× ×-80 ××“×™× ×•×ª ×™×ª×—×¨×• ×‘××•×œ×™××¤×™××“×” ×‘×™×¨×•×©×œ×™×",summary:"×™×©×¨××œ × ×‘×—×¨×” ×œ××¨×— ××ª ×”××•×œ×™××¤×™××“×” ×”×‘×™× ×œ××•××™×ª ×‘××ª××˜×™×§×”. ×”×ª×—×¨×•×ª ×ª×ª×§×™×™× ×‘×™×¨×•×©×œ×™× ×•×ª×™××©×š ×©×‘×•×¢.",category:"×—×™× ×•×š",hasImage:true,timeliness:"feature",emotionalImpact:"low"},
  {id:21,headline:"×§×¨×™×¡×ª ×’×©×¨ ××¢×œ × ×—×œ ×©×•×¨×§: 3 ×¤×¦×•×¢×™× ×§×œ",subtitle:"×”×’×©×¨ ×©× ×‘× ×” ×œ×¤× ×™ 40 ×©× ×” ×§×¨×¡ ×‘×¢×ª ××¢×‘×¨ ××©××™×ª ×›×‘×“×”",summary:"×’×©×¨ ×™×©×Ÿ ×¢×œ ×›×‘×™×© 38 ×§×¨×¡ ×›×©××©××™×ª ×›×‘×“×” ×¢×‘×¨×” ×¢×œ×™×•. 3 ×× ×©×™× × ×¤×¦×¢×• ×§×œ. × ×¤×ª×—×” ×—×§×™×¨×”.",category:"×—×‘×¨×”",hasImage:true,timeliness:"breaking",emotionalImpact:"high"},
  {id:22,headline:"× ×©×™× ××¨×”\"×‘ ×”×›×¨×™×– ×¢×œ ×”×¡×›× ×¡×—×¨ ×—×“×© ×¢× ×™×©×¨××œ",subtitle:"×”×”×¡×›× ×¦×¤×•×™ ×œ×”×’×“×™×œ ××ª ×”×¡×—×¨ ×”×“×•-×¦×“×“×™ ×‘-30% ×ª×•×š 5 ×©× ×™×",summary:"×”× ×©×™× ×”×××¨×™×§××™ ×•×¨×”\"× ×—×ª××• ×¢×œ ×”×¡×›× ×¡×—×¨ ××§×™×£ ×©×›×•×œ×œ ×‘×™×˜×•×œ ××›×¡×™× ×¢×œ ×˜×›× ×•×œ×•×’×™×”, ×—×§×œ××•×ª ×•×©×™×¨×•×ª×™×.",category:"×¤×•×œ×™×˜×™×§×”",hasImage:true,timeliness:"today",emotionalImpact:"medium"},
  {id:23,headline:"×¨×•×‘×•×˜ ×™×©×¨××œ×™ ×‘×™×¦×¢ × ×™×ª×•×— ××•×— ×¨××©×•×Ÿ ×‘×¢×•×œ× ×œ×œ× ×× ×ª×—",subtitle:"×”× ×™×ª×•×— ×‘×•×¦×¢ ×‘××•×˜×•× ×•××™×” ××œ××” ×ª×—×ª ×¤×™×§×•×— ×¦×•×•×ª ×¨×¤×•××™",summary:"×‘×‘×™×ª ×”×—×•×œ×™× ×©×™×‘× ×‘×•×¦×¢ × ×™×ª×•×— ××•×— ××•×˜×•× ×•××™ ×œ×¨××©×•× ×”. ×”×¨×•×‘×•×˜ ×‘×™×¦×¢ ××ª ×”× ×™×ª×•×— ×‘×“×™×•×§ ×©×œ ××™×œ×™××˜×¨.",category:"××“×¢",hasImage:true,timeliness:"today",emotionalImpact:"high"},
  {id:24,headline:"×—×©×“ ×œ×”×•× ××”: ×—×‘×¨×ª × ×“×œ\"×Ÿ ×’×“×•×œ×” × ×—×§×¨×ª ×¢×œ ××›×™×¨×•×ª ×›×¤×•×œ×•×ª",subtitle:"×¢×©×¨×•×ª ×¨×•×›×©×™ ×“×™×¨×•×ª ×’×™×œ×• ×©×”×“×™×¨×” ×©×œ×”× × ××›×¨×” ×’× ×œ××™×©×”×• ××—×¨",summary:"××©×˜×¨×ª ×™×©×¨××œ ×¤×ª×—×” ×‘×—×§×™×¨×” × ×’×“ ×—×‘×¨×ª ×‘× ×™×™×” ××•×‘×™×œ×” ×‘×—×©×“ ×©××›×¨×” ×“×™×¨×•×ª ×œ×©× ×™ ×§×•× ×™×. ×¢×©×¨×•×ª ××©×¤×—×•×ª × ×¤×’×¢×•.",category:"×›×œ×›×œ×”",hasImage:false,timeliness:"today",emotionalImpact:"high"},
  {id:25,headline:"×©×™×˜×¤×•× ×•×ª ×‘××¤×¨×™×§×”: ×™×©×¨××œ ×©×•×œ×—×ª ××©×œ×—×ª ×—×™×œ×•×¥ ×•×”×¦×œ×”",subtitle:"××©×œ×—×ª ×¦×”\"×œ×™×ª ×•××–×¨×—×™×ª ×¢× ×¦×™×•×“ ×¨×¤×•××™ ×™×¦××” ×œ××•×–××‘×™×§",summary:"×‘×¢×§×‘×•×ª ×©×™×˜×¤×•× ×•×ª ×§×˜×œ× ×™×™× ×‘××•×–××‘×™×§, ×™×©×¨××œ ×©×•×œ×—×ª ××©×œ×—×ª ×©×œ 120 ××™×© ×¢× ×¦×™×•×“ ×¨×¤×•××™ ×•××–×•×Ÿ.",category:"×‘×™× ×œ××•××™",hasImage:true,timeliness:"today",emotionalImpact:"high"},
  {id:26,headline:"××—×§×¨: ×©×™××•×© ×‘××¡×›×™× ××¢×œ 4 ×©×¢×•×ª ×¤×•×’×¢ ×‘×–×™×›×¨×•×Ÿ ×©×œ ××ª×‘×’×¨×™×",subtitle:"×—×•×§×¨×™× ××”××•× ×™×‘×¨×¡×™×˜×” ×”×¢×‘×¨×™×ª ×¢×§×‘×• ××—×¨×™ 3,000 × ×•×¢×¨ ×‘××©×š ×©× ×ª×™×™×",summary:"××—×§×¨ ××¨×•×š ×˜×•×•×— ××¨××” ×™×¨×™×“×” ×©×œ 15% ×‘×™×›×•×œ×ª ×”×–×™×›×¨×•×Ÿ ×©×œ ××ª×‘×’×¨×™× ×©××©×ª××©×™× ×‘××¡×›×™× ××¢×œ 4 ×©×¢×•×ª ×‘×™×•×.",category:"××“×¢",hasImage:false,timeliness:"today",emotionalImpact:"medium"},
  {id:27,headline:"×©×—×§× ×™×ª ×™×©×¨××œ×™×ª ×–×›×ª×” ×‘×¤×¨×¡ ×‘×¤×¡×˜×™×‘×œ ×§××Ÿ",subtitle:"×’×œ ×’×“×•×ª ×§×™×‘×œ×” ××ª ×¤×¨×¡ ×”×©×—×§× ×™×ª ×”×˜×•×‘×” ×¢×œ ×ª×¤×§×™×“×” ×‘×¡×¨×˜ ×“×¨××”",summary:"×’×œ ×’×“×•×ª ×–×›×ª×” ×‘×¤×¨×¡ ×”×©×—×§× ×™×ª ×”×˜×•×‘×” ×‘×¤×¡×˜×™×‘×œ ×§××Ÿ ×¢×œ ×ª×¤×§×™×“×” ×‘×¡×¨×˜ ×™×©×¨××œ×™ ×”×¢×•×¡×§ ×‘××©×¤×—×” ×‘×–××Ÿ ××œ×—××”.",category:"×ª×¨×‘×•×ª",hasImage:true,timeliness:"today",emotionalImpact:"medium"},
  {id:28,headline:"×¨×›×‘×ª ×”×§×œ×” ×‘×ª×œ ××‘×™×‘: ×§×• ×—×“×© ×™×§×¦×¨ × ×¡×™×¢×•×ª ×‘-40 ×“×§×•×ª",subtitle:"×”×§×• ×”×—×“×© ×™×—×‘×¨ ××ª ×‘×ª ×™× ×œ×¨××ª ×’×Ÿ ×“×¨×š ××¨×›×– ×ª\"×",summary:"× ×—× ×š ×§×• ×”×¨×›×‘×ª ×”×§×œ×” ×”×©× ×™ ×‘×’×•×© ×“×Ÿ. ×”×§×• ×™×§×¦×¨ ××©××¢×•×ª×™×ª ××ª ×–×× ×™ ×”× ×¡×™×¢×” ×•×™×¤×—×™×ª ×¤×§×§×™×.",category:"×˜×›× ×•×œ×•×’×™×”",hasImage:true,timeliness:"today",emotionalImpact:"medium"},
  {id:29,headline:"××›×‘×™ ×ª\"× ×”×•×“×™×¢×” ×¢×œ ×—×ª×™××ª ×©×—×§×Ÿ NBA ×œ×¢×•× ×” ×”×‘××”",subtitle:"×”×©×—×§×Ÿ ×”×××¨×™×§××™, ×œ×©×¢×‘×¨ ×›×•×›×‘ ×‘×œ×™×’×”, ×¦×¤×•×™ ×œ×”×’×™×¢ ×‘×§×™×¥",summary:"××›×‘×™ ×ª×œ ××‘×™×‘ ×—×ª××” ×¢×œ ×©×—×§×Ÿ NBA ×œ×©×¢×‘×¨ ×‘×¢×¡×§×” ×©×œ 3 ××™×œ×™×•×Ÿ ×“×•×œ×¨. ××”×œ×š ×©×¦×¤×•×™ ×œ×—×–×§ ××©××¢×•×ª×™×ª ××ª ×”×§×‘×•×¦×”.",category:"×¡×¤×•×¨×˜",hasImage:true,timeliness:"today",emotionalImpact:"medium"},
  {id:30,headline:"×ª×œ××™×“×ª ×ª×™×›×•×Ÿ ××¨×”×˜ ×¤×™×ª×—×” ××¤×œ×™×§×¦×™×” ×©××¦×™×œ×” ×—×™×™×",subtitle:"×”××¤×œ×™×§×¦×™×” ××–×”×” ×¡×™×× ×™ ×©×‘×¥ ×•××ª×¨×™×¢×” ×œ××©×¤×—×” ×•×œ××“\"×",summary:"× ×•×¨ ××‘×• ×¡×‘×™×ª, ×‘×ª 17 ××¨×”×˜, ×¤×™×ª×—×” ××¤×œ×™×§×¦×™×” ×©××–×”×” ×¡×™×× ×™ ×©×‘×¥ ××•×§×“××™×. ×”××¤×œ×™×§×¦×™×” ×›×‘×¨ ×”×•×¨×“×” 50,000 ×¤×¢××™×.",category:"×˜×›× ×•×œ×•×’×™×”",hasImage:true,timeliness:"feature",emotionalImpact:"high"},
  {id:31,headline:"×¤×¨×™×¦×” ×œ×‘×¡×™×¡ × ×ª×•× ×™× ×××©×œ×ª×™: ×“×œ×™×¤×ª ××™×“×¢ ×©×œ 2 ××™×œ×™×•×Ÿ ××–×¨×—×™×",subtitle:"×”×¤×•×¨×¦×™× ×“×•×¨×©×™× ×›×•×¤×¨, ×”×¨×©×•×ª ×œ×”×’× ×ª ×”×¤×¨×˜×™×•×ª ×¤×ª×—×” ×‘×—×§×™×¨×”",summary:"×”××§×¨×™× ×¤×¨×¦×• ×œ×‘×¡×™×¡ × ×ª×•× ×™× ×××©×œ×ª×™ ×•×’× ×‘×• ××™×“×¢ ××™×©×™ ×©×œ ××™×œ×™×•× ×™ ××–×¨×—×™×, ×›×•×œ×œ ×ª×¢×•×“×•×ª ×–×”×•×ª ×•×›×ª×•×‘×•×ª.",category:"×‘×™×˜×—×•×Ÿ",hasImage:false,timeliness:"breaking",emotionalImpact:"high"},
  {id:32,headline:"×’××œ × ×“×™×¨ × ×•×œ×“ ×‘×¡×¤××¨×™ ×‘×¨××ª ×’×Ÿ â€” ×”×¨××©×•×Ÿ ××¡×•×’×• ×‘-20 ×©× ×”",subtitle:"××“×•×‘×¨ ×‘×’××œ ×“×•-×“×‘×©×ª×™ ×©× ×•×œ×“ ×‘×©×‘×™, ××™×Ÿ ×”× ××¦× ×‘×¡×›× ×ª ×”×›×—×“×”",summary:"×‘×¡×¤××¨×™ ×‘×¨××ª ×’×Ÿ × ×•×œ×“ ×’××œ ×“×•-×“×‘×©×ª×™ â€” ×”×¨××©×•×Ÿ ×©× ×•×œ×“ ×‘×™×©×¨××œ ××–×” 20 ×©× ×”. ×”×’××œ ×•×”×× ×‘××¦×‘ ×˜×•×‘.",category:"×¡×‘×™×‘×”",hasImage:true,timeliness:"today",emotionalImpact:"medium"},
  {id:33,headline:"×•×¢×“×ª ×”×›× ×¡×ª ××™×©×¨×” ×—×•×§ ×—×“×©: ××™×¡×•×¨ ×©×™××•×© ×‘×¡×××¨×˜×¤×•×Ÿ ×¢×“ ×’×™×œ 14",subtitle:"×”×—×•×§ ×™×™×›× ×¡ ×œ×ª×•×§×£ ×‘×ª×—×™×œ×ª ×©× ×ª ×”×œ×™××•×“×™× ×”×‘××”",summary:"×”×›× ×¡×ª ××™×©×¨×” ×—×•×§ ×”××•×¡×¨ ××›×™×¨×ª ×¡×××¨×˜×¤×•× ×™× ×œ×™×œ×“×™× ××ª×—×ª ×œ×’×™×œ 14. ×”×—×•×§ ×¢×•×¨×¨ ×•×™×›×•×— ×¦×™×‘×•×¨×™ × ×¨×—×‘.",category:"×¤×•×œ×™×˜×™×§×”",hasImage:false,timeliness:"today",emotionalImpact:"high"},
  {id:34,headline:"×¢×•×‘×“×ª ××¤×¢×œ ×’×™×œ×ª×” ××˜×‘×¢ ×¢×ª×™×§ ×‘×©×•×•×™ ××™×œ×™×•×Ÿ ×“×•×œ×¨",subtitle:"×”××˜×‘×¢ ××ª×§×•×¤×ª ×‘×¨ ×›×•×›×‘× × ××¦× ×‘××ª×¨ ×‘× ×™×™×” ×‘×™×¨×•×©×œ×™×",summary:"×¢×•×‘×“×ª ×‘××ª×¨ ×‘× ×™×™×” ××¦××” ××˜×‘×¢ ×–×”×‘ ×‘×Ÿ 2,000 ×©× ×” ××ª×§×•×¤×ª ×‘×¨ ×›×•×›×‘×. ×”××˜×‘×¢ ×”×•×¢×‘×¨ ×œ×¨×©×•×ª ×”×¢×ª×™×§×•×ª.",category:"×ª×¨×‘×•×ª",hasImage:true,timeliness:"today",emotionalImpact:"medium"},
  {id:35,headline:"× ×”×’ ××•×˜×•×‘×•×¡ ×¢×¦×¨ ××ª ×”×¨×›×‘ ×•×”×¦×™×œ × ×•×¡×¢×ª ×©××™×‘×“×” ×”×›×¨×”",subtitle:"×”× ×”×’ ×‘×™×¦×¢ ×”×—×™×™××” ×¢×“ ×œ×”×’×¢×ª ×¦×•×•×ª ××“\"×",summary:"× ×”×’ ××’×“ ××‘××¨ ×©×‘×¢ ×¢×¦×¨ ××ª ×”××•×˜×•×‘×•×¡ ×›×©× ×•×¡×¢×ª ××™×‘×“×” ×”×›×¨×” ×•×‘×™×¦×¢ ×”×—×™×™××” ×©×”×¦×™×œ×” ××ª ×—×™×™×”. ××“\"× ×”×¢× ×™×§ ×œ×• ×ª×¢×•×“×ª ×”×•×§×¨×”.",category:"×—×‘×¨×”",hasImage:true,timeliness:"today",emotionalImpact:"high"},
  {id:36,headline:"×¡×¢×¨×” ×“×™×¤×œ×•××˜×™×ª: ×©×’×¨×™×¨ ×™×©×¨××œ ×‘×¦×¨×¤×ª ×–×•××Ÿ ×œ×©×™×—×ª ×”×‘×”×¨×”",subtitle:"×”×¨×§×¢: ×”×¦×‘×¢×” ×™×©×¨××œ×™×ª ×‘××•\"× ×©×¢×•×¨×¨×” ××ª×— ×¢× ×¤×¨×™×–",summary:"×¦×¨×¤×ª ×–×™×× ×” ××ª ×”×©×’×¨×™×¨ ×”×™×©×¨××œ×™ ×œ×©×™×—×ª ×”×‘×”×¨×” ×‘×¢×§×‘×•×ª ×”×¦×‘×¢×” ×‘××•\"×. ××©×¨×“ ×”×—×•×¥ ×”×’×™×‘ ×‘×”×¦×”×¨×” ××ª×•× ×”.",category:"×‘×™× ×œ××•××™",hasImage:false,timeliness:"today",emotionalImpact:"medium"},
  {id:37,headline:"×‘× ×§ ×™×©×¨××œ ××›×¨×™×– ×¢×œ ××˜×‘×¢ ×“×™×’×™×˜×œ×™: ×”×©×§×œ ×”×“×™×’×™×˜×œ×™ ×™×•×©×§ ×‘×§×¨×•×‘",subtitle:"×”××˜×‘×¢ ×”×“×™×’×™×˜×œ×™ ×™××¤×©×¨ ×ª×©×œ×•××™× ××™×™×“×™×™× ×œ×œ× ×¢××œ×•×ª",summary:"× ×’×™×“ ×‘× ×§ ×™×©×¨××œ ×”×›×¨×™×– ×©×”×©×§×œ ×”×“×™×’×™×˜×œ×™ ×™×™×›× ×¡ ×œ×©×™××•×© ×ª×•×š ×©× ×”. ×”××”×œ×š ×¦×¤×•×™ ×œ×©× ×•×ª ××ª ×¢×•×œ× ×”×ª×©×œ×•××™×.",category:"×›×œ×›×œ×”",hasImage:true,timeliness:"today",emotionalImpact:"medium"},
  {id:38,headline:"×§×‘×•×¦×ª ××˜×™×™×œ×™× ×™×©×¨××œ×™× ×—×•×œ×¦×” ××”×¨ ×”×’×¢×© ×‘×”×¨ ××ª× ×”",subtitle:"12 ×™×©×¨××œ×™× × ×ª×§×¢×• ×›×©×”×ª×¤×¨×¦×•×ª ×¤×ª××•××™×ª ×—×¡××” ××ª ×©×‘×™×œ ×”×™×¨×™×“×”",summary:"12 ××˜×™×™×œ×™× ×™×©×¨××œ×™× ×—×•×œ×¦×• ×‘×©×œ×•× ××”×¨ ××ª× ×” ×‘××™×˜×œ×™×” ×œ××—×¨ ×©×”×ª×¤×¨×¦×•×ª ×¤×ª××•××™×ª ×—×¡××” ××ª ×“×¨×›×. ××™×© ×œ× × ×¤×’×¢.",category:"×‘×™× ×œ××•××™",hasImage:true,timeliness:"breaking",emotionalImpact:"high"},
  {id:39,headline:"×‘×™×ª ×—×•×œ×™× ×©×œ× ×¢×•×‘×¨ ×œ×× ×¨×’×™×” ×™×¨×•×§×” â€” ×”×¨××©×•×Ÿ ×‘×™×©×¨××œ",subtitle:"×‘×™×ª ×”×—×•×œ×™× ××¡×•×ª× ×‘××©×“×•×“ ××•×¤×¢×œ ×›×¢×ª ×‘-100% ×× ×¨×’×™×” ×¡×•×œ××¨×™×ª",summary:"××¡×•×ª× ××©×“×•×“ ×”×¤×š ×œ×‘×™×ª ×”×—×•×œ×™× ×”×¨××©×•×Ÿ ×‘×™×©×¨××œ ×©××•×¤×¢×œ ×œ×—×œ×•×˜×™×Ÿ ×‘×× ×¨×’×™×” ×¡×•×œ××¨×™×ª. ×”××”×œ×š ×—×•×¡×š 40% ××¢×œ×•×™×•×ª ×”×—×©××œ.",category:"×¡×‘×™×‘×”",hasImage:true,timeliness:"feature",emotionalImpact:"low"},
  {id:40,headline:"×¡×§×¨: 60% ××”×™×©×¨××œ×™× ×œ× ××¨×•×¦×™× ×××¢×¨×›×ª ×”×—×™× ×•×š",subtitle:"×”×¡×§×¨ ×”×©× ×ª×™ ××¦×‘×™×¢ ×¢×œ ×™×¨×™×“×” ×‘×××•×Ÿ ×”×¦×™×‘×•×¨ ×‘×‘×ª×™ ×”×¡×¤×¨",summary:"×¡×§×¨ ××›×•×Ÿ ×”×“××•×§×¨×˜×™×” ×—×•×©×£ ×©-60% ××”×™×©×¨××œ×™× ××¢×¨×™×›×™× ××ª ××¢×¨×›×ª ×”×—×™× ×•×š ×›×‘×™× ×•× ×™×ª ××• ×’×¨×•×¢×”. 78% ×ª×•××›×™× ×‘×¨×¤×•×¨××”.",category:"×—×™× ×•×š",hasImage:false,timeliness:"developing",emotionalImpact:"medium"},
];

function pickRandom10(){
  const shuffled=[...ALL_NEWS].sort(()=>Math.random()-.5);
  return shuffled.slice(0,10).map((n,i)=>({...n,id:i+1}));
}
// ============ STATE ============
const S={
  mode:"landing",studentName:"",teacherName:"",sessionId:"",
  allNews:[],ratings:{},expandedCard:null,selectedIds:new Set(),
  layout:"classic",slotAssignments:{},justifications:{},
  newspaperName:"×”×™×“×™×¢×•×ª",submissions:[],
};

// ============ HELPERS ============
const esc=s=>{const d=document.createElement('div');d.textContent=s;return d.innerHTML};
const hDate=()=>new Date().toLocaleDateString("he-IL",{weekday:"long",year:"numeric",month:"long",day:"numeric"});
const getN=id=>S.allNews.find(n=>n.id===id);
const selNews=()=>S.allNews.filter(n=>S.selectedIds.has(n.id));
const rejNews=()=>S.allNews.filter(n=>!S.selectedIds.has(n.id));
const assIds=()=>new Set(Object.values(S.slotAssignments));
const unassNews=()=>selNews().filter(n=>!assIds().has(n.id));
const getSlots=()=>LAYOUTS[S.layout].slots;
const allFilled=()=>getSlots().every(s=>S.slotAssignments[s.id]);
function avgR(nid){const r=S.ratings[nid];if(!r)return 0;const v=CRITERIA.map(c=>r[c.key]||0).filter(x=>x>0);return v.length?(v.reduce((a,b)=>a+b,0)/v.length):0}
function ratedCnt(){return S.allNews.filter(n=>{const r=S.ratings[n.id];return r&&CRITERIA.every(c=>r[c.key]>0)}).length}
function newsColorIdx(nid){return S.allNews.findIndex(n=>n.id===nid)%10}

// URL encode/decode
function getBaseUrl(){return window.location.href.split('#')[0]}
function checkUrl(){const h=window.location.hash.substring(1);if(h&&h.length>3)return h;return null}

// Firebase
function saveToFirebase(data){
  if(!db||!S.sessionId)return Promise.resolve();
  const key=S.studentName.replace(/[.#$/[\]]/g,'_');
  return db.ref(`sessions/${S.sessionId}/submissions/${key}`).set(data).catch(e=>console.warn("Firebase save error:",e));
}
function loadSubmissions(){
  if(!db||!S.sessionId)return Promise.resolve([]);
  return db.ref(`sessions/${S.sessionId}/submissions`).once('value').then(snap=>{
    const val=snap.val();return val?Object.values(val):[];
  }).catch(e=>{console.warn("Firebase load error:",e);return[]});
}
function saveConfig(){if(!db||!S.sessionId)return Promise.resolve();return db.ref(`sessions/${S.sessionId}/config`).set({news:S.allNews,teacher:S.teacherName}).catch(e=>console.warn(e))}
function loadConfig(sid){if(!db)return Promise.resolve(null);return db.ref(`sessions/${sid}/config`).once('value').then(s=>s.val()).catch(()=>null)}

// ============ RENDER ============
function render(){
  document.getElementById("app").innerHTML=
    S.mode==="landing"?renderLanding():
    S.mode==="teacher"?renderTeacher():
    S.mode==="teacher-view"?renderTeacherView():
    S.mode==="student-name"?renderStudentName():
    renderApp();
  attachEvents();
}

function renderLanding(){
  const urlData=checkUrl();
  return`<div class="landing">
    <div class="landing-logo">ğŸ“°</div>
    <h1>×¢×•×¨×š ×”×¢×™×ª×•×Ÿ</h1>
    <div class="tagline">×¡×™××•×œ×¦×™×” ×œ×¢×¨×™×›×ª ×“×£ ×¨××©×•×Ÿ ×©×œ ×¢×™×ª×•×Ÿ</div>
    <div class="credit">×¤×™×ª×•×—: ×¨× ×™ ×‘×Ÿ ×–××‘</div>
    <div class="landing-cards">
      <div class="landing-card" style="max-width:480px">
        <div class="ci">ğŸ‘¨â€ğŸ«</div><h2>××–×•×¨ ××•×¨×”</h2>
        <p>×¦×•×¨ ×¡×˜ ×™×“×™×¢×•×ª ×—×“×©×•×ª×™×•×ª ×•×§×‘×œ ×§×™×©×•×¨ ×œ×©×™×ª×•×£ ×¢× ×”×ª×œ××™×“×™×. ×ª×•×›×œ ×œ×¦×¤×•×ª ×‘×”×’×©×•×ª ×©×œ×”×.</p>
        <ol>
          <li>×”×–×Ÿ ××ª ×©××š</li>
          <li>×œ×—×¥ "×¦×•×¨ ×¡×˜ ×™×“×™×¢×•×ª" â€” 10 ×™×“×™×¢×•×ª ××§×¨××™×•×ª ×™×™×‘×—×¨×• ××”×××’×¨</li>
          <li>×‘×“×•×§ ×©×”×™×“×™×¢×•×ª ××ª××™××•×ª (××¤×©×¨ ×œ×™×™×¦×¨ ××—×“×©)</li>
          <li>×”×¢×ª×§ ××ª ×”×§×™×©×•×¨ ×•×©×œ×— ×œ×ª×œ××™×“×™× (×•×•××˜×¡××¤, ×§×œ××¡×¨×•×, ××™×™×œ)</li>
          <li>×¦×¤×” ×‘×”×’×©×•×ª ×“×¨×š ×§×™×©×•×¨ ×”××•×¨×”</li>
        </ol>
        <button class="lbtn teacher" data-action="goto-teacher">×™×¦×™×¨×ª ×¡×˜ ×™×“×™×¢×•×ª ×œ×›×™×ª×” â†’</button>
        <p style="text-align:center;font-size:.78rem;color:#aaa;margin-top:10px">ğŸ’¡ ×”×ª×œ××™×“×™× ×™×§×‘×œ×• ×§×™×©×•×¨ ×™×©×™×¨ ×œ×ª×¨×’×™×œ â€” ×”× ×œ× ×¦×¨×™×›×™× ×œ×”×™×›× ×¡ ×œ×“×£ ×”×–×”</p>
      </div>
    </div>
    <div class="landing-footer">×¡×™××•×œ×¦×™×” ×œ×¢×¨×™×›×” ×—×“×©×•×ª×™×ª â€¢ ×¢×¨×š ×—×“×©×•×ª×™, ××¡×’×•×¨ ×•×¡×“×¨ ×™×•× ×ª×§×©×•×¨×ª×™</div>
  </div>`;
}

function renderTeacher(){
  const hasNews=S.allNews.length>0;
  const preview=hasNews?`<div class="np-list">${S.allNews.map((n,i)=>`<div class="np-item"><div class="np-num">${i+1}</div><div class="np-info"><span class="np-cat" style="color:${CC[n.category]||'#666'}">${n.category} </span><strong>${esc(n.headline)}</strong></div></div>`).join("")}</div>`:"";
  
  const studentLink=S.sessionId?getBaseUrl()+"#"+S.sessionId:"";
  const teacherLink=S.sessionId?getBaseUrl()+"#t_"+S.sessionId:"";
  
  const linkHtml=S.sessionId?`<div class="link-result">
    <h3>âœ… ×”×§×™×©×•×¨×™× ××•×›× ×™×!</h3>
    <p style="font-size:.8rem;color:#555;text-align:center;margin-bottom:6px"><strong>×§×™×©×•×¨ ×œ×ª×œ××™×“×™×</strong> â€” ×©×œ×—/×™ ×‘×•×•××˜×¡××¤, ×’×•×’×œ ×§×œ××¡×¨×•×, ××™×™×œ...</p>
    <textarea class="link-url" id="studentLink" readonly>${studentLink}</textarea>
    <div class="link-actions"><button class="copy-btn" data-action="copy-student-link">ğŸ“‹ ×”×¢×ª×§ ×§×™×©×•×¨ ×œ×ª×œ××™×“×™×</button></div>
    <p style="font-size:.8rem;color:#555;text-align:center;margin:10px 0 4px"><strong>×§×™×©×•×¨ ×œ××•×¨×”</strong> â€” ×œ×¦×¤×™×™×” ×‘×”×’×©×•×ª (×©××•×¨ ×œ×¢×¦××š!)</p>
    <textarea class="link-url" id="teacherLink" readonly>${teacherLink}</textarea>
    <div class="link-actions"><button class="copy-btn" data-action="copy-teacher-link">ğŸ“‹ ×”×¢×ª×§ ×§×™×©×•×¨ ××•×¨×”</button><button class="new-btn" data-action="regenerate">ğŸ”„ ×¦×•×¨ ×¡×˜ ×—×“×©</button></div>
  </div>`:"";

  return`<div class="container" style="max-width:650px;margin-top:25px">
    <button class="btn btn-muted" data-action="goto-landing" style="margin-bottom:14px;font-size:.8rem">â†’ ×—×–×¨×”</button>
    <div class="info-box"><h2>ğŸ‘¨â€ğŸ« ×™×¦×™×¨×ª ×¡×˜ ×™×“×™×¢×•×ª ×œ×›×™×ª×”</h2><p>×”×–×Ÿ ××ª ×©××š, ×¦×•×¨ ×¡×˜ ×™×“×™×¢×•×ª ×•×©×œ×— ××ª ×”×§×™×©×•×¨ ×œ×ª×œ××™×“×™×. ×›×œ ×”×ª×œ××™×“×™× ×™×§×‘×œ×• ××ª ××•×ª×Ÿ ×™×“×™×¢×•×ª.</p></div>
    <div class="instructions-box">
      <h3>ğŸ“‹ ××™×š ×–×” ×¢×•×‘×“?</h3>
      <ol>
        <li>×”×–×Ÿ ××ª ×©××š (×™×•×¤×™×¢ ×›×©× ×”××•×¨×” ×‘×ª×¨×’×™×œ)</li>
        <li>×œ×—×¥ "×¦×•×¨ ×¡×˜ ×™×“×™×¢×•×ª" â€” ×”××¢×¨×›×ª ×ª×‘×—×¨ 10 ×™×“×™×¢×•×ª ××§×¨××™×•×ª ××”×××’×¨</li>
        <li>×‘×“×•×§ ××ª ×”×™×“×™×¢×•×ª â€” ×× ×œ× ××ª××™××•×ª, ×œ×—×¥ "×¦×•×¨ ×¡×˜ ×—×“×©"</li>
        <li>×”×¢×ª×§ ××ª <strong>×§×™×©×•×¨ ×”×ª×œ××™×“×™×</strong> ×•×©×œ×— ×‘×•×•××˜×¡××¤/××™×™×œ/×§×œ××¡×¨×•×</li>
        <li>×©××•×¨ ×œ×¢×¦××š ××ª <strong>×§×™×©×•×¨ ×”××•×¨×”</strong> ×œ×¦×¤×™×™×” ×‘×”×’×©×•×ª</li>
      </ol>
    </div>
    <div style="background:#fff;border-radius:var(--rl);padding:18px 22px;border:1px solid var(--bl)">
      <label style="font-size:.83rem;font-weight:700;font-family:var(--fu);display:block;margin-bottom:4px">×©× ×”××•×¨×”</label>
      <input type="text" class="modal-input" id="teacherNameInput" placeholder="×œ××©×œ: ×™×•×¡×™ ×›×”×Ÿ" value="${esc(S.teacherName)}" style="text-align:center;font-family:var(--fd);font-weight:700;margin-bottom:10px">
      <button class="modal-btn primary" data-action="generate-news" id="genBtn">ğŸ² ×¦×•×¨ ×¡×˜ ×™×“×™×¢×•×ª (10 ××§×¨××™×•×ª ××ª×•×š 40)</button>
    </div>
    ${preview}${linkHtml}
  </div>`;
}

function renderTeacherView(){
  if(!S.submissions.length) return`<div class="container" style="max-width:900px;margin-top:25px">
    <button class="btn btn-muted" data-action="goto-landing" style="margin-bottom:14px;font-size:.8rem">â†’ ×—×–×¨×”</button>
    <div class="info-box"><h2>ğŸ“Š ×”×’×©×•×ª ×ª×œ××™×“×™× â€” ${esc(S.teacherName)}</h2><p>0 ×”×’×©×•×ª â€¢ <button class="btn btn-dark" data-action="refresh-subs" style="padding:5px 12px;font-size:.78rem">ğŸ”„ ×¨×¢× ×Ÿ</button></p></div>
    <div style="text-align:center;padding:40px;color:var(--muted)"><div style="font-size:2.5rem;margin-bottom:8px">ğŸ“­</div><h3>×¢×“×™×™×Ÿ ××™×Ÿ ×”×’×©×•×ª</h3><p style="font-size:.88rem">×›×©×ª×œ××™×“×™× ×™×©×œ×—×• ××ª ×”×¢×‘×•×“×”, ×”×”×’×©×•×ª ×™×•×¤×™×¢×• ×›××Ÿ. ×œ×—×¥ "×¨×¢× ×Ÿ" ×œ×‘×“×•×§.</p></div></div>`;

  // Build summary comparison
  const newsPopularity=S.allNews.map(n=>{
    const selCount=S.submissions.filter(s=>(s.selectedIds||[]).includes(n.id)).length;
    const mainCount=S.submissions.filter(s=>{const sa=s.slotAssignments||{};return Object.entries(sa).some(([k,v])=>{const slot=LAYOUTS[s.layout]?.slots?.find(sl=>sl.id===k);return slot?.isMain&&v===n.id})}).length;
    return{news:n,selCount,mainCount,pct:Math.round(selCount/S.submissions.length*100)};
  }).sort((a,b)=>b.selCount-a.selCount);

  const comparisonHtml=`<div class="info-box" style="margin-bottom:16px">
    <h3 style="font-family:var(--fd);margin-bottom:10px">ğŸ“Š ×”×©×•×•××” ×›×™×ª×ª×™×ª â€” ×¤×•×¤×•×œ×¨×™×•×ª ×”×™×“×™×¢×•×ª</h3>
    ${newsPopularity.map(p=>{const col=CC[p.news.category]||"#666";return`<div style="margin-bottom:8px">
      <div style="display:flex;justify-content:space-between;font-size:.82rem;margin-bottom:2px"><span><span style="color:${col};font-weight:700">${p.news.category}</span> ${esc(p.news.headline.substring(0,50))}${p.news.headline.length>50?'...':''}</span><span style="color:#888">${p.mainCount>0?`<span style="color:var(--accent);font-weight:700">${p.mainCount}Ã— ×¨××©×™×ª</span> â€¢ `:''}${p.selCount}/${S.submissions.length} (${p.pct}%)</span></div>
      <div style="height:5px;background:#f0f0f0;border-radius:3px;overflow:hidden"><div style="height:100%;width:${p.pct}%;background:${p.mainCount>0?'var(--accent)':'#3498db'};border-radius:3px;transition:width .4s"></div></div>
    </div>`}).join("")}
  </div>`;

  // Build full cards per student
  const subCards=S.submissions.map(sub=>{
    const L=LAYOUTS[sub.layout]||LAYOUTS.classic;

    // Mini newspaper grid
    const miniGrid=L.slots.map(slot=>{
      const nid=(sub.slotAssignments||{})[slot.id];const news=nid?S.allNews.find(n=>n.id===nid):null;
      if(!news)return'';const col=CC[news.category]||"#666";const ci=S.allNews.indexOf(news)%10;const isM=slot.isMain;
      const st=`grid-column:${slot.x}/span ${slot.w};grid-row:${slot.y}/span ${slot.h};`;
      return`<div class="final-slot font-${slot.font} news-bg-${ci}" style="${st};padding:5px 4px">
        <span style="font-size:.58rem;font-weight:700;color:${col};font-family:var(--fu)">${news.category}</span>
        <h3 class="news-headline" style="font-size:${isM?'1rem':slot.w>=3?'.82rem':'.7rem'}">${esc(news.headline)}</h3>
        ${isM?`<p style="font-size:.68rem;color:#666;line-height:1.3;margin-top:2px">${esc(news.subtitle)}</p>`:''}
      </div>`;
    }).join("");

    // Justifications
    const justHtml=L.slots.map(slot=>{
      const nid=(sub.slotAssignments||{})[slot.id];const news=nid?S.allNews.find(n=>n.id===nid):null;
      const text=(sub.justifications||{})[slot.id];
      if(!news||!text)return'';const col=CC[news.category]||"#666";
      return`<div style="margin-bottom:6px;padding:6px 10px;background:#f9f9f5;border-radius:5px;border-right:3px solid ${slot.isMain?'var(--accent)':'var(--slate)'}">
        <div style="font-size:.76rem;display:flex;gap:5px;align-items:center;margin-bottom:2px"><span class="slot-tag ${slot.isMain?'main':'other'}" style="font-size:.62rem;padding:1px 6px">${slot.label}</span><strong style="font-family:var(--fd);font-size:.8rem">${esc(news.headline)}</strong></div>
        <p style="font-size:.78rem;color:#555;line-height:1.55">${esc(text)}</p>
      </div>`;
    }).join("");

    // Rejected justifications
    const rejHtml=(sub.selectedIds||[]).length?S.allNews.filter(n=>!(sub.selectedIds||[]).includes(n.id)).map(n=>{
      const text=(sub.justifications||{})[`reject-${n.id}`];if(!text)return'';
      return`<div style="margin-bottom:4px;padding:5px 8px;background:#fffaf0;border-radius:4px;font-size:.76rem"><strong style="font-family:var(--fd)">${esc(n.headline)}</strong><p style="color:#888;margin-top:1px;line-height:1.45">${esc(text)}</p></div>`;
    }).join(""):'';

    // Ratings table
    const ratingsHtml=sub.ratings?`<details style="margin-top:8px"><summary style="font-size:.8rem;font-weight:700;font-family:var(--fu);cursor:pointer;color:var(--slate)">ğŸ“Š ×˜×‘×œ×ª ×“×™×¨×•×’×™×</summary>
      <table class="ratings-table" style="margin-top:6px"><thead><tr><th style="text-align:right">×™×“×™×¢×”</th>${CRITERIA.map(c=>`<th title="${c.desc}">${c.icon}</th>`).join('')}<th>×××•×¦×¢</th></tr></thead><tbody>
      ${S.allNews.map(n=>{const r=sub.ratings?.[n.id]||{};const vals=CRITERIA.map(c=>r[c.key]||0).filter(v=>v>0);const avg=vals.length?(vals.reduce((a,b)=>a+b,0)/vals.length):0;const inP=(sub.selectedIds||[]).includes(n.id);
        return`<tr style="background:${inP?'#f8fff8':'#fff'}"><td style="text-align:right;font-size:.72rem;max-width:140px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap">${inP?'âœ…':''} ${esc(n.headline.substring(0,30))}</td>${CRITERIA.map(c=>`<td style="color:#b8860b;font-size:.75rem">${r[c.key]||'-'}</td>`).join('')}<td style="font-weight:700;color:#b8860b;font-size:.75rem">${avg.toFixed(1)}</td></tr>`}).join('')}
      </tbody></table></details>`:'';

    return`<div class="sub-card" style="padding:18px;margin-bottom:18px">
      <div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:10px;flex-wrap:wrap;gap:6px">
        <h4 style="font-family:var(--fd);font-size:1.1rem">ğŸ‘¤ ${esc(sub.studentName)}</h4>
        <div class="sub-meta" style="font-size:.76rem;color:var(--muted)">×”×•×’×©: ${sub.timestamp?new Date(sub.timestamp).toLocaleString("he-IL"):""} â€¢ ×ª×‘× ×™×ª: ${L.name} â€¢ ×¢×™×ª×•×Ÿ: ${esc(sub.newspaperName||'')}</div>
      </div>
      <div style="background:var(--pbr);border:1.5px solid var(--ink);border-radius:3px;padding:14px;margin-bottom:12px">
        <div style="text-align:center;border-bottom:2px double var(--ink);padding-bottom:8px;margin-bottom:10px">
          <div style="font-size:.62rem;color:var(--muted);font-family:var(--fu)">${hDate()}</div>
          <h2 style="font-family:var(--fd);font-size:1.5rem;font-weight:900;margin:2px 0">${esc(sub.newspaperName||'×”×™×“×™×¢×•×ª')}</h2>
          <div style="font-size:.6rem;color:var(--muted);font-family:var(--fu)">×¢×•×¨×š/×ª: ${esc(sub.studentName)}</div>
        </div>
        <div class="newspaper-grid" style="grid-template-columns:${L.cols};grid-template-rows:${L.rows}">${miniGrid}</div>
      </div>
      <div style="margin-bottom:8px"><h4 style="font-size:.88rem;font-family:var(--fu);margin-bottom:6px">ğŸ“ × ×™××•×§×™× â€” ×™×“×™×¢×•×ª ×©× ×‘×—×¨×•</h4>${justHtml||'<p style="color:#aaa;font-size:.8rem">×œ× × ×›×ª×‘×• × ×™××•×§×™×</p>'}</div>
      ${rejHtml?`<div style="margin-bottom:8px"><h4 style="font-size:.85rem;font-family:var(--fu);color:#c07000;margin-bottom:6px">ğŸ¤” ×™×“×™×¢×•×ª ×©×œ× × ×‘×—×¨×•</h4>${rejHtml}</div>`:''}
      ${ratingsHtml}
    </div>`;
  }).join("");

  return`<div class="container" style="max-width:900px;margin-top:25px">
    <button class="btn btn-muted" data-action="goto-landing" style="margin-bottom:14px;font-size:.8rem">â†’ ×—×–×¨×”</button>
    <div class="info-box"><h2>ğŸ“Š ×”×’×©×•×ª ×ª×œ××™×“×™× â€” ${esc(S.teacherName)}</h2><p>${S.submissions.length} ×”×’×©×•×ª ×”×ª×§×‘×œ×• â€¢ <button class="btn btn-dark" data-action="refresh-subs" style="padding:5px 12px;font-size:.78rem">ğŸ”„ ×¨×¢× ×Ÿ</button></p></div>
    ${comparisonHtml}
    ${subCards}
  </div>`;
}

function renderStudentName(){
  return`<div class="modal-overlay"><div class="modal-card" style="text-align:center">
    <div style="font-size:3rem;margin-bottom:6px">ğŸ“°</div>
    <h2>×¢×•×¨×š ×”×¢×™×ª×•×Ÿ</h2>
    <div class="modal-sub">×¡×™××•×œ×¦×™×” ×œ×¢×¨×™×›×ª ×“×£ ×¨××©×•×Ÿ ×©×œ ×¢×™×ª×•×Ÿ<br><span style="font-size:.76rem;color:#b0a898">×¤×™×ª×•×—: ×¨× ×™ ×‘×Ÿ ×–××‘${S.teacherName?` â€¢ ××•×¨×”: ${esc(S.teacherName)}`:''}</span></div>
    <div class="instructions-box" style="text-align:right;margin-bottom:14px">
      <h3>ğŸ“‹ ××” ×¢×•×©×™× ×‘×ª×¨×’×™×œ?</h3>
      <ol>
        <li><strong>×“×™×¨×•×’:</strong> ×ª×§×‘×œ/×™ 10 ×™×“×™×¢×•×ª. ×“×¨×’/×™ ×›×œ ××—×ª ×œ×¤×™ 6 ×§×¨×™×˜×¨×™×•× ×™× ×©×œ ×¢×¨×š ×—×“×©×•×ª×™</li>
        <li><strong>×‘×—×™×¨×”:</strong> ×‘×—×¨/×™ 6 ×™×“×™×¢×•×ª ×œ×“×£ ×”×¨××©×•×Ÿ</li>
        <li><strong>×¢×™×¦×•×‘:</strong> ×¡×“×¨/×™ ××•×ª×Ÿ â€” ××™ ×¨××©×™×ª, ××™ ××©× ×™×ª, ××™×¤×” ×›×œ ××—×ª</li>
        <li><strong>× ×™××•×§×™×:</strong> ×”×¡×‘×¨/×™ ×œ××” ×‘×—×¨×ª ×›×œ ×™×“×™×¢×” ×•×œ××” ×©××ª ××•×ª×” ×©×</li>
        <li><strong>×©×œ×™×—×”:</strong> ×©×œ×—/×™ ××ª ×”×¢×‘×•×“×” ×œ××•×¨×” ×•×”×“×¤×¡/×™</li>
      </ol>
    </div>
    <label style="text-align:right;font-size:.83rem;font-weight:700;font-family:var(--fu);margin-bottom:3px;display:block">×”×©× ×©×œ×š</label>
    <input type="text" class="modal-input" id="nameInput" placeholder="×”×›× ×¡/×™ ×©× ××œ×..." style="text-align:center;font-family:var(--fd);font-weight:700" autofocus>
    <button class="modal-btn primary" id="startBtn" disabled data-action="start-exercise">×”×ª×—×œ/×™ ××ª ×”×ª×¨×’×™×œ â†</button>
  </div></div>`;
}

function renderApp(){return renderHeader()+renderPhase()}

function renderHeader(){
  const phases=[{id:"rate",l:"â‘  ×“×™×¨×•×’"},{id:"select",l:"â‘¡ ×‘×—×™×¨×”"},{id:"arrange",l:"â‘¢ ×¢×¨×™×›×”"},{id:"justify",l:"â‘£ × ×™××•×§×™×"},{id:"preview",l:"â‘¤ ×ª×¦×•×’×”"}];
  const order=["rate","select","arrange","justify","preview"];
  const ci=order.indexOf(S.mode);
  const pills=phases.map(p=>{const i=order.indexOf(p.id);let c="phase-pill";if(p.id===S.mode)c+=" active";else if(i<ci)c+=" done";return`<div class="${c}">${p.l}</div>`}).join("");
  return`<div class="app-header"><div class="header-brand"><span class="logo">ğŸ“°</span><div><h1>×¢×•×¨×š ×”×¢×™×ª×•×Ÿ</h1><div class="meta">${esc(S.studentName)}${S.teacherName?' â€¢ ××•×¨×”: '+esc(S.teacherName):''}</div></div></div><div class="phase-indicators">${pills}</div></div>`;
}

function renderPhase(){
  switch(S.mode){
    case"rate":return renderRate();case"select":return renderSelect();
    case"arrange":return renderArrange();case"justify":return renderJustify();
    case"preview":return renderPreview();default:return"";
  }
}

function renderRate(){
  const done=ratedCnt();
  const cards=S.allNews.map(n=>{
    const col=CC[n.category]||"#666";const exp=S.expandedCard===n.id;const avg=avgR(n.id);const r=S.ratings[n.id]||{};const full=CRITERIA.every(c=>r[c.key]>0);
    const crits=CRITERIA.map(c=>{const v=r[c.key]||0;const stars=[1,2,3,4,5].map(s=>`<button class="star-btn ${s<=v?'filled':''}" data-action="set-star" data-news="${n.id}" data-crit="${c.key}" data-val="${s}">â˜…</button>`).join("");return`<div class="criterion-row"><span class="criterion-icon">${c.icon}</span><div class="criterion-info"><div class="criterion-name">${c.name}</div><div class="criterion-desc">${c.desc}</div></div><div class="star-rating">${stars}</div></div>`}).join("");
    return`<div class="rate-card ${exp?'expanded':''}"><div class="rate-card-header" data-action="toggle-expand" data-id="${n.id}"><div class="rs"><div class="tag-row"><span class="tag" style="background:${col}18;color:${col}">${n.category}</span><span class="tag-time">${TL[n.timeliness]||""}</span>${full?'<span class="tag-time" style="color:#27ae60">âœ“</span>':''}</div><h3>${esc(n.headline)}</h3><p class="subtitle">${esc(n.subtitle)}</p><div class="meta-badges">${n.hasImage?'<span class="meta-tag">ğŸ“· ×ª××•× ×”</span>':''}<span class="meta-tag">×”×©×¤×¢×”: ${IL[n.emotionalImpact]||""}</span></div></div><div class="ls">${avg>0?`<span class="score-mini">â­${avg.toFixed(1)}</span>`:'<span class="score-mini empty">â€”</span>'}<span class="toggle-icon">â–¼</span></div></div><div class="rate-card-body"><div class="summary-text">${esc(n.summary)}</div><div style="margin-bottom:7px;font-size:.78rem;font-weight:700;font-family:var(--fu);color:var(--slate)">×“×¨×’/×™ ×¢×¨×š ×—×“×©×•×ª×™ (1-5):</div><div class="criteria-grid">${crits}</div>${avg>0?`<div class="avg-score">×××•×¦×¢: â­ ${avg.toFixed(1)} / 5</div>`:''}</div></div>`;
  }).join("");
  return`<div class="container"><div class="info-box"><h2>×©×œ×‘ 1: ×“×™×¨×•×’ ×¢×¨×š ×—×“×©×•×ª×™</h2><p>×”×ª×§×©×•×¨×ª ××¡× × ×ª ××™×¨×•×¢×™× ×œ×¤×™ <strong>×¢×¨×š ×—×“×©×•×ª×™</strong> â€” ×›××” "×©×•×•×”" ×œ×“×•×•×— ×¢×œ×™×”×. ×œ×—×¥/×™ ×¢×œ ×›×œ ×™×“×™×¢×” ×•×“×¨×’/×™ ×œ×¤×™ 6 ×§×¨×™×˜×¨×™×•× ×™×.</p><div class="counter-badge ${done===10?'ok':'inc'}">×“×•×¨×’×• ${done} ××ª×•×š 10</div></div>${cards}${done===10?'<div class="btn-center"><button class="btn btn-accent" data-action="goto-select">×”××©×š ×œ×‘×—×™×¨×” â†</button></div>':'<div class="btn-center"><p style="color:var(--muted);font-size:.82rem">×“×¨×’/×™ ××ª ×›×œ 10 ×”×™×“×™×¢×•×ª ×›×“×™ ×œ×”××©×™×š</p></div>'}</div>`;
}

function renderSelect(){
  const cnt=S.selectedIds.size;
  const sorted=[...S.allNews].sort((a,b)=>avgR(b.id)-avgR(a.id));
  const cards=sorted.map(n=>{const sel=S.selectedIds.has(n.id);const dis=cnt>=6&&!sel;const col=CC[n.category]||"#666";const avg=avgR(n.id);
    return`<div class="news-card ${sel?'selected':''} ${dis?'disabled':''}" data-action="toggle-select" data-id="${n.id}">${sel?'<div class="check-badge">âœ“</div>':''}<div class="tag-row"><span class="tag" style="background:${col}18;color:${col}">${n.category}</span><span class="tag-time">${TL[n.timeliness]||""}</span></div><h3>${esc(n.headline)}</h3><p class="subtitle">${esc(n.subtitle)}</p><div class="card-footer">${n.hasImage?'<span class="meta-tag">ğŸ“·</span>':''}<span class="meta-tag">×”×©×¤×¢×”: ${IL[n.emotionalImpact]||""}</span><span class="score-mini">â­${avg.toFixed(1)}</span></div></div>`;
  }).join("");
  return`<div class="container"><div class="info-box"><h2>×©×œ×‘ 2: ×‘×—×™×¨×ª 6 ×™×“×™×¢×•×ª</h2><p>×‘×—×¨/×™ 6 ×™×“×™×¢×•×ª ×œ×“×£ ×”×¨××©×•×Ÿ. ×”×“×™×¨×•×’ ×”×•× ×›×œ×™ ×¢×–×¨ â€” ×”×”×—×œ×˜×” ×©×œ×š!</p><div class="counter-badge ${cnt===6?'ok':'inc'}">× ×‘×—×¨×• ${cnt} ××ª×•×š 6</div></div><div class="news-grid">${cards}</div>${cnt===6?'<div class="btn-center"><button class="btn btn-accent" data-action="goto-arrange">×”××©×š ×œ×¢×™×¦×•×‘ â†</button></div>':''}<div class="btn-center"><button class="btn btn-muted" data-action="goto-rate">â†’ ×—×–×¨×” ×œ×“×™×¨×•×’</button></div></div>`;
}

function renderArrange(){
  const L=LAYOUTS[S.layout];
  const lBtns=Object.entries(LAYOUTS).map(([k,l])=>`<button class="layout-btn ${S.layout===k?'active':''}" data-action="set-layout" data-layout="${k}"><strong>${l.name}</strong><div class="desc">${l.desc}</div></button>`).join("");
  const dItems=selNews().map(n=>{const p=assIds().has(n.id);const col=CC[n.category]||"#666";return`<div class="drag-item ${p?'placed':''}" draggable="${p?'false':'true'}" data-news-id="${n.id}" style="border-right-color:${col}"><div class="cat" style="color:${col}">${n.category}</div><h4>${esc(n.headline)}</h4><div class="drag-score">â­${avgR(n.id).toFixed(1)}</div></div>`}).join("");
  const gridSlots=L.slots.map(slot=>{const nid=S.slotAssignments[slot.id];const news=nid?getN(nid):null;const isM=slot.isMain;const col=news?(CC[news.category]||"#666"):"";const ci=news?newsColorIdx(news.id):0;const st=`grid-column:${slot.x}/span ${slot.w};grid-row:${slot.y}/span ${slot.h};`;
    if(news)return`<div class="slot filled font-${slot.font} news-bg-${ci}" style="${st}" data-slot-id="${slot.id}" data-action="drop-zone"><button class="remove-btn" data-action="remove-slot" data-slot="${slot.id}">âœ•</button><span class="news-cat" style="color:${col}">${news.category}</span>${news.hasImage&&(isM||slot.h>=2)?`<div class="img-placeholder">${CI[news.category]||'ğŸ“°'}</div>`:''}<h3 class="news-headline">${esc(news.headline)}</h3>${isM||slot.w>=3?`<p class="news-subtitle">${esc(news.subtitle)}</p>`:''}${isM?`<p class="news-summary">${esc(news.summary)}</p>`:''}</div>`;
    return`<div class="slot" style="${st}" data-slot-id="${slot.id}" data-action="drop-zone"><div class="slot-placeholder"><div class="slot-icon">${isM?'â­':'ğŸ“„'}</div><div class="slot-label">${slot.label}</div><div class="slot-hint">×’×¨×•×¨</div></div></div>`;
  }).join("");
  return`<div class="container-wide"><div class="info-box"><h2>×©×œ×‘ 3: ×¢×™×¦×•×‘ ×”×“×£</h2><p>×’×¨×•×¨/×™ ×™×“×™×¢×•×ª ×œ××©×‘×¦×•×ª. ×›×œ ××©×‘×¦×ª ×‘×’×•×“×œ ×©×•× ×” â€” ×”×™×“×™×¢×” ×”×¨××©×™×ª ×”×›×™ ×’×“×•×œ×”.</p></div><div class="arrange-layout"><div class="arrange-sidebar"><div class="sidebar-section"><label>×©× ×”×¢×™×ª×•×Ÿ</label><input type="text" class="name-input" id="nnInput" value="${esc(S.newspaperName)}"></div><div class="sidebar-section"><label>×ª×‘× ×™×ª</label>${lBtns}</div><div class="sidebar-section"><label>×™×“×™×¢×•×ª (${unassNews().length})</label>${unassNews().length===0?'<div style="text-align:center;color:#aaa;font-size:.76rem;padding:8px">âœ… ×”×›×œ ×©×•×‘×¥</div>':''}<div id="dc">${dItems}</div></div></div><div class="newspaper-area"><div class="newspaper-frame"><div class="newspaper-header"><div class="date">${hDate()}</div><h1 id="pn">${esc(S.newspaperName)}</h1><div class="byline">×¢×•×¨×š/×ª: ${esc(S.studentName)}</div></div><div class="newspaper-grid" style="grid-template-columns:${L.cols};grid-template-rows:${L.rows}">${gridSlots}</div></div>${allFilled()?'<div class="btn-center"><button class="btn btn-accent" data-action="goto-justify">×”××©×š ×œ× ×™××•×§×™× â†</button></div>':''}</div></div><div class="btn-center"><button class="btn btn-muted" data-action="goto-select">â†’ ×—×–×¨×”</button></div></div>`;
}

function renderJustify(){
  const slots=getSlots();
  const sc=slots.map(slot=>{const news=getN(S.slotAssignments[slot.id]);if(!news)return'';const col=CC[news.category]||"#666";return`<div class="justify-card"><div style="display:flex;gap:5px;align-items:center;flex-wrap:wrap"><span class="slot-tag ${slot.isMain?'main':'other'}">${slot.label}</span><span class="tag" style="background:${col}18;color:${col}">${news.category}</span><span class="score-mini">â­${avgR(news.id).toFixed(1)}</span></div><h3>${esc(news.headline)}</h3><textarea class="justify-textarea" data-jk="${slot.id}" placeholder="${slot.isMain?'××“×•×¢ ×–×• ×”×™×“×™×¢×” ×”×¨××©×™×ª? ××” ×”×¢×¨×š ×”×—×“×©×•×ª×™ ×©×œ×”?':'××“×•×¢ ×‘×—×¨×ª ×‘×™×“×™×¢×” ×–×• ×•×‘××™×§×•× ×”×–×”?'}">${esc(S.justifications[slot.id]||'')}</textarea></div>`}).join("");
  const rc=rejNews().map(n=>{const col=CC[n.category]||"#666";return`<div class="rejected-item"><h4><span class="tag" style="background:${col}18;color:${col};margin-left:5px;font-size:.65rem">${n.category}</span>${esc(n.headline)}</h4><textarea class="justify-textarea" data-jk="reject-${n.id}" placeholder="××“×•×¢ ×œ× × ×›× ×¡×” ×œ×“×£?" rows="2">${esc(S.justifications[`reject-${n.id}`]||'')}</textarea></div>`}).join("");
  return`<div class="container"><div class="info-box"><h2>×©×œ×‘ 4: × ×™××•×§×™×</h2><p>×”×¡×‘×¨/×™ ××ª ×”×”×—×œ×˜×•×ª. ×”×ª×™×™×—×¡/×™ ×œ×§×¨×™×˜×¨×™×•× ×™ ×”×¢×¨×š ×”×—×“×©×•×ª×™.</p></div><div class="rejected-box"><h3>ğŸ¤” ×™×“×™×¢×•×ª ×©×œ× × ×‘×—×¨×•</h3><p>××“×•×¢ 4 ×”×™×“×™×¢×•×ª ×”×‘××•×ª ×œ× × ×›× ×¡×•?</p>${rc}</div>${sc}<div class="btn-center"><button class="btn btn-muted" data-action="goto-arrange">â†’ ×—×–×¨×”</button><button class="btn btn-accent" data-action="goto-preview">×¦×¤×” ×‘×ª×•×¦××” â†</button></div></div>`;
}

function renderPreview(){
  const L=LAYOUTS[S.layout];
  const gs=L.slots.map(slot=>{const news=getN(S.slotAssignments[slot.id]);if(!news)return'';const isM=slot.isMain;const col=CC[news.category]||"#666";const ci=newsColorIdx(news.id);const st=`grid-column:${slot.x}/span ${slot.w};grid-row:${slot.y}/span ${slot.h};`;
    return`<div class="final-slot font-${slot.font} news-bg-${ci}" style="${st}"><span class="cat-label" style="color:${col}">${news.category}</span>${news.hasImage&&(isM||slot.h>=2)?`<div class="img-area">${CI[news.category]||'ğŸ“°'}</div>`:''}<h3 class="news-headline">${esc(news.headline)}</h3><p class="sub">${esc(news.subtitle)}</p>${isM?`<p class="summ">${esc(news.summary)}</p>`:''}</div>`}).join("");
  const ji=getSlots().map(slot=>{const news=getN(S.slotAssignments[slot.id]);if(!news||!S.justifications[slot.id])return'';return`<div class="just-item"><div class="tag-line"><span class="mini-tag" style="background:${slot.isMain?'var(--accent)':'var(--slate)'}">${slot.label}</span><strong>${esc(news.headline)}</strong></div><p>${esc(S.justifications[slot.id])}</p></div>`}).join("");
  const ri=rejNews().map(n=>{if(!S.justifications[`reject-${n.id}`])return'';return`<div class="just-item"><strong>${esc(n.headline)}</strong><p>${esc(S.justifications[`reject-${n.id}`])}</p></div>`}).join("");
  const tRows=S.allNews.map(n=>{const avg=avgR(n.id);const inP=S.selectedIds.has(n.id);return`<tr style="background:${inP?'#f8fff8':'#fff'}"><td style="text-align:right;max-width:150px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap">${esc(n.headline.substring(0,35))}...</td><td><span style="color:${CC[n.category]||'#666'};font-size:.66rem;font-weight:600">${n.category}</span></td>${CRITERIA.map(c=>`<td style="color:#b8860b">${S.ratings[n.id]?.[c.key]||'-'}</td>`).join('')}<td style="font-weight:700;color:#b8860b">${avg.toFixed(1)}</td><td>${inP?'âœ…':'âŒ'}</td></tr>`}).join("");

  return`<div class="container">
    <div class="preview-header"><div><h2>ğŸ“° ×”×ª×•×¦××” ×”×¡×•×¤×™×ª</h2><p style="margin:2px 0 0;color:var(--muted);font-size:.8rem">${esc(S.studentName)}</p></div><div style="display:flex;gap:7px;flex-wrap:wrap"><button class="btn btn-muted" data-action="goto-justify" style="padding:7px 13px;font-size:.8rem">â†’ × ×™××•×§×™×</button><button class="btn btn-dark" data-action="submit-work" style="padding:7px 13px;font-size:.8rem">ğŸ“¤ ×©×œ×— ×œ××•×¨×”</button><button class="btn btn-accent" data-action="print" style="padding:7px 13px;font-size:.8rem">ğŸ–¨ï¸ ×”×“×¤×¡×”</button></div></div>
    <div class="final-newspaper" id="printArea"><div class="newspaper-header"><div class="date">${hDate()}</div><h1>${esc(S.newspaperName)}</h1><div class="byline">×¢×•×¨×š/×ª: ${esc(S.studentName)}</div></div><div class="newspaper-grid" style="grid-template-columns:${L.cols};grid-template-rows:${L.rows}">${gs}</div></div>
    <div class="justification-summary"><h3>ğŸ“ ×”× ×™××•×§×™× ×©×œ×™</h3>${ji}${ri?`<div class="rejected-summary"><h4>×™×“×™×¢×•×ª ×©×œ× × ×‘×—×¨×•:</h4>${ri}</div>`:''}</div>
    <div class="info-box ratings-wrap" style="margin-top:16px;overflow-x:auto"><h3 style="font-family:var(--fd);margin-bottom:8px">ğŸ“Š ×˜×‘×œ×ª ×“×™×¨×•×’×™×</h3><table class="ratings-table"><thead><tr><th style="text-align:right">×™×“×™×¢×”</th><th>×§×˜×’×•×¨×™×”</th>${CRITERIA.map(c=>`<th title="${c.desc}">${c.icon}</th>`).join('')}<th>×××•×¦×¢</th><th>×‘×“×£?</th></tr></thead><tbody>${tRows}</tbody></table></div>
  </div>`;
}

// ============ EVENTS ============
function attachEvents(){
  const ni=document.getElementById("nameInput"),sb=document.getElementById("startBtn");
  if(ni&&sb){ni.addEventListener("input",()=>{sb.disabled=!ni.value.trim()});ni.addEventListener("keydown",e=>{if(e.key==="Enter"&&ni.value.trim()){S.studentName=ni.value.trim();S.mode="rate";render()}});sb.addEventListener("click",()=>{if(ni.value.trim()){S.studentName=ni.value.trim();S.mode="rate";render()}});ni.focus()}
  const nn=document.getElementById("nnInput");if(nn)nn.addEventListener("input",()=>{S.newspaperName=nn.value;const d=document.getElementById("pn");if(d)d.textContent=nn.value});
  const ti=document.getElementById("teacherNameInput");if(ti)ti.addEventListener("input",()=>{S.teacherName=ti.value});
  document.querySelectorAll(".justify-textarea").forEach(t=>t.addEventListener("input",()=>{S.justifications[t.dataset.jk]=t.value}));
  document.querySelectorAll(".drag-item:not(.placed)").forEach(item=>{
    item.addEventListener("dragstart",e=>{S.draggedNewsId=parseInt(item.dataset.newsId);e.dataTransfer.setData("text/plain",item.dataset.newsId);item.style.opacity=".5"});
    item.addEventListener("dragend",()=>{item.style.opacity="";S.draggedNewsId=null})});
  document.querySelectorAll("[data-action='drop-zone']").forEach(zone=>{
    zone.addEventListener("dragover",e=>{e.preventDefault();zone.classList.add("drag-over")});
    zone.addEventListener("dragleave",()=>zone.classList.remove("drag-over"));
    zone.addEventListener("drop",e=>{e.preventDefault();zone.classList.remove("drag-over");const nid=parseInt(e.dataTransfer.getData("text/plain")||S.draggedNewsId);const sid=zone.dataset.slotId;if(nid&&sid){Object.keys(S.slotAssignments).forEach(k=>{if(S.slotAssignments[k]===nid)delete S.slotAssignments[k]});S.slotAssignments[sid]=nid;render()}})});
  document.removeEventListener("click",handleAction);document.addEventListener("click",handleAction);
}

async function handleAction(e){
  const el=e.target.closest("[data-action]");if(!el)return;const a=el.dataset.action;
  if(a==="set-star"){e.stopPropagation();const nid=parseInt(el.dataset.news),crit=el.dataset.crit,val=parseInt(el.dataset.val);if(!S.ratings[nid])S.ratings[nid]={};S.ratings[nid][crit]=val;render();return}
  if(a==="toggle-expand"){S.expandedCard=S.expandedCard===parseInt(el.dataset.id)?null:parseInt(el.dataset.id);render();return}
  if(a==="toggle-select"){const id=parseInt(el.dataset.id);if(S.selectedIds.has(id)){S.selectedIds.delete(id);Object.keys(S.slotAssignments).forEach(k=>{if(S.slotAssignments[k]===id)delete S.slotAssignments[k]})}else if(S.selectedIds.size<6)S.selectedIds.add(id);render();return}
  if(a==="set-layout"){S.layout=el.dataset.layout;S.slotAssignments={};render();return}
  if(a==="remove-slot"){e.stopPropagation();delete S.slotAssignments[el.dataset.slot];render();return}
  if(a==="print"){window.print();return}
  if(a==="goto-landing"){S.mode="landing";render();return}
  if(a==="goto-teacher"){S.mode="teacher";render();return}
  
  if(a==="goto-student"){return}

  if(a==="generate-news"){
    if(!S.teacherName.trim()){alert("×™×© ×œ×”×–×™×Ÿ ×©× ××•×¨×”");return}
    S.allNews=pickRandom10();
    S.sessionId=Date.now().toString(36)+Math.random().toString(36).substr(2,4);
    saveConfig().then(()=>render());return}
  if(a==="regenerate"){S.allNews=pickRandom10();S.sessionId=Date.now().toString(36)+Math.random().toString(36).substr(2,4);saveConfig().then(()=>render());return}
  
  if(a==="copy-student-link"||a==="copy-teacher-link"){
    const id=a==="copy-student-link"?"studentLink":"teacherLink";
    const ta=document.getElementById(id);if(ta){ta.select();try{await navigator.clipboard.writeText(ta.value)}catch(x){document.execCommand("copy")}el.textContent="âœ… ×”×•×¢×ª×§!";setTimeout(()=>{el.textContent="ğŸ“‹ ×”×¢×ª×§ ×§×™×©×•×¨ "+(a==="copy-student-link"?"×œ×ª×œ××™×“×™×":"××•×¨×”")},2000)}return}

  if(a==="submit-work"){
    const data={studentName:S.studentName,timestamp:new Date().toISOString(),selectedIds:Array.from(S.selectedIds),layout:S.layout,slotAssignments:{...S.slotAssignments},justifications:{...S.justifications},newspaperName:S.newspaperName,ratings:JSON.parse(JSON.stringify(S.ratings))};
    await saveToFirebase(data);
    el.textContent="âœ… × ×©×œ×— ×‘×”×¦×œ×—×”!";el.style.background="#27ae60";
    setTimeout(()=>{el.textContent="ğŸ“¤ ×©×œ×— ×œ××•×¨×”";el.style.background=""},2500);
    return}

  if(a==="refresh-subs"){
    S.submissions=await loadSubmissions();render();return}

  const nav={"goto-rate":"rate","goto-select":"select","goto-arrange":"arrange","goto-justify":"justify","goto-preview":"preview"};
  if(nav[a]){S.mode=nav[a];render();window.scrollTo(0,0)}
}

// ============ INIT ============
const hashId=checkUrl();
if(hashId){
  const isTeacher=hashId.startsWith('t_');
  const sid=isTeacher?hashId.substring(2):hashId;
  S.sessionId=sid;
  const cfgPromise=loadConfig(sid);
  const subPromise=isTeacher?loadSubmissions():Promise.resolve([]);
  Promise.all([cfgPromise,subPromise]).then(([cfg,subs])=>{
    if(!cfg){S.mode="landing";render();return}
    S.allNews=cfg.news||[];S.teacherName=cfg.teacher||"";
    S.ratings={};S.allNews.forEach(n=>{S.ratings[n.id]={}});
    if(isTeacher){S.submissions=subs;S.mode="teacher-view"}else{S.mode="student-name"}
    render();
  });
} else {
render();
}
</script></body></html>
