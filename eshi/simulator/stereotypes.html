<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>××•×ª×• ××“×, ×›×ª×‘×” ××—×¨×ª â€” ×¡×™××•×œ×¦×™×™×ª ×™×™×¦×•×’ ×•×¡×˜×¨×™××•×˜×™×¤×™×</title>
<link href="https://fonts.googleapis.com/css2?family=David+Libre:wght@400;500;700&family=Frank+Ruhl+Libre:wght@300;400;500;700;900&family=Noto+Sans+Hebrew:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
<style>
:root{--ink:#1a1410;--paper:#f8f5ef;--pbr:#fefcf7;--accent:#9333ea;--accent-dk:#7e22ce;--slate:#2c3e50;--muted:#8a8070;--border:#d4cfc5;--bl:#e8e4dc;--fd:'Frank Ruhl Libre','David Libre',serif;--fb:'David Libre','Noto Sans Hebrew',serif;--fu:'Noto Sans Hebrew','David Libre',sans-serif;--r:8px;--rl:12px}
*{margin:0;padding:0;box-sizing:border-box}html{scroll-behavior:smooth}body{font-family:var(--fb);background:var(--paper);color:var(--ink);min-height:100vh;line-height:1.6}
@keyframes fadeIn{from{opacity:0}to{opacity:1}}
@keyframes slideUp{from{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}

.landing{min-height:100vh;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:40px 20px;text-align:center;background:linear-gradient(180deg,#f8f5ef,#ece6db)}
.landing-logo{font-size:4rem;margin-bottom:10px}
.landing h1{font-family:var(--fd);font-size:2.1rem;font-weight:900;margin-bottom:2px}
.landing .tagline{font-size:1rem;color:var(--muted);margin-bottom:4px}
.landing .credit{font-size:.78rem;color:#b0a898;margin-bottom:28px}
.landing-card{background:#fff;border-radius:16px;padding:26px 24px;max-width:480px;width:92%;border:2px solid var(--bl);box-shadow:0 4px 20px rgba(0,0,0,.08);text-align:right}
.landing-card .ci{font-size:2rem;margin-bottom:5px;text-align:center}
.landing-card h2{font-family:var(--fd);font-size:1.1rem;margin-bottom:5px;text-align:center}
.landing-card p{font-size:.81rem;color:var(--muted);line-height:1.7;margin-bottom:10px}
.landing-card ol{font-size:.78rem;color:#666;line-height:1.8;padding-right:18px;margin-bottom:10px}
.lbtn{display:block;width:100%;padding:11px;font-size:.93rem;font-family:var(--fu);font-weight:700;border:none;border-radius:var(--r);cursor:pointer;text-align:center;background:var(--slate);color:#fff;transition:all .25s}.lbtn:hover{background:#1a2a3a}
.landing-hint{font-size:.76rem;color:#aaa;margin-top:7px;text-align:center}
.landing-footer{margin-top:28px;font-size:.72rem;color:#c0b8a8}

.modal-overlay{position:fixed;inset:0;background:rgba(20,16,10,.75);backdrop-filter:blur(6px);display:flex;align-items:center;justify-content:center;z-index:1000;animation:fadeIn .3s}
.modal-card{background:var(--pbr);border-radius:16px;padding:28px 30px;box-shadow:0 24px 80px rgba(0,0,0,.35);max-width:540px;width:92%;animation:slideUp .4s;text-align:right}
.modal-card h2{font-family:var(--fd);font-size:1.25rem;font-weight:900;margin-bottom:3px;text-align:center}
.modal-sub{color:var(--muted);font-size:.82rem;margin-bottom:14px;text-align:center;line-height:1.6}
.modal-input{width:100%;padding:9px 12px;font-size:.9rem;border:2px solid var(--border);border-radius:var(--r);font-family:var(--fb);outline:none;background:#fff}.modal-input:focus{border-color:var(--accent)}
.modal-btn{width:100%;padding:10px;font-size:.92rem;font-family:var(--fu);font-weight:700;border:none;border-radius:var(--r);cursor:pointer;margin-top:9px}.modal-btn.primary{background:var(--accent);color:#fff}.modal-btn.primary:hover{background:var(--accent-dk)}.modal-btn:disabled{background:var(--border);color:#999;cursor:default}
.credit-bar{background:linear-gradient(135deg,#9333ea08,#ec489908);border:1px solid #e9d5ff;border-radius:20px;padding:4px 16px;font-size:.72rem;color:var(--accent);font-family:var(--fu);font-weight:500;text-align:center;margin-bottom:10px}

.app-header{background:var(--ink);color:var(--pbr);padding:0 18px;height:50px;display:flex;justify-content:space-between;align-items:center;position:sticky;top:0;z-index:100;box-shadow:0 2px 16px rgba(0,0,0,.25)}
.header-brand{display:flex;align-items:center;gap:9px}
.header-brand .logo{font-size:1.15rem}.header-brand h1{font-family:var(--fd);font-size:.95rem;font-weight:700}.header-brand .meta{font-size:.64rem;opacity:.5}
.phase-indicators{display:flex;gap:3px}
.phase-pill{padding:3px 9px;border-radius:20px;font-size:.67rem;font-weight:600;font-family:var(--fu);background:rgba(255,255,255,.08);color:rgba(255,255,255,.3);transition:all .3s;white-space:nowrap}
.phase-pill.active{background:var(--accent);color:#fff}.phase-pill.done{background:rgba(255,255,255,.15);color:rgba(255,255,255,.6)}

.container{max-width:960px;margin:0 auto;padding:20px 18px}
.info-box{background:#fff;border-radius:var(--rl);padding:15px 20px;margin-bottom:14px;border:1px solid var(--bl)}
.info-box h2{font-family:var(--fd);font-size:1.12rem;margin-bottom:3px}.info-box p{color:var(--muted);font-size:.82rem;line-height:1.7}
.btn{display:inline-flex;align-items:center;gap:5px;padding:9px 20px;border-radius:var(--r);font-size:.85rem;font-weight:700;font-family:var(--fu);border:none;cursor:pointer;transition:all .25s}.btn:active{transform:scale(.97)}
.btn-accent{background:var(--accent);color:#fff}.btn-accent:hover{background:var(--accent-dk)}
.btn-dark{background:var(--slate);color:#fff}.btn-dark:hover{background:#1a2a3a}
.btn-muted{background:#b0a898;color:#fff}.btn-muted:hover{background:#9a9080}
.btn-center{display:flex;justify-content:center;gap:12px;margin-top:20px;flex-wrap:wrap}

/* Theory accordion */
.theory-accordion{background:#fff;border:1px solid var(--bl);border-radius:var(--rl);margin-bottom:14px;overflow:hidden}
.theory-toggle{width:100%;display:flex;justify-content:space-between;align-items:center;padding:12px 18px;cursor:pointer;background:#fff;border:none;font-family:var(--fu);font-size:.88rem;font-weight:700;color:var(--accent);transition:background .2s}
.theory-toggle:hover{background:#faf5ff}
.theory-toggle .chevron{transition:transform .3s;font-size:.8rem}
.theory-accordion.open .theory-toggle .chevron{transform:rotate(180deg)}
.theory-body{max-height:0;overflow:hidden;transition:max-height .4s ease,padding .3s;padding:0 18px}
.theory-accordion.open .theory-body{max-height:2000px;padding:0 18px 16px}
.theory-body h4{font-family:var(--fd);font-size:.92rem;margin:10px 0 4px}
.theory-body p,.theory-body li{font-size:.8rem;color:#555;line-height:1.7}
.theory-body ul{padding-right:18px;margin-bottom:6px}
.theory-body .highlight{background:#faf5ff;border-right:3px solid var(--accent);padding:6px 12px;border-radius:0 6px 6px 0;margin:6px 0;font-size:.8rem;font-weight:600;color:var(--accent-dk)}

/* Link */
.link-result{margin-top:12px;padding:12px;background:#faf5ff;border:2px solid var(--accent);border-radius:var(--r);animation:slideUp .3s}
.link-result h3{font-size:.86rem;color:var(--accent-dk);margin-bottom:4px;font-family:var(--fu);text-align:center}
.link-url{width:100%;padding:7px;background:#fff;border:1px solid #e9d5ff;border-radius:6px;font-family:monospace;font-size:.66rem;direction:ltr;text-align:left;word-break:break-all;margin-bottom:5px;resize:none;min-height:40px;outline:none}
.link-actions{display:flex;gap:7px}
.link-actions button{flex:1;padding:7px;font-family:var(--fu);font-weight:600;font-size:.8rem;border:none;border-radius:6px;cursor:pointer}
.copy-btn{background:var(--accent);color:#fff}.copy-btn:hover{background:var(--accent-dk)}
.new-btn{background:#3498db;color:#fff}.new-btn:hover{background:#2980b9}

/* Neutral event */
.neutral-event{background:#fff;border:2px solid var(--accent);border-radius:var(--rl);padding:20px;margin-bottom:16px;position:relative}
.neutral-event::before{content:'ğŸ“‹ ×”××™×¨×•×¢ â€” ×¢×•×‘×“×•×ª ×‘×œ×‘×“';position:absolute;top:-11px;right:14px;background:var(--accent);color:#fff;padding:2px 12px;border-radius:20px;font-size:.74rem;font-weight:700;font-family:var(--fu)}
.neutral-event h3{font-family:var(--fd);font-size:1.1rem;margin:6px 0 8px}
.neutral-event p{font-size:.84rem;line-height:1.7}

/* Version cards */
.versions-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:14px}
.version-card{background:#fff;border-radius:var(--rl);padding:16px;border:2px solid var(--bl);position:relative;transition:all .25s}
.version-card:hover{box-shadow:0 3px 12px rgba(0,0,0,.08)}
.version-card .vc-badge{display:inline-block;padding:2px 12px;border-radius:20px;font-size:.72rem;font-weight:700;font-family:var(--fu);color:#fff;margin-bottom:6px}
.version-card .vc-source{font-size:.68rem;color:#999;font-family:var(--fu);margin-bottom:6px}
.version-card h3{font-family:var(--fd);font-size:1rem;font-weight:800;line-height:1.3;margin-bottom:4px}
.version-card .vc-body{font-size:.82rem;line-height:1.65;color:#444}
.version-card .vc-body mark{background:#fef08a;padding:0 3px;border-radius:2px;cursor:help}

/* Identify phase */
.identify-card{background:#fff;border-radius:var(--rl);padding:14px 18px;margin-bottom:10px;border:1px solid var(--bl)}
.identify-card h4{font-family:var(--fd);font-size:.9rem;margin-bottom:4px}
.identify-textarea{width:100%;padding:8px 11px;border:1px solid var(--border);border-radius:var(--r);font-family:var(--fb);font-size:.84rem;line-height:1.7;resize:vertical;outline:none;min-height:50px}.identify-textarea:focus{border-color:var(--accent)}

/* Fairness vote */
.vote-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:8px;margin-bottom:14px}
.vote-card{background:#fff;border:2px solid var(--bl);border-radius:10px;padding:12px;cursor:pointer;transition:all .25s;text-align:center}
.vote-card:hover{border-color:#c0b8a8;box-shadow:0 2px 8px rgba(0,0,0,.08)}
.vote-card.selected{border-color:var(--accent);background:#faf5ff;box-shadow:0 0 0 1px var(--accent)}
.vote-card .vc-icon{font-size:1.5rem;margin-bottom:3px}
.vote-card .vc-name{font-family:var(--fu);font-size:.82rem;font-weight:700}

/* Write section */
.write-panel{background:#fff;border:2px solid var(--bl);border-radius:var(--rl);padding:18px;margin-bottom:14px}
.write-panel label{display:block;font-size:.81rem;font-weight:700;font-family:var(--fu);margin:8px 0 3px;color:var(--slate)}
.write-input{width:100%;padding:9px 11px;border:1px solid var(--border);border-radius:var(--r);font-family:var(--fd);font-weight:700;font-size:1rem;outline:none}.write-input:focus{border-color:var(--accent)}
.write-textarea{width:100%;padding:9px 11px;border:1px solid var(--border);border-radius:var(--r);font-family:var(--fb);font-size:.86rem;line-height:1.7;resize:vertical;outline:none;min-height:80px}.write-textarea:focus{border-color:var(--accent)}

/* Result newspaper */
.result-newspaper{background:var(--pbr);border:2px solid var(--ink);border-radius:3px;padding:22px;box-shadow:0 8px 30px rgba(0,0,0,.15);margin-bottom:14px}
.rn-header{text-align:center;border-bottom:3px double var(--ink);padding-bottom:8px;margin-bottom:12px}
.rn-header h1{font-family:var(--fd);font-size:1.6rem;font-weight:900;line-height:1.2;margin-bottom:2px}
.rn-header .rn-sub{font-size:.86rem;color:#555;line-height:1.4}
.rn-body{font-size:.86rem;line-height:1.7;text-align:justify}
.rn-byline{font-size:.7rem;color:var(--muted);font-family:var(--fu);margin-top:8px;text-align:left;border-top:1px solid var(--border);padding-top:5px}

/* Teacher */
.sub-card{background:#fff;border:1px solid var(--bl);border-radius:var(--rl);padding:16px;margin-bottom:14px}
.sub-card h4{font-family:var(--fd);font-size:1.02rem;margin-bottom:4px}
.sub-meta{font-size:.74rem;color:var(--muted);margin-bottom:8px}

.instructions-box{background:#faf5ff;border:1px solid #e9d5ff;border-radius:var(--rl);padding:13px 18px;margin-bottom:14px}
.instructions-box h3{font-size:.9rem;color:var(--accent);margin-bottom:3px;font-family:var(--fu)}
.instructions-box ol{font-size:.79rem;color:#666;line-height:1.8;padding-right:18px}

@media print{.app-header,.info-box,.instructions-box,.btn,.btn-center,.credit-bar,.theory-accordion{display:none!important}body{background:#fff}.result-newspaper{box-shadow:none;border:1px solid #000}}
@media(max-width:768px){.versions-grid{grid-template-columns:1fr}.vote-grid{grid-template-columns:repeat(2,1fr)}.container{padding:12px 10px}.phase-indicators{display:none}}
</style>
</head>
<body>
<div id="app"></div>
<script>
// ============ FIREBASE ============
const firebaseConfig={apiKey:"AIzaSyCh8TMjXeatpegwaJGOiT64VU0cXeWMwLA",authDomain:"newspaper-editor.firebaseapp.com",databaseURL:"https://newspaper-editor-default-rtdb.europe-west1.firebasedatabase.app",projectId:"newspaper-editor",storageBucket:"newspaper-editor.firebasestorage.app",messagingSenderId:"1056483646622",appId:"1:1056483646622:web:1afdb41dbcfacff9106f8f"};
let db;try{firebase.initializeApp(firebaseConfig);db=firebase.database()}catch(e){console.warn(e)}

const THEORY_HTML=`
<h4>×¡×˜×¨×™××•×˜×™×¤ â€” ×”×’×“×¨×”</h4>
<p>×“×™××•×™ ××›×œ×™×œ ×©×œ ×§×‘×•×¦×” ×—×‘×¨×ª×™×ª ×œ×¨×•×‘ ×¢×œ ×¤×™ ×××¤×™×™× ×™× ×—×™×¦×•× ×™×™× ×•×‘×“×¨×š ×›×œ×œ ×©×œ×™×œ×™×™×. ××‘×˜× ×“×¢×” ×§×“×•××”, ×¡×˜×™×’××”, ×”×›×œ×œ×” ×©××¨××” ××™×š ×§×‘×•×¦×ª ×‘× ×™ ××“× × ×ª×¤×¡×ª ×‘×¢×™× ×™ ×§×‘×•×¦×” ××—×¨×ª ××”×.</p>
<div class="highlight">ğŸ”‘ ××•×©×’ ×—×•×¦×” ×–×™×¨×•×ª â€” ×‘×©×œ×œ ×–×™×¨×•×ª ×™×© ×©×™××•×© ×‘×¡×˜×¨×™××•×˜×™×¤×™×: ×¨×™××œ×™×˜×™, ×¤×¨×¡×•××•×ª, ×—×“×©×•×ª ×•×¢×•×“.</div>
<h4>×œ××” ××©×ª××©×™× ×‘×¡×˜×¨×™××•×˜×™×¤×™×?</h4>
<p>××¦×“ ××—×“, ×¡×˜×¨×™××•×˜×™×¤×™× ×¢×•×–×¨×™× ×œ× ×• ×œ×”×¦×™×’ ××©××¢×•×ª ×‘×¦×•×¨×” ××”×™×¨×” ×•×‘×¨×•×¨×” ×©×§×œ×” ×œ×¢×™×›×•×œ ×¢×œ ×™×“×™ ×”×§×”×œ. ××¦×“ ×©× ×™, ×–×” ××—×–×§ ××ª ×”×¡×˜×¨×™××•×˜×™×¤ ×•××ª ×”×ª××•× ×” ×”×¤×©×˜× ×™×ª ×©×œ ×”××¦×™××•×ª ×•×¤×•×’×¢ ×‘×”×‘× ×™×™×” ×™×•×ª×¨ ××•×¨×›×‘×ª ×•××’×•×•× ×ª ×©×œ ×”××¦×™××•×ª.</p>
<h4>×¡×˜×¨×™××•×˜×™×¤×™× ×‘×§×œ×™×¤×™×</h4>
<p>×”×§×œ×™×¤×™× ×”× ×××¦×¢×™ ×›×œ×›×œ×™ ×œ×©×™×•×•×§ ×”×–××¨ ×•×”×©×™×¨ ×•×œ×›×Ÿ ×”× ×¢×•×©×™× ×©×™××•×© ×‘×¡×˜×¨×™××•×˜×™×¤×™× ×©××’×–×™××™× ×•××§×¦×™× ×™× ××ª ×ª×¤×§×™×“×™ ×”××’×“×¨ ×›×“×™ ×œ××©×•×š ××ª ×”×§×”×œ ×”×¦×¢×™×¨.</p>
<h4>×”×¨×—×‘×” ×•××§×•×¨×•×ª ××™×“×¢ × ×•×¡×¤×™×</h4>
<p><strong>×“×™×œ××”:</strong> ×©×™××•×© ×‘×¤×¨×•×‘×•×§×¦×™×•×ª × ×¤×•×¥ ×‘×§×œ×™×¤×™× â€” ×‘×™×™×¦×•×’ ××™× ×™, ××’×“×¨×™, ×’×–×¢×™, ×©×™××•×© ×‘××œ×™××•×ª. ×‘××™×–×• ××™×“×” ×©×™××•×© ×‘×¤×¨×•×‘×•×§×¦×™×•×ª ××‘×™× ×œ×¨×™×™×˜×™× ×’ ×¢×œ ×—×©×‘×•×Ÿ ×”×¢××§×ª ×¡×˜×¨×™××•×˜×™×¤×™×, ×•×‘××™×–×• ××™×“×” × ×¢×“×™×£ ×§×œ×™×¤×™× ××ª×•× ×™× ×™×•×ª×¨ ×•×‘×›×š ×©×‘×™×¨×ª ×”×¡×˜×¨×™××•×˜×™×¤×™× ×•×™×™×¦×•×’ ×ª×¨×‘×•×ª×™-×—×‘×¨×ª×™ ××•×¨×›×‘, ××‘×œ ×¢×œ ×—×©×‘×•×Ÿ ×¨×•×•×— ×›×œ×›×œ×™, ×¨×™×™×˜×™× ×’ ×•××•×‘×“×Ÿ ×™×•×§×¨×”, ×§×”×œ ×•××¢××“ ×‘×ª×¢×©×™×™×”?</p>
<p><strong>×“×™×œ××” â€” ×ª×•×¦×¨×™ ×”×ª×œ××™×“×™×:</strong> ×‘××™×–×• ××™×“×” ×”×§×œ×™×¤×™× ×©××ª× ×™×•×¦×¨×™× ××©×›×¤×œ×™× ×“×™××•×™×™× ××’×“×¨×™×™×/××™× ×™×™× ×•×¢×•×“ ××ª×¢×©×™×™×ª ×”×§×œ×™×¤×™× ×©××•Ö¼×›Ö¼×¨×™× ×œ×§×”×œ (×”×¨×•×•×—: ×§×œ ×œ×™×¦×•×¨, ×§×œ ×œ×§×‘×œ ×›×§×”×œ, ××•×›×¨ ×œ×§×”×œ, ×™×•×ª×¨ ×¨×™×™×˜×™× ×’ ×•××™×™×¦×¨ ×ª×”×•×“×” ×—×™×•×‘×™×ª. ×”××—×™×¨: ×©×›×¤×•×œ ×¡×˜×¨×™××•×˜×™×¤×™×, ×”×™×¢×“×¨ ××§×•×¨×™×•×ª) ×•×¢×“ ×›××” ××ª× ×©××™× ×œ×‘ ×œ×™×™×¦×•×’×™× ×•××™×™×¦×¨×™× ××©×”×• ×™×•×ª×¨ ××§×•×¨×™ ×•×¤×—×•×ª ×¡×˜×¨×™××•×˜×™×¤×™ (×”×¨×•×•×—: ×™×™×¦×•×’ ×ª×¨×‘×•×ª×™-×—×‘×¨×ª×™ ××•×¨×›×‘. ×”××—×™×¨: ×¨×™×™×˜×™× ×’).</p>
`;

const IDENTITY_COLORS={a:{label:"×¢×¨×‘×™",icon:"ğŸŸ¢",color:"#16a34a",bg:"#f0fdf4"},b:{label:"×—×¨×“×™",icon:"ğŸ”µ",color:"#2563eb",bg:"#eff6ff"},c:{label:"×™×•×¦× ××ª×™×•×¤×™×”",icon:"ğŸŸ¡",color:"#d97706",bg:"#fffbeb"},d:{label:"×¢×•×œ×” ××¨×•×¡×™×”",icon:"ğŸ”´",color:"#dc2626",bg:"#fef2f2"},e:{label:"××©×›× ×–×™/×¦×‘×¨",icon:"âšª",color:"#64748b",bg:"#f8fafc"}};
const SELECTABLE_IDS=["a","b","c","d"]; // teacher picks 3 from these
const AUTO_ID="e"; // always added automatically

// ============ EVENTS DATABASE ============
const ALL_EVENTS=[
{
  id:1,
  neutralTitle:"×’×‘×¨ ×‘×Ÿ 30 × ×¢×¦×¨ ×‘×—×©×“ ×œ×’× ×™×‘×” ××¡×•×¤×¨××¨×§×˜",
  neutralBody:"×’×‘×¨ ×‘×Ÿ 30, ×ª×•×©×‘ ×”×¢×™×¨, × ×¢×¦×¨ ×××© ×‘×—×©×“ ×œ×’× ×™×‘×ª ××•×¦×¨×™ ××–×•×Ÿ ××¡×•×¤×¨××¨×§×˜. ×œ×¤×™ ×”×—×©×“, ×”×’×‘×¨ ×”×›× ×™×¡ ××•×¦×¨×™× ×‘×©×•×•×™ 350 â‚ª ×œ×ª×™×§ ×•×™×¦× ×‘×œ×™ ×œ×©×œ×. ×¢×•×‘×“ ×”××‘×˜×—×” ×¢×¦×¨ ××•×ª×• ×œ×™×“ ×”×™×¦×™××”. ×”××©×˜×¨×” ×—×•×§×¨×ª ××ª ×”××§×¨×”. ×œ×’×‘×¨ ××™×Ÿ ×¢×‘×¨ ×¤×œ×™×œ×™.",
  versions:{
    a:{
      source:"××ª×¨ ×—×“×©×•×ª â€” ×¢×¨×•×¥ 14",
      headline:"×¢×¨×‘×™ × ×ª×¤×¡ ×’×•× ×‘ ××¡×•×¤×¨ ×‘×œ×‘ ×”×¢×™×¨",
      body:"×ª×•×©×‘ ×¢×¨×‘×™ ××”×¦×¤×•×Ÿ <mark>× ×ª×¤×¡ ×‘×–××Ÿ ×©× ×™×¡×” ×œ×’× ×•×‘</mark> ××¡×•×¤×¨××¨×§×˜ ×‘×¢×™×¨. ×”×—×©×•×“, ×©×–×•×”×” ×›<mark>×¢×¨×‘×™ ×‘×Ÿ 30</mark>, ×”×›× ×™×¡ ××•×¦×¨×™× ×œ×ª×™×§ ×•× ×™×¡×” <mark>×œ×”×™××œ×˜</mark> ××”××§×•×. ×¢×•×‘×“ ××‘×˜×—×” ×¢×¨× ×™ <mark>×ª×¤×¡ ××•×ª×• ×¢×œ ×—×</mark>. ×”××©×˜×¨×” ××¦×™×™× ×ª ×›×™ <mark>×’× ×™×‘×•×ª ××¡×•×’ ×–×” ×”×¤×›×• ×œ×ª×•×¤×¢×”</mark> ×‘××–×•×¨."
    },
    b:{
      source:"××ª×¨ ×—×“×©×•×ª â€” ynet",
      headline:"×—×¨×“×™ × ×¢×¦×¨ ×‘×—×©×“ ×œ×’× ×™×‘×ª ××–×•×Ÿ: '×”×ª×‘×™×™×©×ª×™ ×œ×‘×§×© ×¢×–×¨×”'",
      body:"×’×‘×¨ <mark>×—×¨×“×™</mark> ××™×¨×•×©×œ×™× × ×¢×¦×¨ ×‘×—×©×“ ×œ×’× ×™×‘×ª ××•×¦×¨×™ ××–×•×Ÿ ××¡×•×¤×¨××¨×§×˜. <mark>×‘×Ÿ 30, ××‘ ×œ-6 ×™×œ×“×™×</mark>, ×”×›× ×™×¡ ××•×¦×¨×™× ×‘×©×•×•×™ 350 â‚ª ×œ×ª×™×§. ×‘×¢×ª ×”××¢×¦×¨ ×××¨: <mark>'××™×Ÿ ×œ× ×• ××” ×œ××›×•×œ'</mark>. ×’×•×¨× ×‘××©×˜×¨×” ×¦×™×™×Ÿ ×›×™ <mark>×”×¢×•× ×™ ×‘×—×‘×¨×” ×”×—×¨×“×™×ª</mark> ×”×•× ×¨×§×¢ ××¤×©×¨×™ ×œ××§×¨×”."
    },
    c:{
      source:"××ª×¨ ×—×“×©×•×ª â€” ×™×©×¨××œ ×”×™×•×",
      headline:"×¦×¢×™×¨ ×™×•×¦× ××ª×™×•×¤×™×” × ×¢×¦×¨ ×‘×’× ×™×‘×” â€” ×©×•×‘ ××œ×™××•×ª ××©×˜×¨×ª×™×ª?",
      body:"<mark>×¦×¢×™×¨ ×××•×¦× ××ª×™×•×¤×™</mark> × ×¢×¦×¨ ×××© ×‘×—×©×“ ×œ×’× ×™×‘×” ××¡×•×¤×¨××¨×§×˜. ×¢×“×™ ×¨××™×™×” ××¡×¤×¨×™× ×›×™ <mark>×”××‘×˜×—×” ×”×¤×¢×™×œ×” ×›×•×— ×¨×‘</mark> ×‘××¢×¦×¨. <mark>××¨×’×•× ×™× ×‘×§×”×™×œ×” ×”××ª×™×•×¤×™×ª</mark> ×–×•×¢××™× ×•×“×•×¨×©×™× ×—×§×™×¨×”. '×¢×•×“ ××§×¨×” ×©×œ <mark>×¤×¨×•×¤×™×™×œ×™× ×’ ×’×–×¢× ×™</mark>', ×˜×•×¢× ×™×. ×”××©×˜×¨×” ×“×—×ª×” ××ª ×”×˜×¢× ×•×ª."
    },
    d:{
      source:"××ª×¨ ×—×“×©×•×ª â€” ××¢×¨×™×‘",
      headline:"×¢×•×œ×” ××—×‘×¨ ×”×¢××™× × ×¢×¦×¨ ×‘×’× ×™×‘×” ××¡×•×¤×¨",
      body:"×’×‘×¨ ×‘×Ÿ 30, <mark>×¢×•×œ×” ××¨×•×¡×™×”</mark>, × ×¢×¦×¨ ×‘×—×©×“ ×œ×’× ×™×‘×” ××¡×•×¤×¨××¨×§×˜. ×œ×¤×™ ××§×•×¨×•×ª, <mark>××“×•×‘×¨ ×‘××•×‘×˜×œ ×©××ª×§×©×” ×œ×”×©×ª×œ×‘</mark> ×‘×©×•×§ ×”×¢×‘×•×“×”. ×”××©×˜×¨×” ×‘×•×“×§×ª ×”×× <mark>×§×©×•×¨ ×œ×¨×©×ª ×’× ×™×‘×•×ª</mark>. ×’×•×¨××™× ×‘<mark>××©×¨×“ ×”×§×œ×™×˜×”</mark> ××¦×™×™× ×™× ×›×™ ××“×•×‘×¨ ×‘×ª×•×¤×¢×” ×™×“×•×¢×” ×‘×§×¨×‘ <mark>×¢×•×œ×™× ×—×“×©×™×</mark>."
    },
    e:{
      source:"××ª×¨ ×—×“×©×•×ª â€” ynet",
      headline:"×’×‘×¨ ×‘×Ÿ 30 × ×¢×¦×¨ ×‘×—×©×“ ×œ×’× ×™×‘×” ××¡×•×¤×¨××¨×§×˜",
      body:"×’×‘×¨ ×‘×Ÿ 30, ×ª×•×©×‘ ×”×¢×™×¨, × ×¢×¦×¨ ×××© ×‘×—×©×“ ×œ×’× ×™×‘×ª ××•×¦×¨×™ ××–×•×Ÿ ××¡×•×¤×¨××¨×§×˜. ×”×’×‘×¨ ×”×›× ×™×¡ ××•×¦×¨×™× ×‘×©×•×•×™ 350 â‚ª ×œ×ª×™×§ ×•×™×¦× ×‘×œ×™ ×œ×©×œ×. ×¢×•×‘×“ ×”××‘×˜×—×” ×¢×¦×¨ ××•×ª×• ×œ×™×“ ×”×™×¦×™××”. ×”××©×˜×¨×” ×—×•×§×¨×ª ××ª ×”××§×¨×”. ×œ×’×‘×¨ ××™×Ÿ ×¢×‘×¨ ×¤×œ×™×œ×™."
    }
  }
},
{
  id:2,
  neutralTitle:"××™×©×” ×‘×ª 25 ××•× ×ª×” ×œ×× ×”×œ×ª ×¡× ×™×£ ×‘× ×§",
  neutralBody:"××™×©×” ×‘×ª 25 ××•× ×ª×” ×œ×ª×¤×§×™×“ ×× ×”×œ×ª ×¡× ×™×£ ×‘× ×§ ×‘×¢×™×¨ ×’×“×•×œ×” ×‘×™×©×¨××œ. ××“×•×‘×¨ ×‘×× ×”×œ×ª ×”×¦×¢×™×¨×” ×‘×™×•×ª×¨ ×‘×¨×©×ª ×”×¡× ×™×¤×™×. ×”×™× ×‘×¢×œ×ª ×ª×•××¨ ×¨××©×•×Ÿ ×‘×›×œ×›×œ×” ×•×¢×‘×“×” ×‘×‘× ×§ 3 ×©× ×™×. ×”××™× ×•×™ × ×¢×©×” ×œ××—×¨ ×ª×”×œ×™×š ××™×•×Ÿ ×ª×—×¨×•×ª×™.",
  versions:{
    a:{
      source:"××ª×¨ ×—×“×©×•×ª â€” ×›××Ÿ",
      headline:"×¢×¨×‘×™×™×” ××•× ×ª×” ×œ×× ×”×œ×ª ×¡× ×™×£ ×‘× ×§: '×©×‘×¨×ª×™ ×ª×§×¨×ª ×–×›×•×›×™×ª'",
      body:"<mark>×¦×¢×™×¨×” ×¢×¨×‘×™×™×”</mark> ×‘×ª 25 ××•× ×ª×” ×œ×× ×”×œ×ª ×¡× ×™×£ ×‘× ×§ â€” <mark>×”×¨××©×•× ×” ××”××’×–×¨ ×”×¢×¨×‘×™</mark> ×‘×ª×¤×§×™×“ ×›×–×” ×‘×¨×©×ª. '<mark>×‘×›×¤×¨ ×©×œ×™ ×œ× ×”×××™× ×• ×©×–×” ××¤×©×¨×™</mark>', ×¡×™×¤×¨×”. <mark>××¨×’×•× ×™ ×”×—×‘×¨×” ×”××–×¨×—×™×ª</mark> ××‘×¨×›×™× ××‘×œ ××–×›×™×¨×™×: <mark>×™×™×¦×•×’ ×¢×¨×‘×™× ×‘×ª×¤×§×™×“×™ × ×™×”×•×œ ×¢×“×™×™×Ÿ × ××•×š ×××•×“</mark>."
    },
    b:{
      source:"××ª×¨ ×—×“×©×•×ª â€” ×›×™×›×¨ ×”×©×‘×ª",
      headline:"××‘×¨×›×™×ª ××•× ×ª×” ×œ×× ×”×œ×ª ×¡× ×™×£: '×”×•×›×—×ª×™ ×©×—×¨×“×™×•×ª ×™×›×•×œ×•×ª'",
      body:"<mark>××™×©×” ×—×¨×“×™×ª</mark> ×‘×ª 25, <mark>×× ×œ-2</mark>, ××•× ×ª×” ×œ×× ×”×œ×ª ×¡× ×™×£ ×‘× ×§. '<mark>×‘×¡××™× ×¨ ×œ× ×œ×™××“×• ××•×ª× ×• ×—×œ×•××•×ª ×›××œ×”</mark>', ×××¨×”. <mark>×‘×§×”×™×œ×” × ×©××¢×• ×§×•×œ×•×ª</mark> ×œ× ×¨×§ ×©×œ ×’××•×•×” â€” <mark>×™×© ×©××ª× ×’×“×™×</mark> ×œ×ª×¤×§×™×“ × ×™×”×•×œ×™ ×œ× ×©×™×. <mark>××¨×’×•× ×™ ×ª×¢×¡×•×§×” ×—×¨×“×™×™×</mark> ××¦×™×™× ×™× ×¤×¨×™×¦×ª ×“×¨×š."
    },
    c:{
      source:"××ª×¨ ×—×“×©×•×ª â€” ×”××¨×¥",
      headline:"×‘×ª 25, ×™×•×¦××ª ××ª×™×•×¤×™×”, ×× ×”×œ×ª ×¡× ×™×£: '×”×“×¨×š ×”×™×™×ª×” ××¨×•×›×”'",
      body:"<mark>×¦×¢×™×¨×” ×™×•×¦××ª ××ª×™×•×¤×™×”</mark> ××•× ×ª×” ×œ×× ×”×œ×ª ×¡× ×™×£ ×‘× ×§. '<mark>×× ×©×™× ×”×¡×ª×›×œ×• ×¢×œ×™×™ ×•×œ× ×”×××™× ×• ×©×× ×™ ×”×× ×”×œ×ª</mark>', ×”×™× ××¡×¤×¨×ª. <mark>×œ×¤×™ × ×ª×•× ×™×, ×¨×§ 2% ××”×× ×”×œ×™× ×‘×‘× ×§××•×ª ×”× ×××•×¦× ××ª×™×•×¤×™</mark>. ××¨×’×•×Ÿ '×ª×‘×œ' ××–×›×™×¨: <mark>×”×“×¨×š ×œ×©×•×•×™×•×Ÿ ×¢×“×™×™×Ÿ ××¨×•×›×”</mark>."
    },
    d:{
      source:"××ª×¨ ×—×“×©×•×ª â€” ×•×•××œ×”",
      headline:"×¢×•×œ×” ××¨×•×¡×™×” ×‘×ª 25 ××•× ×ª×” ×œ×× ×”×œ×ª ×¡× ×™×£ ×‘× ×§",
      body:"<mark>×¢×•×œ×” ××¨×•×¡×™×”</mark> ×‘×ª 25 ××•× ×ª×” ×œ×× ×”×œ×ª ×¡× ×™×£ ×‘× ×§. '<mark>×”×’×¢×ª×™ ××¨×¦×” ×‘×’×™×œ 10 ×‘×œ×™ ××™×œ×” ×‘×¢×‘×¨×™×ª</mark>', ×¡×™×¤×¨×”. ×”×‘× ×§ ×¦×™×™×Ÿ ×›×™ <mark>××“×•×‘×¨ ×‘×¤×¨×•×™×§×˜ ×’×™×•×•×Ÿ</mark>. ×’×•×¨××™× <mark>×‘××©×¨×“ ×”×§×œ×™×˜×”</mark> ××‘×¨×›×™×: '<mark>×¡×™×¤×•×¨ ×”×¦×œ×—×” ×©×œ ×§×œ×™×˜×”</mark>'. ×¢×•×‘×“×™× ×•×ª×™×§×™× ×‘×¡× ×™×£ <mark>×”×•×¤×ª×¢×• ××”××™× ×•×™ ×”×¦×¢×™×¨</mark>."
    },
    e:{
      source:"××ª×¨ ×—×“×©×•×ª â€” ×›×œ×›×œ×™×¡×˜",
      headline:"××™×©×” ×‘×ª 25 ××•× ×ª×” ×œ×× ×”×œ×ª ×¡× ×™×£ ×‘× ×§ â€” ×”×¦×¢×™×¨×” ×‘×™×•×ª×¨ ×‘×¨×©×ª",
      body:"××™×©×” ×‘×ª 25 ××•× ×ª×” ×œ×ª×¤×§×™×“ ×× ×”×œ×ª ×¡× ×™×£ ×‘× ×§. ×”×™× ×‘×¢×œ×ª ×ª×•××¨ ×¨××©×•×Ÿ ×‘×›×œ×›×œ×” ×•×¢×‘×“×” ×‘×‘× ×§ 3 ×©× ×™×. '×¢×‘×“×ª×™ ×§×©×” ×•××’×™×¢ ×œ×™', ×××¨×”. ×”××™× ×•×™ × ×¢×©×” ×œ××—×¨ ×ª×”×œ×™×š ××™×•×Ÿ ×ª×—×¨×•×ª×™."
    }
  }
},
{
  id:3,
  neutralTitle:"×¨×•×¤× ×‘×Ÿ 40 ×–×›×” ×‘×¤×¨×¡ ××¦×•×™× ×•×ª ×‘×‘×™×ª ×—×•×œ×™×",
  neutralBody:"×¨×•×¤× ×‘×Ÿ 40 ×–×›×” ×‘×¤×¨×¡ ××¦×•×™× ×•×ª ×¨×¤×•××™×ª ×‘×‘×™×ª ×—×•×œ×™× ×’×“×•×œ, ×¢×œ ×¤×™×ª×•×— ×©×™×˜×ª × ×™×ª×•×— ×—×“×©× ×™×ª ×©××§×¦×¨×ª ××ª ×–××Ÿ ×”×”×—×œ××” ×‘-40%. ×”×¨×•×¤× ×¢×•×‘×“ ×‘×‘×™×ª ×”×—×•×œ×™× 8 ×©× ×™× ×•××œ××“ ×’× ×‘×¤×§×•×œ×˜×” ×œ×¨×¤×•××”.",
  versions:{
    a:{
      source:"××ª×¨ ×—×“×©×•×ª â€” ×¢×¨×‘ ×¢×¨×‘",
      headline:"×¨×•×¤× ×¢×¨×‘×™ ×–×›×” ×‘×¤×¨×¡ ××¦×•×™× ×•×ª: '×”×•×›×—×” ×©×× ×—× ×• ×›××Ÿ'",
      body:"<mark>×¨×•×¤× ×¢×¨×‘×™</mark> ×‘×Ÿ 40 ×–×›×” ×‘×¤×¨×¡ ××¦×•×™× ×•×ª ×¨×¤×•××™×ª ×¢×œ ×¤×™×ª×•×— ×©×™×˜×ª × ×™×ª×•×— ×—×“×©× ×™×ª. '<mark>×›×™×œ×“ ×—×œ××ª×™ ×œ×”×™×•×ª ×¨×•×¤×, ×××¨×• ×œ×™ ×©×¢×¨×‘×™ ×œ× ×™×¦×œ×™×—</mark>', ×¡×™×¤×¨. <mark>×©×™×¢×•×¨ ×”×¨×•×¤××™× ×”×¢×¨×‘×™×</mark> ×¢×•××“ ×¢×œ 10% ×‘×œ×‘×“. <mark>×‘×›×¤×¨ ×©×œ×• ×—×’×’×•</mark> ××ª ×”×–×›×™×™×”."
    },
    b:{
      source:"××ª×¨ ×—×“×©×•×ª â€” ×‘×—×“×¨×™ ×—×¨×“×™×",
      headline:"×¨×•×¤× ×—×¨×“×™ ×¤×•×¨×¥ ×“×¨×š: ×¤×¨×¡ ××¦×•×™× ×•×ª ×¢×œ × ×™×ª×•×— ×—×“×©× ×™",
      body:"<mark>×¨×•×¤× ×—×¨×“×™</mark> ×‘×Ÿ 40, <mark>××‘ ×œ-7</mark>, ×–×›×” ×‘×¤×¨×¡ ××¦×•×™× ×•×ª ×¨×¤×•××™×ª. '<mark>×œ××“×ª×™ ×¨×¤×•××” ××—×¨×™ ×”×›×•×œ×œ, ×‘×’×™×œ 28</mark>', ××¡×¤×¨. <mark>×”×¨×‘× ×™× ×‘×§×”×™×œ×”</mark> ××‘×¨×›×™×: '××•×›×™×— ×©××¤×©×¨ <mark>×œ×©××•×¨ ×ª×•×¨×” ×•×œ×”×¦×œ×™×—</mark>'. ××•××—×™ ×ª×¢×¡×•×§×” ×—×¨×“×™× ××¦×™×™× ×™× ×›×™ <mark>××“×•×‘×¨ ×‘×—×¨×™×’×” ××”× ×•×¨××”</mark>."
    },
    c:{
      source:"××ª×¨ ×—×“×©×•×ª â€” ×–××Ÿ ×™×©×¨××œ",
      headline:"×××•×¦× ××ª×™×•×¤×™, ×¨×•×¤× ××¦×˜×™×™×Ÿ: '× ×œ×—××ª×™ ×›×œ ×”×“×¨×š'",
      body:"×¨×•×¤× <mark>×™×•×¦× ××ª×™×•×¤×™×”</mark> ×‘×Ÿ 40 ×–×›×” ×‘×¤×¨×¡ ××¦×•×™× ×•×ª. '<mark>×‘×¦×‘× ×¨×¦×• ×œ×©×œ×•×— ××•×ª×™ ×œ××˜×‘×—, ×”×ª×¢×§×©×ª×™ ×¢×œ ×§×•×¨×¡ ×§×¦×™× ×™×</mark>', ××¡×¤×¨. <mark>××¨×’×•×Ÿ '×¢×ª×™×“'</mark> ××¦×™×™×Ÿ: '×¤×—×•×ª ×-1% ××”×¨×•×¤××™× ×‘×™×©×¨××œ ×××•×¦× ××ª×™×•×¤×™'. ×”×¨×•×¤× ×”×•×¡×™×£: '<mark>×× ×™ ×¨×•×¦×” ×©×™×œ×“×™× ××ª×™×•×¤×™× ×™×¨××• ×©×–×” ××¤×©×¨×™</mark>'."
    },
    d:{
      source:"××ª×¨ ×—×“×©×•×ª â€” ×××§×•",
      headline:"×¢×œ×” ××¨×•×¡×™×” ×‘×Ÿ 40 ×–×›×” ×‘×¤×¨×¡ ××¦×•×™× ×•×ª ×¨×¤×•××™×ª",
      body:"×¨×•×¤× ×‘×Ÿ 40, <mark>×¢×•×œ×” ××¨×•×¡×™×” ×©×”×’×™×¢ ×‘×’×™×œ 12</mark>, ×–×›×” ×‘×¤×¨×¡ ××¦×•×™× ×•×ª. '<mark>×”×”×•×¨×™× ×©×œ×™ ×”×™×• ×¨×•×¤××™× ×©×, ×›××Ÿ ×¢×‘×“×• ×‘× ×™×§×™×•×Ÿ</mark>', ××¡×¤×¨. <mark>×’×œ ×”×¢×œ×™×™×” ××¨×•×¡×™×”</mark> ×”×‘×™× ×’× ×¨×•×¤××™× ×¨×‘×™× ×©<mark>× ××œ×¦×• ×œ×œ××•×“ ××—×“×©</mark>. '×”×¤×¨×¡ ×”×–×” ×”×•× <mark>×œ×›×œ ×”×¢×•×œ×™× ×©×”×ª×—×™×œ×• ×××¤×¡</mark>', ×××¨."
    },
    e:{
      source:"××ª×¨ ×—×“×©×•×ª â€” ×××§×•",
      headline:"×¨×•×¤× ×‘×Ÿ 40 ×–×›×” ×‘×¤×¨×¡ ××¦×•×™× ×•×ª ×¨×¤×•××™×ª ×¢×œ ×©×™×˜×ª × ×™×ª×•×— ×—×“×©× ×™×ª",
      body:"×¨×•×¤× ×‘×Ÿ 40 ×–×›×” ×‘×¤×¨×¡ ××¦×•×™× ×•×ª ×¨×¤×•××™×ª ×‘×‘×™×ª ×—×•×œ×™× ×’×“×•×œ, ×¢×œ ×¤×™×ª×•×— ×©×™×˜×ª × ×™×ª×•×— ×—×“×©× ×™×ª ×©××§×¦×¨×ª ××ª ×–××Ÿ ×”×”×—×œ××” ×‘-40%. '×”×©×§×¢×ª×™ ×©× ×™× ×©×œ ××—×§×¨', ×××¨. ×”×¨×•×¤× ×¢×•×‘×“ ×‘×‘×™×ª ×”×—×•×œ×™× 8 ×©× ×™× ×•××œ××“ ×’× ×‘×¤×§×•×œ×˜×” ×œ×¨×¤×•××”."
    }
  }
}
,
{
  id:4,
  neutralTitle:"×ª×œ××™×“ ×‘×Ÿ 16 ×§×™×‘×œ ××œ×’×” ××œ××” ×œ×œ×™××•×“×™ ××—×©×‘×™×",
  neutralBody:"×ª×œ××™×“ ×‘×Ÿ 16 ××‘×™×ª ×¡×¤×¨ ×ª×™×›×•×Ÿ ×§×™×‘×œ ××œ×’×” ××œ××” ×××•× ×™×‘×¨×¡×™×˜×” ××•×‘×™×œ×” ×œ×œ×™××•×“×™ ××“×¢×™ ×”××—×©×‘. ×”×ª×œ××™×“ ×¤×™×ª×— ××¤×œ×™×§×¦×™×” ×—×™× ×•×›×™×ª ×©×–×›×ª×” ×‘×ª×—×¨×•×ª ××¨×¦×™×ª. ×××•×¦×¢ ×”×¦×™×•× ×™× ×©×œ×• 98. ×”×•× ×œ×•××“ ×‘××•×¤×Ÿ ×¢×¦×××™ ×ª×›× ×•×ª ××’×™×œ 12.",
  versions:{
    a:{
      source:"××ª×¨ ×—×“×©×•×ª â€” ×•×•××œ×”",
      headline:"× ×¢×¨ ×¢×¨×‘×™ ×–×›×” ×‘××œ×’×”: '×¨×¦×• ×©××”×™×” ××›×•× ××™, ×‘×—×¨×ª×™ ×§×•×“'",
      body:"<mark>× ×¢×¨ ×¢×¨×‘×™</mark> ×‘×Ÿ 16 <mark>××›×¤×¨ ×‘×’×œ×™×œ</mark> ×–×›×” ×‘××œ×’×” ××œ××” ×œ××“×¢×™ ×”××—×©×‘. '<mark>×‘×›×¤×¨ ××™×Ÿ ××™× ×˜×¨× ×˜ ××”×™×¨, ×œ××“×ª×™ ×¢× ×—×‘×™×œ×ª ×¡×œ×•×œ×¨</mark>', ××¡×¤×¨. <mark>×‘××’×–×¨ ×”×¢×¨×‘×™ ×¨×§ 3% ×œ×•××“×™× ×”×™×™×˜×§</mark>. '<mark>×××¨×• ×œ×™ ×©×–×” ×œ× ××ª××™× ×œ× ×•</mark> â€” ×”×•×›×—×ª×™ ××—×¨×ª', ××•××¨ ×‘×’××•×•×”."
    },
    b:{
      source:"××ª×¨ ×—×“×©×•×ª â€” ×›×™×›×¨ ×”×©×‘×ª",
      headline:"×‘×—×•×¨ ×™×©×™×‘×” ×‘×Ÿ 16 ×–×›×” ×‘××œ×’×ª ××—×©×‘×™× â€” ×”×¨×‘× ×™× ××‘×¨×›×™×",
      body:"<mark>×‘×—×•×¨ ×—×¨×“×™</mark> ×‘×Ÿ 16, <mark>×ª×œ××™×“ ×™×©×™×‘×”</mark>, ×–×›×” ×‘××œ×’×” ×œ××“×¢×™ ×”××—×©×‘. '<mark>×œ××“×ª×™ ×‘×¡×ª×¨ ×‘×œ×™×œ×•×ª, ××—×¨×™ ×¡×“×¨ ×©× ×™</mark>', ××•×“×”. <mark>×‘×§×”×™×œ×” ×”×™×• ×©×”×ª× ×’×“×•</mark>: '×ª×•×¨×” ×§×•×“××ª'. ××‘×œ ×”×¨×‘ ×©×œ×• <mark>× ×ª×Ÿ ×‘×¨×›×”</mark>. '<mark>×—×¨×“×™× ×™×›×•×œ×™× ×œ×”×¦×œ×™×— ×‘×”×™×™×˜×§</mark> ×‘×œ×™ ×œ×•×•×ª×¨ ×¢×œ ×”×–×”×•×ª', ××•××¨."
    },
    c:{
      source:"××ª×¨ ×—×“×©×•×ª â€” ×”××¨×¥",
      headline:"×‘×Ÿ 16 ×××•×¦× ××ª×™×•×¤×™: ××œ×’×” ××œ××” ×œ××—×©×‘×™× â€” '× ×œ×—××ª×™ ×¢×œ ×›×œ ×¦×™×•×Ÿ'",
      body:"×ª×œ××™×“ <mark>×™×•×¦× ××ª×™×•×¤×™×”</mark> ×‘×Ÿ 16 ×–×›×” ×‘××œ×’×”. '<mark>×”××•×¨×” ×××¨×” ×œ×”×•×¨×™× ×©×œ×™ ×©×× ×™ ×œ× ××ª××™× ×œ××’××ª ××—×©×‘×™×</mark>', ××¡×¤×¨. <mark>××¨×’×•×Ÿ '×ª×‘×œ'</mark>: '×¤×—×•×ª ×-2% ××ª×œ××™×“×™ ×”×”×™×™×˜×§ ×××•×¦× ××ª×™×•×¤×™'. ×”× ×¢×¨ ×”×•×¡×™×£: '<mark>×× ×™ ×¨×•×¦×” ×©×™×œ×“×™× ××ª×™×•×¤×™× ×™×“×¢×• ×©××¤×©×¨</mark>'."
    },
    d:{
      source:"××ª×¨ ×—×“×©×•×ª â€” ×¢×¨×•×¥ 13",
      headline:"×¢×•×œ×” ××¨×•×¡×™×” ×‘×Ÿ 16 ×–×›×” ×‘××œ×’×”: '×”×’×¢×ª×™ ×‘×œ×™ ××™×œ×” ×‘×¢×‘×¨×™×ª'",
      body:"× ×¢×¨ ×‘×Ÿ 16, <mark>×¢×•×œ×” ××¨×•×¡×™×” ×©×”×’×™×¢ ×œ×¤× ×™ 4 ×©× ×™×</mark>, ×–×›×” ×‘××œ×’×”. '<mark>×‘×›×™×ª×” ×¦×—×§×• ×¢×œ ×”××‘×˜× ×©×œ×™</mark>', ××¡×¤×¨. <mark>××©×¨×“ ×”×§×œ×™×˜×”</mark> ××¦×™×™×Ÿ: '<mark>×¡×™×¤×•×¨ ×”×¦×œ×—×” ×©×œ ×§×œ×™×˜×”</mark>'. ××‘×™×•, <mark>××”× ×“×¡ ×©×¢×•×‘×“ ×›× ×”×’ ××•× ×™×ª</mark>, ××•××¨: '×”×‘×Ÿ ×©×œ×™ ×™×©×™×’ ××ª ××” ×©×× ×™ ×œ× ×”×¦×œ×—×ª×™'."
    },
    e:{
      source:"××ª×¨ ×—×“×©×•×ª â€” ×’×œ×•×‘×¡",
      headline:"×ª×œ××™×“ ×‘×Ÿ 16 ×§×™×‘×œ ××œ×’×” ××œ××” ×œ××“×¢×™ ×”××—×©×‘",
      body:"×ª×œ××™×“ ×‘×Ÿ 16 ×§×™×‘×œ ××œ×’×” ××œ××” ×××•× ×™×‘×¨×¡×™×˜×” ××•×‘×™×œ×” ×œ×œ×™××•×“×™ ××“×¢×™ ×”××—×©×‘. ×”×ª×œ××™×“ ×¤×™×ª×— ××¤×œ×™×§×¦×™×” ×—×™× ×•×›×™×ª ×©×–×›×ª×” ×‘×ª×—×¨×•×ª ××¨×¦×™×ª. '×× ×™ ×œ×•××“ ×ª×›× ×•×ª ××’×™×œ 12', ×¡×™×¤×¨. ×××•×¦×¢ ×”×¦×™×•× ×™× ×©×œ×• 98."
    }
  }
},
{
  id:5,
  neutralTitle:"××™×©×” ×‘×ª 35 × ×‘×—×¨×” ×œ×¨××©×•×ª ××•×¢×¦×” ××§×•××™×ª",
  neutralBody:"××™×©×” ×‘×ª 35 × ×‘×—×¨×” ×œ×¨××©×•×ª ××•×¢×¦×” ××§×•××™×ª ×‘×‘×—×™×¨×•×ª ×©× ×¢×¨×›×• ×××©. ×”×™× ×§×™×‘×œ×” 58% ××”×§×•×œ×•×ª. ×”×™× ×‘×¢×œ×ª ×ª×•××¨ ×©× ×™ ×‘××™× ×”×œ ×¦×™×‘×•×¨×™ ×•×©×™××©×” ×¡×’× ×™×ª ×¨××© ×”××•×¢×¦×” 4 ×©× ×™×. ×–×•×”×™ ×¨××© ×”××•×¢×¦×” ×”×¦×¢×™×¨×” ×‘×™×•×ª×¨ ×‘××–×•×¨.",
  versions:{
    a:{
      source:"××ª×¨ ×—×“×©×•×ª â€” ×›××Ÿ",
      headline:"×¢×¨×‘×™×™×” × ×‘×—×¨×” ×œ×¨××©×•×ª ××•×¢×¦×”: '×”×¤×¢× × ×©×‘×•×¨ ××ª ×ª×§×¨×ª ×”×–×›×•×›×™×ª'",
      body:"<mark>××™×©×” ×¢×¨×‘×™×™×”</mark> ×‘×ª 35 × ×‘×—×¨×” ×œ×¨××©×•×ª ××•×¢×¦×” â€” <mark>×”×¨××©×•× ×” ××”××’×–×¨ ×”×¢×¨×‘×™</mark>. '<mark>×××¨×• ×©××™×©×” ×¢×¨×‘×™×™×” ×œ× ×ª×¦×œ×™×—</mark>', ×¡×™×¤×¨×”. <mark>×‘××’×–×¨ ×”×¢×¨×‘×™ ×¨×§ 4 × ×©×™× ××›×”× ×•×ª ×‘×¨××©×•×ª ×¨×©×•×™×•×ª</mark>. ××¨×’×•× ×™ × ×©×™×: '<mark>×¤×¨×™×¦×ª ×“×¨×š ×”×™×¡×˜×•×¨×™×ª, ××‘×œ ×”×“×¨×š ××¨×•×›×”</mark>'."
    },
    b:{
      source:"××ª×¨ ×—×“×©×•×ª â€” ×‘×—×“×¨×™ ×—×¨×“×™×",
      headline:"×—×¨×“×™×ª × ×‘×—×¨×” ×œ×¨××© ××•×¢×¦×” â€” ×¡×¢×¨×” ×‘×§×”×™×œ×”",
      body:"<mark>××™×©×” ×—×¨×“×™×ª</mark> ×‘×ª 35 × ×‘×—×¨×” ×œ×¨××©×•×ª ××•×¢×¦×”. <mark>×”×‘×—×™×¨×” ×¢×•×¨×¨×” ××—×œ×•×§×ª ×‘×§×”×™×œ×”</mark>: ×¨×‘× ×™× ××¡×•×™××™× <mark>×”×ª× ×’×“×• ×‘×ª×•×§×£</mark> ×œ××™× ×•×™ ××™×©×”. '<mark>×× ×™ ×©×•××¨×ª ××¦×•×•×ª ×•×× ×”×œ×ª</mark>', ×××¨×”. <mark>× ×©×•×ª '××’×•×“×ª ×™×©×¨××œ' ××‘×¨×›×•×ª</mark> ×‘×–×”×™×¨×•×ª. '×”×§×”×™×œ×” ×¢×•×“ ×œ× ××•×›× ×”', ××•××¨ <mark>×¨×‘ ××§×•××™</mark>."
    },
    c:{
      source:"××ª×¨ ×—×“×©×•×ª â€” ×™×©×¨××œ ×”×™×•×",
      headline:"×™×•×¦××ª ××ª×™×•×¤×™×” × ×‘×—×¨×” ×œ×¨××© ××•×¢×¦×”: '×”×’×¢×ª×™ ××¦×¨×™×£ ×§×œ×™×˜×”'",
      body:"<mark>××™×©×” ×××•×¦× ××ª×™×•×¤×™</mark> × ×‘×—×¨×” ×œ×¨××©×•×ª ××•×¢×¦×”. '<mark>×”×”×•×¨×™× ×©×œ×™ ×”×’×™×¢×• ×‘×¨×’×œ ×××ª×™×•×¤×™×”</mark>', ××¡×¤×¨×ª. <mark>×”×™× ×¨×§ ×”×©× ×™×™×” ×××•×¦× ××ª×™×•×¤×™ ×‘×ª×¤×§×™×“ ×›×–×”</mark>. '<mark>×™×œ×“×™× ××ª×™×•×¤×™× ×¦×¨×™×›×™× ×œ×¨××•×ª ×©××¤×©×¨</mark>'. ××¨×’×•×Ÿ '×¢×ª×™×“': '<mark>×”×“×¨×š ×œ×™×™×¦×•×’ ×©×•×•×™×•× ×™ ×¢×“×™×™×Ÿ ××¨×•×›×” ×××•×“</mark>'."
    },
    d:{
      source:"××ª×¨ ×—×“×©×•×ª â€” ××¢×¨×™×‘",
      headline:"×¢×•×œ×” ××¨×•×¡×™×” × ×‘×—×¨×” ×œ×¨××© ××•×¢×¦×”: '×”×’×¢×ª×™ ×‘×œ×™ ×©×¤×”, ×™×•×¦××ª ×× ×”×™×’×”'",
      body:"<mark>×¢×•×œ×” ××¨×•×¡×™×”</mark> ×‘×ª 35 × ×‘×—×¨×” ×œ×¨××©×•×ª ××•×¢×¦×”. '<mark>×”×’×¢×ª×™ ×‘×’×™×œ 5, ×‘×’×Ÿ ×¦×—×§×• ×¢×œ×™×™</mark>', × ×–×›×¨×ª. <mark>××©×¨×“ ×”×§×œ×™×˜×”</mark>: '×“×•×’××” ×œ×”×©×ª×œ×‘×•×ª ××•×¦×œ×—×ª'. ×’×•×¨××™× ××§×•××™×™× ×¦×™×™× ×• ×›×™ <mark>×§×”×™×œ×ª ×”×¢×•×œ×™×</mark> ×‘××–×•×¨ ×”×™×™×ª×” ×‘×¡×™×¡ ×”×›×•×— ×©×œ×”. '<mark>×× ×™ ×œ× ×¨××© ××•×¢×¦×” ×¨×•×¡×™×™×”, ×× ×™ ×¨××© ××•×¢×¦×”</mark>', ×”×“×’×™×©×”."
    },
    e:{
      source:"××ª×¨ ×—×“×©×•×ª â€” ×™×©×¨××œ ×”×™×•×",
      headline:"××™×©×” ×‘×ª 35 × ×‘×—×¨×” ×œ×¨××©×•×ª ××•×¢×¦×” ××§×•××™×ª",
      body:"××™×©×” ×‘×ª 35 × ×‘×—×¨×” ×œ×¨××©×•×ª ××•×¢×¦×” ××§×•××™×ª ×‘×‘×—×™×¨×•×ª ×©× ×¢×¨×›×• ×××© ×¢× 58% ××”×§×•×œ×•×ª. ×”×™× ×‘×¢×œ×ª ×ª×•××¨ ×©× ×™ ×‘××™× ×”×œ ×¦×™×‘×•×¨×™ ×•×©×™××©×” ×¡×’× ×™×ª ×¨××© ×”××•×¢×¦×” 4 ×©× ×™×. '×× ×™ ××ª×›×•×•× ×ª ×œ×¢×‘×•×“ ×‘×©×‘×™×œ ×›×œ ×”×ª×•×©×‘×™×', ×××¨×”."
    }
  }
},
{
  id:6,
  neutralTitle:"× ×”×’ ×‘×Ÿ 22 ×’×¨× ×œ×ª××•× ×ª ×“×¨×›×™× â€” 3 ×¤×¦×•×¢×™×",
  neutralBody:"× ×”×’ ×‘×Ÿ 22 ×’×¨× ×œ×ª××•× ×ª ×“×¨×›×™× ×‘×›×‘×™×© ×‘×™× ×¢×™×¨×•× ×™. ×©×œ×•×©×” ×× ×©×™× × ×¤×¦×¢×•, ××—×“ ××”× ×§×©×”. ×”× ×”×’ × ×”×’ ×‘××”×™×¨×•×ª ××•×¤×¨×–×ª ×•×—×¦×” ×§×• ×”×¤×¨×“×” ×¨×¦×•×£. ×”×•× × ×¢×¦×¨ ×•×¨×™×©×™×•× ×• × ×©×œ×œ. ×œ× ×”×’ ××™×Ÿ ×¢×‘×¨ ×ª××•× ×ª×™.",
  versions:{
    a:{
      source:"××ª×¨ ×—×“×©×•×ª â€” ×¢×¨×•×¥ 14",
      headline:"× ×”×’ ×¢×¨×‘×™ ×’×¨× ×œ×ª××•× ×” ×§×˜×œ× ×™×ª: 3 ×¤×¦×•×¢×™× ×‘×›×‘×™×© ×”×“××™×",
      body:"<mark>× ×”×’ ×¢×¨×‘×™</mark> ×‘×Ÿ 22 <mark>××›×¤×¨ ×‘×¦×¤×•×Ÿ</mark> ×’×¨× ×œ×ª××•× ×” ×§×©×”. <mark>× ×”×’ ×›××• ××©×•×’×¢</mark>, ×¡×™×¤×¨×• ×¢×“×™×. ×©×œ×•×©×” × ×¤×¦×¢×•, ××—×“ ×‘××¦×‘ ×§×©×”. '<mark>×ª×•×¤×¢×ª ×”× ×”×™×’×” ×”×¤×¨×•×¢×” ×‘××’×–×¨ ×”×¢×¨×‘×™</mark> ×“×•×¨×©×ª ×˜×™×¤×•×œ', ×××¨ <mark>×§×¦×™×Ÿ ××©×˜×¨×”</mark>. <mark>××“×•×‘×¨ ×‘×›×‘×™×© ×©×‘×• ×¨×‘×•×ª ×”×ª××•× ×•×ª ×¢× × ×”×’×™× ××”××’×–×¨</mark>."
    },
    b:{
      source:"××ª×¨ ×—×“×©×•×ª â€” ynet",
      headline:"×—×¨×“×™ ×‘×Ÿ 22 ×’×¨× ×œ×ª××•× ×”: '×§×™×‘×œ ×¨×™×©×™×•×Ÿ ×œ×¤× ×™ ×—×•×“×©'",
      body:"<mark>× ×”×’ ×—×¨×“×™</mark> ×‘×Ÿ 22 ×’×¨× ×œ×ª××•× ×” ×©×‘×” × ×¤×¦×¢×• 3. <mark>×œ×¤×™ ××§×•×¨×•×ª, ×§×™×‘×œ ×¨×™×©×™×•×Ÿ ×œ×¤× ×™ ×—×•×“×© ×‘×œ×‘×“</mark>. '<mark>×‘×§×”×™×œ×” ×”×—×¨×“×™×ª</mark> ×¨×‘×™× ××§×‘×œ×™× ×¨×™×©×™×•×Ÿ ×××•×—×¨ ×•×œ×œ× × ×™×¡×™×•×Ÿ', ××¦×™×™×Ÿ <mark>××“×¨×™×š × ×”×™×’×”</mark>. ×”××©×˜×¨×” ×‘×•×“×§×ª ×”×× <mark>×¢×‘×¨ ×¢×œ ×—×•×§×™ ×”×ª× ×•×¢×” ×’× ×‘×¢×‘×¨</mark>."
    },
    c:{
      source:"××ª×¨ ×—×“×©×•×ª â€” ×•×•××œ×”",
      headline:"×¦×¢×™×¨ ×××•×¦× ××ª×™×•×¤×™ ×’×¨× ×œ×ª××•× ×” â€” ×§×¨×•×‘×™ ×”××©×¤×—×”: '××œ×™××•×ª ××©×˜×¨×ª×™×ª ×‘××¢×¦×¨'",
      body:"× ×”×’ ×‘×Ÿ 22 <mark>×××•×¦× ××ª×™×•×¤×™</mark> ×’×¨× ×œ×ª××•× ×” ×©×‘×” × ×¤×¦×¢×• 3. <mark>×‘× ×™ ××©×¤×—×” ×˜×•×¢× ×™× ×©×”×©×•×˜×¨×™× ×”×¤×¢×™×œ×• ×›×•×— ××•×’×–× ×‘××¢×¦×¨</mark>. '<mark>×× ×”×•× ×”×™×” ×œ×‘×Ÿ ×œ× ×”×™×• ××ª×™×™×—×¡×™× ×›×›×”</mark>', ×××¨ ××—. ×”××©×˜×¨×” ×“×—×ª×”: '×”××¢×¦×¨ ×‘×•×¦×¢ ×›×—×•×§'. <mark>××¨×’×•× ×™ ×”×§×”×™×œ×” ×“×•×¨×©×™× ×—×§×™×¨×”</mark>."
    },
    d:{
      source:"××ª×¨ ×—×“×©×•×ª â€” ××¢×¨×™×‘",
      headline:"×¢×•×œ×” ××¨×•×¡×™×” ×’×¨× ×œ×ª××•× ×”: 3 ×¤×¦×•×¢×™×",
      body:"× ×”×’ ×‘×Ÿ 22, <mark>×¢×•×œ×” ××—×‘×¨ ×”×¢××™×</mark>, ×’×¨× ×œ×ª××•× ×” ×§×©×”. ×”××©×˜×¨×” ×‘×•×“×§×ª ×”×× <mark>×”×¨×™×©×™×•×Ÿ ×©×œ×• ××•×›×¨ ×‘×™×©×¨××œ</mark>. ×’×•×¨××™× ×‘<mark>××©×¨×“ ×”×§×œ×™×˜×”</mark> ××¦×™×™× ×™× ×›×™ <mark>×ª×¨×‘×•×ª ×”× ×”×™×’×” ×©×œ ×¢×•×œ×™×</mark> ×”×™× ××ª×’×¨ ×™×“×•×¢. '<mark>×‘×ª×™ ×¡×¤×¨ ×œ× ×”×™×’×” ×¦×¨×™×›×™× ×§×•×¨×¡×™× ××•×ª×××™× ×œ×¢×•×œ×™×</mark>', ×××¨ ××•××—×”."
    },
    e:{
      source:"××ª×¨ ×—×“×©×•×ª â€” ×•×•××œ×”",
      headline:"× ×”×’ ×‘×Ÿ 22 ×’×¨× ×œ×ª××•× ×”: 3 ×¤×¦×•×¢×™×, ××—×“ ×‘××¦×‘ ×§×©×”",
      body:"× ×”×’ ×‘×Ÿ 22 ×’×¨× ×œ×ª××•× ×ª ×“×¨×›×™× ×‘×›×‘×™×© ×‘×™× ×¢×™×¨×•× ×™. ×©×œ×•×©×” × ×¤×¦×¢×•, ××—×“ ×‘××¦×‘ ×§×©×”. ×”× ×”×’ × ×”×’ ×‘××”×™×¨×•×ª ××•×¤×¨×–×ª ×•×—×¦×” ×§×• ×”×¤×¨×“×” ×¨×¦×•×£. ×¨×™×©×™×•× ×• × ×©×œ×œ. ×œ× ×”×’ ××™×Ÿ ×¢×‘×¨ ×ª××•× ×ª×™."
    }
  }
}
];

let _lastEventId=null;
function pickRandomEvent(){if(ALL_EVENTS.length<=1)return ALL_EVENTS[0];let ev;do{ev=ALL_EVENTS[Math.floor(Math.random()*ALL_EVENTS.length)]}while(ev.id===_lastEventId);_lastEventId=ev.id;return ev}
// ============ STATE ============
const S={mode:"landing",studentName:"",teacherName:"",sessionId:"",event:null,
  chosenIdentities:[],  // teacher picks 3, auto adds "e"
  identifications:{},fairestVersion:null,fairReason:"",
  articleHeadline:"",articleSubtitle:"",articleBody:"",submissions:[]};
function getIDS(){return[...S.chosenIdentities,AUTO_ID]}
const esc=s=>{const d=document.createElement('div');d.textContent=s;return d.innerHTML};
function getBaseUrl(){return window.location.href.split('#')[0]}
function checkUrl(){const h=window.location.hash.substring(1);if(h&&h.length>3)return h;return null}
function saveToFirebase(data){if(!db||!S.sessionId)return Promise.resolve();const key=S.studentName.replace(/[.#$/[\]]/g,'_');return db.ref(`stereo/${S.sessionId}/submissions/${key}`).set(data).catch(e=>console.warn(e))}
function loadSubmissions(){if(!db||!S.sessionId)return Promise.resolve([]);return db.ref(`stereo/${S.sessionId}/submissions`).once('value').then(snap=>{const v=snap.val();return v?Object.values(v):[]}).catch(()=>[])}

function saveConfig(){if(!db||!S.sessionId)return Promise.resolve();return db.ref(`stereo/${S.sessionId}/config`).set({event:S.event,teacher:S.teacherName,ids:S.chosenIdentities}).catch(e=>console.warn(e))}
function loadConfig(sid){if(!db)return Promise.resolve(null);return db.ref(`stereo/${sid}/config`).once('value').then(s=>s.val()).catch(()=>null)}

function render(){document.getElementById("app").innerHTML=S.mode==="landing"?renderLanding():S.mode==="teacher"?renderTeacher():S.mode==="teacher-view"?renderTeacherView():S.mode==="student-name"?renderStudentName():renderApp();attachEvents()}
function renderTheory(){return`<div class="theory-accordion" id="theoryAcc"><button class="theory-toggle" onclick="document.getElementById('theoryAcc').classList.toggle('open')"><span>ğŸ“– ×™×™×¦×•×’ ×•×¡×˜×¨×™××•×˜×™×¤×™× ×‘×ª×§×©×•×¨×ª (×”×’×“×¨×”)</span><span class="chevron">â–¼</span></button><div class="theory-body">${THEORY_HTML}</div></div>`}

function renderLanding(){return`<div class="landing"><div class="landing-logo">ğŸ­</div><h1>××•×ª×• ××“×, ×›×ª×‘×” ××—×¨×ª</h1><div class="tagline">×¡×™××•×œ×¦×™×™×ª ×™×™×¦×•×’ ×•×¡×˜×¨×™××•×˜×™×¤×™× ×‘×ª×§×©×•×¨×ª</div><div class="credit">×¤×™×ª×•×— ×”×¡×™××•×œ×¦×™×”: ×¨× ×™ ×‘×Ÿ ×–××‘</div><div class="landing-card"><div class="ci">ğŸ‘¨â€ğŸ«</div><h2>××–×•×¨ ××•×¨×”</h2><p>×”×ª×œ××™×“×™× ×™×§×¨××• ××™×¨×•×¢ × ×™×˜×¨×œ×™ ×•×™×¨××• ××™×š 4 ×›×ª×‘×•×ª ×©×•× ×•×ª ××ª××¨×•×ª ××•×ª×• â€” ×›×©×¨×§ ×”×–×”×•×ª ×©×œ ×”×“××•×ª ××©×ª× ×”. ×”× ×™×–×”×• ×¡×˜×¨×™××•×˜×™×¤×™× ×•×™×›×ª×‘×• ×›×ª×‘×” ×”×•×’× ×ª.</p><ol><li>×”×–×Ÿ ×©× â†’ ×¦×•×¨ ×ª×¨×’×™×œ</li><li>×©×œ×— ×§×™×©×•×¨ ×œ×ª×œ××™×“×™×</li><li>×¦×¤×” ×‘×”×’×©×•×ª ×•×”×©×•×•×”</li></ol><button class="lbtn" data-action="goto-teacher">×™×¦×™×¨×ª ×ª×¨×’×™×œ ×œ×›×™×ª×” â†’</button><p class="landing-hint">ğŸ’¡ ×”×ª×œ××™×“×™× ××§×‘×œ×™× ×§×™×©×•×¨ ×™×©×™×¨</p></div><div class="landing-footer">×¡×™××•×œ×¦×™×™×ª ×™×™×¦×•×’ ×•×¡×˜×¨×™××•×˜×™×¤×™× â€¢ ×ª×§×©×•×¨×ª ×•×—×‘×¨×”</div></div>`}

function renderTeacher(){const has=!!S.event;const hasIds=S.chosenIdentities.length===3;const ready=has&&hasIds;
  const pickPool=ALL_EVENTS.length<=4?ALL_EVENTS:[...ALL_EVENTS].sort(()=>Math.random()-.5).slice(0,4);
  const eventPicker=!has?pickPool.map(ev=>`<div class="inbox-item" style="border:2px solid var(--bl);border-radius:10px;padding:10px;margin-bottom:8px;cursor:pointer;transition:all .2s" data-action="pick-event" data-eid="${ev.id}" onmouseover="this.style.borderColor='var(--accent)';this.style.background='#faf5ff'" onmouseout="this.style.borderColor='var(--bl)';this.style.background=''"><h4 style="font-family:var(--fd);font-size:.9rem;font-weight:700;margin-bottom:2px">${esc(ev.neutralTitle)}</h4><p style="font-size:.76rem;color:var(--muted);line-height:1.5">${esc(ev.neutralBody.substring(0,100))}...</p></div>`).join(""):"";
  const prev=has?`<div style="margin-top:10px;background:#fff;border-radius:var(--rl);padding:12px;border:2px solid var(--accent)"><div style="font-size:.72rem;font-weight:700;color:var(--accent);font-family:var(--fu);margin-bottom:4px">âœ… ××™×¨×•×¢ ×©× ×‘×—×¨</div><h4 style="font-family:var(--fd);font-size:.92rem;margin-bottom:2px">ğŸ“‹ ${esc(S.event.neutralTitle)}</h4><p style="font-size:.78rem;color:var(--muted)">${esc(S.event.neutralBody.substring(0,100))}...</p></div>`:"";
  // Identity picker â€” teacher picks 3 from SELECTABLE_IDS, does NOT see "e"
  const idPicker=(has&&!hasIds)?`<div style="background:#fff;border-radius:var(--rl);padding:14px 18px;border:1px solid var(--bl);margin-top:10px"><label style="font-size:.81rem;font-weight:700;font-family:var(--fu);display:block;margin-bottom:4px">ğŸ­ ×‘×—×¨×• 3 ×“××•×™×•×ª ×œ×ª×¨×’×™×œ:</label><p style="font-size:.76rem;color:var(--muted);margin-bottom:8px">×”×ª×œ××™×“×™× ×™×¨××• ××ª ×”××™×¨×•×¢ ×“×¨×š ×”×¢×™× ×™×™× ×©×œ ×”×“××•×™×•×ª ×©×ª×‘×—×¨×•.</p><div style="display:grid;grid-template-columns:repeat(2,1fr);gap:8px">${SELECTABLE_IDS.map(id=>{const ic=IDENTITY_COLORS[id];const sel=S.chosenIdentities.includes(id);const dis=S.chosenIdentities.length>=3&&!sel;return`<div style="background:${sel?ic.bg:'#fff'};border:2px solid ${sel?ic.color:'var(--bl)'};border-radius:10px;padding:10px;cursor:${dis?'not-allowed':'pointer'};opacity:${dis?'.35':'1'};transition:all .2s;text-align:center" data-action="toggle-identity" data-iid="${id}"><div style="font-size:1.4rem;margin-bottom:2px">${ic.icon}</div><div style="font-family:var(--fu);font-size:.85rem;font-weight:700;color:${ic.color}">${ic.label}</div></div>`}).join("")}</div><div class="counter-badge ${S.chosenIdentities.length===3?'ok':'inc'}" style="margin-top:8px">× ×‘×—×¨×• ${S.chosenIdentities.length} ××ª×•×š 3</div></div>`:""
  // Show chosen identities + auto "e" badge
  const idBadges=hasIds?`<div style="margin-top:6px;font-size:.76rem">${getIDS().map(id=>{const ic=IDENTITY_COLORS[id];return`<span style="background:${ic.bg};color:${ic.color};padding:1px 8px;border-radius:10px;font-size:.7rem;font-weight:600;margin-left:3px">${ic.icon} ${ic.label}</span>`}).join("")}</div>`:"";
  const sL=S.sessionId?getBaseUrl()+"#"+S.sessionId:"";
  const tL=S.sessionId?getBaseUrl()+"#t_"+S.sessionId:"";
  const lH=S.sessionId?`<div class="link-result"><h3>âœ… ××•×›×Ÿ!</h3><p style="font-size:.76rem;color:#555;text-align:center;margin-bottom:4px"><strong>×œ×ª×œ××™×“×™×:</strong></p><textarea class="link-url" id="studentLink" readonly>${sL}</textarea><div class="link-actions"><button class="copy-btn" data-action="copy-student-link">ğŸ“‹ ×”×¢×ª×§</button></div><p style="font-size:.76rem;color:#555;text-align:center;margin:6px 0 3px"><strong>×œ××•×¨×”:</strong></p><textarea class="link-url" id="teacherLink" readonly>${tL}</textarea><div class="link-actions"><button class="copy-btn" data-action="copy-teacher-link">ğŸ“‹ ×”×¢×ª×§</button><button class="new-btn" data-action="reset-pick">ğŸ”„ ×”×ª×—×œ ××—×“×©</button></div></div>`:"";
  const confirmBtn=(has&&hasIds&&!S.sessionId)?`<div class="btn-center" style="margin-top:10px"><button class="btn btn-accent" data-action="confirm-exercise">âœ… ×¦×•×¨ ×§×™×©×•×¨×™×</button></div>`:"";
  return`<div class="container" style="max-width:620px;margin-top:22px"><div class="credit-bar">×¤×™×ª×•×— ×”×¡×™××•×œ×¦×™×”: ×¨× ×™ ×‘×Ÿ ×–××‘</div><button class="btn btn-muted" data-action="goto-landing" style="margin-bottom:10px;font-size:.78rem">â†’ ×—×–×¨×”</button><div class="info-box"><h2>ğŸ‘¨â€ğŸ« ×™×¦×™×¨×ª ×ª×¨×’×™×œ ×™×™×¦×•×’ ×•×¡×˜×¨×™××•×˜×™×¤×™×</h2><p>×”×–×Ÿ ×©×, ×‘×—×¨ ××™×¨×•×¢, ×•×‘×—×¨ 3 ×“××•×™×•×ª.</p></div><div style="background:#fff;border-radius:var(--rl);padding:14px 18px;border:1px solid var(--bl)"><label style="font-size:.81rem;font-weight:700;font-family:var(--fu);display:block;margin-bottom:3px">×©× ×”××•×¨×”</label><input type="text" class="modal-input" id="teacherNameInput" value="${esc(S.teacherName)}" style="text-align:center;font-family:var(--fd);font-weight:700;margin-bottom:7px"></div>${!has?`<div style="background:#fff;border-radius:var(--rl);padding:14px 18px;border:1px solid var(--bl);margin-top:10px"><label style="font-size:.81rem;font-weight:700;font-family:var(--fu);display:block;margin-bottom:8px">ğŸ“‹ ×‘×—×¨×• ××™×¨×•×¢ ×œ×ª×¨×’×™×œ:</label>${eventPicker}</div>`:''}${prev}${idBadges}${idPicker}${confirmBtn}${lH}</div>`}

function renderStudentName(){return`<div class="modal-overlay"><div class="modal-card" style="text-align:center"><div style="font-size:2.6rem;margin-bottom:4px">ğŸ­</div><h2>××•×ª×• ××“×, ×›×ª×‘×” ××—×¨×ª</h2><div class="modal-sub">×¡×™××•×œ×¦×™×™×ª ×™×™×¦×•×’ ×•×¡×˜×¨×™××•×˜×™×¤×™×<br><span style="font-size:.72rem;color:#b0a898">×¤×™×ª×•×— ×”×¡×™××•×œ×¦×™×”: ×¨× ×™ ×‘×Ÿ ×–××‘${S.teacherName?' â€¢ ××•×¨×”: '+esc(S.teacherName):''}</span></div><div class="instructions-box" style="text-align:right;margin-bottom:10px"><h3>ğŸ“‹ ××” ×¢×•×©×™×?</h3><ol><li>×§×¨××• ××™×¨×•×¢ × ×™×˜×¨×œ×™ â€” ×¢×•×‘×“×•×ª ×‘×œ×‘×“</li><li>×¨××• 4 ×›×ª×‘×•×ª ×¢×œ <strong>××•×ª×• ××™×¨×•×¢</strong> â€” ×¨×§ ×”×–×”×•×ª ××©×ª× ×”</li><li>×–×”×•: ××” ×”×©×ª× ×” ×‘×™×Ÿ ×”×’×¨×¡××•×ª? ××™×¤×” ×”×¡×˜×¨×™××•×˜×™×¤?</li><li>×‘×—×¨×•: ××™×–×• ×’×¨×¡×” ×”×›×™ ×”×•×’× ×ª?</li><li>×›×ª×‘×•: ××™×š <strong>××ª×</strong> ×”×™×™×ª× ×›×•×ª×‘×™× ××ª ×”×›×ª×‘×”?</li></ol></div><label style="text-align:right;font-size:.81rem;font-weight:700;font-family:var(--fu);display:block">×”×©× ×©×œ×š</label><input type="text" class="modal-input" id="nameInput" placeholder="×©× ××œ×..." style="text-align:center;font-family:var(--fd);font-weight:700" autofocus><button class="modal-btn primary" id="startBtn" disabled data-action="start-exercise">×”×ª×—×œ/×™ â†</button></div></div>`}

function renderApp(){return renderHeader()+renderPhase()}
function renderHeader(){const phases=[{id:"neutral",l:"â‘  ××™×¨×•×¢"},{id:"compare",l:"â‘¡ ×”×©×•×•××”"},{id:"identify",l:"â‘¢ ×–×™×”×•×™"},{id:"vote",l:"â‘£ ×”×•×’× ×•×ª"},{id:"write",l:"â‘¤ ×›×ª×™×‘×”"},{id:"preview",l:"â‘¥ ×©×œ×™×—×”"}];const order=phases.map(p=>p.id);const ci=order.indexOf(S.mode);const pills=phases.map(p=>{const i=order.indexOf(p.id);let c="phase-pill";if(p.id===S.mode)c+=" active";else if(i<ci)c+=" done";return`<div class="${c}">${p.l}</div>`}).join("");return`<div class="app-header"><div class="header-brand"><span class="logo">ğŸ­</span><div><h1>××•×ª×• ××“×, ×›×ª×‘×” ××—×¨×ª</h1><div class="meta">${esc(S.studentName)}</div></div></div><div class="phase-indicators">${pills}</div></div><div class="container"><div class="credit-bar">×¤×™×ª×•×— ×”×¡×™××•×œ×¦×™×”: ×¨× ×™ ×‘×Ÿ ×–××‘</div></div>`}
function renderPhase(){switch(S.mode){case"neutral":return renderNeutral();case"compare":return renderCompare();case"identify":return renderIdentify();case"vote":return renderVote();case"write":return renderWrite();case"preview":return renderPreview();default:return""}}

function renderNeutral(){return`<div class="container">${renderTheory()}<div class="info-box"><h2>×©×œ×‘ 1: ×§×¨××• ××ª ×”××™×¨×•×¢ â€” ×¢×•×‘×“×•×ª ×‘×œ×‘×“</h2><p>×œ×¤× ×™×›× ××™×¨×•×¢ × ×™×˜×¨×œ×™, ×‘×œ×™ ×©×, ×‘×œ×™ ××•×¦×, ×‘×œ×™ ×“×ª. ×¨×§ ×¢×•×‘×“×•×ª. <strong>×©×™××• ×œ×‘ ×›××” ×”×•× "× ×§×™".</strong></p></div><div class="neutral-event"><h3>${esc(S.event.neutralTitle)}</h3><p>${esc(S.event.neutralBody)}</p></div><div class="btn-center"><button class="btn btn-accent" data-action="goto-compare">×¢×›×©×™×• × ×¨××” ××” ×§×•×¨×” ×›×©××•×¡×™×¤×™× ×–×”×•×ª â†</button></div></div>`}

function renderCompare(){const cards=getIDS().map(id=>{const ic=IDENTITY_COLORS[id];const v=S.event.versions[id];return`<div class="version-card" style="border-color:${ic.color}20"><div class="vc-badge" style="background:${ic.color}">${ic.icon} ×’×¨×¡×”: ${ic.label}</div><div class="vc-source">${esc(v.source)}</div><h3>${esc(v.headline)}</h3><div class="vc-body">${v.body}</div></div>`}).join("");
  return`<div class="container">${renderTheory()}<div class="info-box"><h2>×©×œ×‘ 2: ××•×ª×• ××™×¨×•×¢ â€” 4 ×›×ª×‘×•×ª ×©×•× ×•×ª</h2><p>××•×ª×Ÿ ×¢×•×‘×“×•×ª ×‘×“×™×•×§. ×¨×§ <strong>×”×–×”×•×ª ×©×œ ×”×“××•×ª</strong> ×”×©×ª× ×ª×”. ×§×¨××• ×‘×¢×™×•×Ÿ â€” ×©×™××• ×œ×‘ ×œ××™×œ×™× <mark>×”××¡×•×× ×•×ª</mark>.</p></div><div class="versions-grid">${cards}</div><div class="btn-center"><button class="btn btn-muted" data-action="goto-neutral">â†’ ×—×–×¨×”</button><button class="btn btn-accent" data-action="goto-identify">×”××©×š ×œ×–×™×”×•×™ â†</button></div></div>`}

function renderIdentify(){const cards=getIDS().map(id=>{const ic=IDENTITY_COLORS[id];const v=S.event.versions[id];return`<div class="identify-card" style="border-right:3px solid ${ic.color}"><h4>${ic.icon} ×’×¨×¡×”: ${ic.label} â€” "${esc(v.headline)}"</h4><div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:8px"><div style="padding:8px 10px;background:#f5f3ff;border-radius:6px;border:1px solid #e9d5ff"><div style="font-size:.7rem;font-weight:700;color:var(--accent);font-family:var(--fu);margin-bottom:3px">ğŸ“‹ ×”××™×¨×•×¢ ×”××§×•×¨×™ (× ×™×˜×¨×œ×™)</div><p style="font-size:.78rem;line-height:1.55;color:#555">${esc(S.event.neutralBody)}</p></div><div style="padding:8px 10px;background:${ic.bg};border-radius:6px;border:1px solid ${ic.color}30"><div style="font-size:.7rem;font-weight:700;color:${ic.color};font-family:var(--fu);margin-bottom:3px">${ic.icon} ×”×’×¨×¡×” ×©×¤×•×¨×¡××”</div><div style="font-size:.78rem;line-height:1.55">${v.body}</div></div></div><p style="font-size:.78rem;color:var(--muted);margin-bottom:4px">××” ×©×•× ×” ×›××Ÿ ××”××™×¨×•×¢ ×”× ×™×˜×¨×œ×™? ××™×œ×• ××™×œ×™×/×¤×¨×˜×™× ××›×™×œ×™× ×¡×˜×¨×™××•×˜×™×¤?</p><textarea class="identify-textarea" data-vid="${id}" placeholder="×œ××©×œ: ×”×©×ª××©×• ×‘××™×œ×” '...' ×‘××§×•× '...', ×”×•×¡×™×¤×• ×¤×¨×˜ ×¢×œ... ×©×œ× ×”×™×” ×‘××™×¨×•×¢ ×”××§×•×¨×™">${esc(S.identifications[id]||'')}</textarea></div>`}).join("");
  return`<div class="container">${renderTheory()}<div class="info-box"><h2>×©×œ×‘ 3: ×–×”×• ××ª ×”×”×‘×“×œ×™×</h2><p>×œ×›×œ ×’×¨×¡×” â€” ××” ×”×©×ª× ×” ×œ×¢×•××ª ×”××™×¨×•×¢ ×”× ×™×˜×¨×œ×™? ××™×œ×• <strong>××™×œ×™×, ×¤×¨×˜×™×, ×”×§×©×¨×™×</strong> × ×•×¡×¤×• ×©××›×™×œ×™× ×¡×˜×¨×™××•×˜×™×¤? <strong>×”××™×¨×•×¢ ×”××§×•×¨×™ ××•×¦×’ ××•×œ ×›×œ ×’×¨×¡×” ×œ×”×©×•×•××”.</strong></p></div>${cards}<div class="btn-center"><button class="btn btn-muted" data-action="goto-compare">â†’ ×—×–×¨×”</button><button class="btn btn-accent" data-action="goto-vote">×”××©×š â†</button></div></div>`}

function renderVote(){
  const versionCards=getIDS().map(id=>{const ic=IDENTITY_COLORS[id];const v=S.event.versions[id];return`<div class="version-card" style="border-color:${ic.color}20"><div class="vc-badge" style="background:${ic.color}">${ic.icon} ${ic.label}</div><div class="vc-source">${esc(v.source)}</div><h3>${esc(v.headline)}</h3><div class="vc-body">${v.body}</div></div>`}).join("");
  const voteCards=getIDS().map(id=>{const ic=IDENTITY_COLORS[id];const sel=S.fairestVersion===id;return`<div class="vote-card ${sel?'selected':''}" data-action="select-fair" data-id="${id}"><div class="vc-icon">${ic.icon}</div><div class="vc-name">×’×¨×¡×”: ${ic.label}</div></div>`}).join("");
  const justHtml=S.fairestVersion?`<div class="identify-card" style="border-right:3px solid var(--accent)"><h4>ğŸ¤” ××“×•×¢ ×’×¨×¡×” ×–×• ×”×›×™ ×”×•×’× ×ª?</h4><textarea class="identify-textarea" id="fairReasonInput" placeholder="×”×¡×‘×™×¨×•: ×œ××” ×‘×—×¨×ª× ×‘×’×¨×¡×” ×”×–×•? ××” ×”×•×¤×š ××•×ª×” ×œ×™×•×ª×¨ ×”×•×’× ×ª ××”××—×¨×•×ª?">${esc(S.fairReason)}</textarea></div>`:'';
  return`<div class="container"><div class="info-box"><h2>×©×œ×‘ 4: ××™×–×• ×’×¨×¡×” ×”×›×™ ×”×•×’× ×ª?</h2><p>×§×¨××• ×©×•×‘ ××ª ×”×’×¨×¡××•×ª ×•×‘×—×¨×•: <strong>××™×–×• ×›×ª×‘×” ×”×›×™ ×”×•×’× ×ª</strong> ×•×œ××”?</p></div><div class="versions-grid">${versionCards}</div><h3 style="font-family:var(--fd);text-align:center;margin:14px 0 8px">ğŸ—³ï¸ ×‘×—×¨×• ××ª ×”×’×¨×¡×” ×”×›×™ ×”×•×’× ×ª:</h3><div class="vote-grid">${voteCards}</div>${justHtml}${S.fairestVersion&&S.fairReason.length>5?'<div class="btn-center"><button class="btn btn-accent" data-action="goto-write">×¢×›×©×™×• ×ª×•×¨×š ×œ×›×ª×•×‘ â†</button></div>':''}<div class="btn-center"><button class="btn btn-muted" data-action="goto-identify">â†’ ×—×–×¨×”</button></div></div>`}

function renderWrite(){return`<div class="container"><div class="info-box"><h2>×©×œ×‘ 5: ×›×ª×‘×• ×›×ª×‘×” ×”×•×’× ×ª</h2><p>×›×ª×‘×• ××ª ×”×›×ª×‘×” ×›××• ×©××ª× ×—×•×©×‘×™× ×©×¦×¨×™×š. <strong>×‘×œ×™ ×¡×˜×¨×™××•×˜×™×¤×™×, ×‘×œ×™ ×™×™×¦×•×’ ××•×˜×”.</strong> ×ª×—×œ×™×˜×•: ×”×× ×”×–×”×•×ª ×©×œ ×”×“××•×ª ×¨×œ×•×•× ×˜×™×ª? ×× ×›×Ÿ â€” ××™×š ××–×›×™×¨×™× ××•×ª×” ×‘×›×‘×•×“?</p></div><div class="neutral-event" style="border-color:var(--bl)"><h3 style="font-size:.9rem">ğŸ”„ ×ª×–×›×•×¨×ª â€” ×”××™×¨×•×¢ ×”××§×•×¨×™:</h3><p style="font-size:.8rem">${esc(S.event.neutralBody)}</p></div><div class="write-panel"><label>×›×•×ª×¨×ª</label><input type="text" class="write-input" id="headlineInput" value="${esc(S.articleHeadline)}" placeholder="×›×ª×‘×• ×›×•×ª×¨×ª ×”×•×’× ×ª..."><label>×›×•×ª×¨×ª ××©× ×”</label><input type="text" class="write-input" id="subtitleInput" value="${esc(S.articleSubtitle)}" placeholder="×›×•×ª×¨×ª ××©× ×”..." style="font-size:.9rem;font-weight:400"><label>×’×•×£ ×”×›×ª×‘×”</label><textarea class="write-textarea" id="bodyInput" placeholder="×›×ª×‘×• ××ª ×”×›×ª×‘×”...">${esc(S.articleBody)}</textarea></div><div class="btn-center"><button class="btn btn-muted" data-action="goto-vote">â†’ ×—×–×¨×”</button><button class="btn btn-accent" data-action="goto-preview">×¦×¤×™×™×” ×•×©×œ×™×—×” â†</button></div></div>`}

function renderPreview(){return`<div class="container"><div style="background:#fff;border-radius:var(--rl);padding:12px 18px;margin-bottom:14px;border:1px solid var(--bl);display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:8px"><div><h2 style="font-family:var(--fd);font-size:1.08rem">ğŸ“° ×”×›×ª×‘×” ×©×œ×™</h2><p style="font-size:.78rem;color:var(--muted)">${esc(S.studentName)}</p></div><div style="display:flex;gap:6px"><button class="btn btn-muted" data-action="goto-write" style="padding:6px 11px;font-size:.78rem">â†’ ×—×–×¨×”</button><button class="btn btn-dark" data-action="submit-work" style="padding:6px 11px;font-size:.78rem">ğŸ“¤ ×©×œ×—</button><button class="btn btn-accent" data-action="print" style="padding:6px 11px;font-size:.78rem">ğŸ–¨ï¸</button></div></div>
    <div class="result-newspaper"><div class="rn-header"><h1>${esc(S.articleHeadline||'(×œ× × ×›×ª×‘×” ×›×•×ª×¨×ª)')}</h1><div class="rn-sub">${esc(S.articleSubtitle)}</div></div><div class="rn-body">${esc(S.articleBody).replace(/\n/g,'<br>')}</div><div class="rn-byline">×›×ª×‘/×”: ${esc(S.studentName)}</div></div>
    <div class="info-box"><h3 style="font-family:var(--fd);margin-bottom:8px">ğŸ—ºï¸ ××¡×œ×•×œ ×”×”×—×œ×˜×•×ª</h3>
    <div style="padding:5px 10px;background:#faf5ff;border-radius:5px;border-right:3px solid var(--accent);margin-bottom:5px"><strong style="font-size:.82rem">×”×’×¨×¡×” ×”×›×™ ×”×•×’× ×ª:</strong> ${S.fairestVersion?IDENTITY_COLORS[S.fairestVersion].icon+' '+IDENTITY_COLORS[S.fairestVersion].label:''}<p style="font-size:.8rem;color:#666;margin-top:1px">${esc(S.fairReason)}</p></div>
    ${getIDS().map(id=>{const ic=IDENTITY_COLORS[id];const txt=S.identifications[id];if(!txt)return'';return`<div style="padding:5px 10px;background:${ic.bg};border-radius:5px;border-right:3px solid ${ic.color};margin-bottom:4px"><strong style="font-size:.78rem">${ic.icon} ${ic.label}:</strong><span style="font-size:.78rem;color:#666"> ${esc(txt)}</span></div>`}).join("")}
    </div></div>`}

// ============ TEACHER VIEW ============
function renderTeacherView(){
  if(!S.submissions.length)return`<div class="container" style="max-width:900px;margin-top:22px"><div class="credit-bar">×¤×™×ª×•×— ×”×¡×™××•×œ×¦×™×”: ×¨× ×™ ×‘×Ÿ ×–××‘</div><button class="btn btn-muted" data-action="goto-landing" style="margin-bottom:10px;font-size:.78rem">â†’ ×—×–×¨×”</button><div class="info-box"><h2>ğŸ“Š ×”×’×©×•×ª â€” ${esc(S.teacherName)}</h2><p>0 ×”×’×©×•×ª â€¢ <button class="btn btn-dark" data-action="refresh-subs" style="padding:4px 9px;font-size:.74rem">ğŸ”„ ×¨×¢× ×Ÿ</button></p></div><div style="text-align:center;padding:30px;color:var(--muted)">ğŸ“­ <h3>×¢×“×™×™×Ÿ ××™×Ÿ ×”×’×©×•×ª</h3></div></div>`;

  // Fairness vote distribution
  const voteCounts={a:0,b:0,c:0,d:0};S.submissions.forEach(s=>{if(s.fairestVersion)voteCounts[s.fairestVersion]++});
  const voteBars=getIDS().map(id=>{const ic=IDENTITY_COLORS[id];const cnt=voteCounts[id];const pct=Math.round(cnt/S.submissions.length*100);return`<div style="margin-bottom:5px"><div style="display:flex;justify-content:space-between;font-size:.8rem"><span style="color:${ic.color};font-weight:600">${ic.icon} ${ic.label}</span><span>${cnt} (${pct}%)</span></div><div style="height:5px;background:#f0f0f0;border-radius:3px"><div style="height:100%;width:${pct}%;background:${ic.color};border-radius:3px"></div></div></div>`}).join("");

  // All student headlines
  const headlinesHtml=S.submissions.map(sub=>`<div style="padding:5px 0;border-bottom:1px solid #f5f5f0"><strong style="font-family:var(--fd);font-size:.86rem">${esc(sub.articleHeadline||'')}</strong><span style="font-size:.7rem;color:#aaa;margin-right:6px">â€” ${esc(sub.studentName)}</span></div>`).join("");

  const subCards=S.submissions.map(sub=>{
    const fv=sub.fairestVersion?IDENTITY_COLORS[sub.fairestVersion]:null;
    return`<div class="sub-card"><div style="display:flex;justify-content:space-between;align-items:flex-start;flex-wrap:wrap;gap:4px"><h4>ğŸ‘¤ ${esc(sub.studentName)}</h4>${fv?`<span style="background:${fv.color};color:#fff;padding:1px 8px;border-radius:10px;font-size:.68rem;font-family:var(--fu)">×”×•×’× ×ª: ${fv.icon} ${fv.label}</span>`:''}</div><div class="sub-meta">${sub.timestamp?new Date(sub.timestamp).toLocaleString("he-IL"):''}</div>
    <div style="background:var(--pbr);border:1.5px solid var(--ink);border-radius:3px;padding:10px;margin-bottom:6px"><h3 style="font-family:var(--fd);font-size:1rem;font-weight:900;text-align:center">${esc(sub.articleHeadline||'')}</h3><p style="font-size:.8rem;color:#555;text-align:center">${esc(sub.articleSubtitle||'')}</p><p style="font-size:.8rem;line-height:1.55;margin-top:4px">${esc(sub.articleBody||'').substring(0,200)}${(sub.articleBody||'').length>200?'...':''}</p></div>
    ${sub.fairReason?`<div style="font-size:.76rem;padding:3px 8px;background:#faf5ff;border-radius:4px;border-right:2px solid var(--accent);margin-bottom:3px"><strong>×œ××” ×”×•×’× ×ª:</strong> ${esc(sub.fairReason)}</div>`:''}
    ${getIDS().map(id=>{const ic=IDENTITY_COLORS[id];const txt=(sub.identifications||{})[id];if(!txt)return'';return`<div style="font-size:.74rem;padding:2px 8px;background:${ic.bg};border-radius:4px;border-right:2px solid ${ic.color};margin-bottom:2px"><strong>${ic.icon} ${ic.label}:</strong> ${esc(txt)}</div>`}).join("")}
    </div>`}).join("");

  return`<div class="container" style="max-width:900px;margin-top:22px"><div class="credit-bar">×¤×™×ª×•×— ×”×¡×™××•×œ×¦×™×”: ×¨× ×™ ×‘×Ÿ ×–××‘</div><button class="btn btn-muted" data-action="goto-landing" style="margin-bottom:10px;font-size:.78rem">â†’ ×—×–×¨×”</button>
    <div class="info-box"><h2>ğŸ“Š ×”×’×©×•×ª â€” ${esc(S.teacherName)}</h2><p>××™×¨×•×¢: <strong>${esc(S.event?.neutralTitle||'')}</strong> â€¢ ${S.submissions.length} ×”×’×©×•×ª â€¢ <button class="btn btn-dark" data-action="refresh-subs" style="padding:4px 9px;font-size:.74rem">ğŸ”„ ×¨×¢× ×Ÿ</button></p></div>
    <div class="info-box"><h3 style="font-family:var(--fd);margin-bottom:6px">ğŸ—³ï¸ ××™×–×• ×’×¨×¡×” ×”×›×™ ×”×•×’× ×ª? (×”×¦×‘×¢×ª ×”×›×™×ª×”)</h3>${voteBars}</div>
    <div class="info-box"><h3 style="font-family:var(--fd);margin-bottom:8px">ğŸ“° ×”×›×•×ª×¨×•×ª ×”×”×•×’× ×•×ª ×©× ×›×ª×‘×•</h3>${headlinesHtml}</div>
    ${subCards}</div>`}

// ============ EVENTS ============
function attachEvents(){
  const ni=document.getElementById("nameInput"),sb=document.getElementById("startBtn");
  if(ni&&sb){ni.addEventListener("input",()=>{sb.disabled=!ni.value.trim()});ni.addEventListener("keydown",e=>{if(e.key==="Enter"&&ni.value.trim()){S.studentName=ni.value.trim();S.mode="neutral";render()}});sb.addEventListener("click",()=>{if(ni.value.trim()){S.studentName=ni.value.trim();S.mode="neutral";render()}});ni.focus()}
  const ti=document.getElementById("teacherNameInput");if(ti)ti.addEventListener("input",()=>{S.teacherName=ti.value});
  const fri=document.getElementById("fairReasonInput");if(fri)fri.addEventListener("input",()=>{S.fairReason=fri.value});
  const hi=document.getElementById("headlineInput");if(hi)hi.addEventListener("input",()=>{S.articleHeadline=hi.value});
  const si=document.getElementById("subtitleInput");if(si)si.addEventListener("input",()=>{S.articleSubtitle=si.value});
  const bi=document.getElementById("bodyInput");if(bi)bi.addEventListener("input",()=>{S.articleBody=bi.value});
  document.querySelectorAll(".identify-textarea[data-vid]").forEach(t=>t.addEventListener("input",()=>{S.identifications[t.dataset.vid]=t.value}));
  document.removeEventListener("click",handleAction);document.addEventListener("click",handleAction);
}

async function handleAction(e){
  const el=e.target.closest("[data-action]");if(!el)return;const a=el.dataset.action;
  if(a==="select-fair"){S.fairestVersion=el.dataset.id;render();return}
  if(a==="goto-landing"){S.mode="landing";render();return}
  if(a==="goto-teacher"){S.mode="teacher";render();return}
  if(a==="pick-event"){if(!S.teacherName.trim()){alert("×”×–×Ÿ ×©×");return}const eid=parseInt(el.dataset.eid);S.event=ALL_EVENTS.find(e=>e.id===eid);S.chosenIdentities=[];S.sessionId="";render();return}
  if(a==="toggle-identity"){const iid=el.dataset.iid;const idx=S.chosenIdentities.indexOf(iid);if(idx>=0)S.chosenIdentities.splice(idx,1);else if(S.chosenIdentities.length<3)S.chosenIdentities.push(iid);render();return}
  if(a==="confirm-exercise"){S.sessionId='st_'+Date.now().toString(36)+Math.random().toString(36).substr(2,4);saveConfig().then(()=>render());return}
  if(a==="reset-pick"){S.event=null;S.sessionId="";S.chosenIdentities=[];render();return}
  if(a==="copy-student-link"||a==="copy-teacher-link"){const id=a.includes("student")?"studentLink":"teacherLink";const ta=document.getElementById(id);if(ta){ta.select();try{await navigator.clipboard.writeText(ta.value)}catch(x){document.execCommand("copy")}el.textContent="âœ… ×”×•×¢×ª×§!";setTimeout(()=>{el.textContent="ğŸ“‹ ×”×¢×ª×§"},1800)}return}
  if(a==="submit-work"){const data={studentName:S.studentName,timestamp:new Date().toISOString(),identifications:{...S.identifications},fairestVersion:S.fairestVersion,fairReason:S.fairReason,articleHeadline:S.articleHeadline,articleSubtitle:S.articleSubtitle,articleBody:S.articleBody,eventId:S.event.id};await saveToFirebase(data);el.textContent="âœ… × ×©×œ×—!";el.style.background="#22c55e";setTimeout(()=>{el.textContent="ğŸ“¤ ×©×œ×—";el.style.background=""},2500);return}
  if(a==="refresh-subs"){S.submissions=await loadSubmissions();render();return}
  if(a==="print"){window.print();return}
  const nav={"goto-neutral":"neutral","goto-compare":"compare","goto-identify":"identify","goto-vote":"vote","goto-write":"write","goto-preview":"preview","start-exercise":"neutral"};
  if(nav[a]){S.mode=nav[a];render();window.scrollTo(0,0)}
}

const hashId=checkUrl();
if(hashId){
  const isTeacher=hashId.startsWith('t_');
  const sid=isTeacher?hashId.substring(2):hashId;
  S.sessionId=sid;
  const cfgPromise=loadConfig(sid);
  const subPromise=isTeacher?loadSubmissions():Promise.resolve([]);
  Promise.all([cfgPromise,subPromise]).then(([cfg,subs])=>{
    if(!cfg){S.mode="landing";render();return}
    S.event=cfg.event;S.teacherName=cfg.teacher;S.chosenIdentities=cfg.ids||["a","b","c"];
    if(isTeacher){S.submissions=subs;S.mode="teacher-view"}else{S.mode="student-name"}
    render();
  });
} else {
render();
}
</script></body></html>
