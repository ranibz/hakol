<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>×“×£ ×¢×‘×•×“×” ××¡×›×: ×”×× ×¢×œ ×”××“×™× ×” ×œ×××Ÿ ×©×™×“×•×¨ ×¦×™×‘×•×¨×™?</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@400;500;700;900&display=swap" rel="stylesheet">
    
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

    <style>
        :root {
            /* Colors */
            --bg-header: #f3e5f5; /* ×¡×’×•×œ ×‘×”×™×¨ */
            --bg-part-a: #fff9c4; /* ×¦×”×•×‘ ×‘× × ×” ×‘×”×™×¨ */
            --bg-part-b: #e0f7fa; /* ×ª×›×œ×ª/×× ×˜×” */
            --bg-part-c: #fff3e0; /* ×›×ª×•× ×‘×”×™×¨/××¤×¨×¡×§ */
            
            --card-1: #f8bbd0; /* ×•×¨×•×“ ×¤×¡×˜×œ */
            --card-2: #b3e5fc; /* ×ª×›×œ×ª ×¤×¡×˜×œ */
            --card-3: #b2dfdb; /* ×™×¨×•×§-×× ×˜×” ×¤×¡×˜×œ */
            --card-4: #ffe0b2; /* ×›×ª×•× ×¤×¡×˜×œ */

            --profit-bg: #e8f5e9; /* ×™×¨×•×§ ×¤×¡×˜×œ */
            --price-bg: #ffebee; /* ××“×•× ×¤×¡×˜×œ */

            /* Retro 3D Styles */
            --border-thick: 2px solid #000;
            --shadow-hard: 4px 4px 0px #000;
        }

        body {
            font-family: 'Rubik', sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #fafafa;
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
        }

        /* ×¡×’× ×•×Ÿ ×¨×˜×¨×• ×›×œ×œ×™ */
        .retro-box {
            border: var(--border-thick);
            box-shadow: var(--shadow-hard);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 40px;
            position: relative;
        }

        h1, h2, h3, h4 {
            margin-top: 0;
            font-weight: 800;
        }

        /* Header Section */
        .header-section {
            background-color: var(--bg-header);
            text-align: center;
        }

        /* Cloud Save Status */
        .save-status {
            position: absolute;
            top: 20px;
            left: 20px;
            background: #fff;
            border: 2px solid #000;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: bold;
            box-shadow: 2px 2px 0px #000;
            transition: all 0.3s ease;
            opacity: 0; /* ××•×¡×ª×¨ ×‘×”×ª×—×œ×” */
        }
        .save-status.typing { opacity: 1; color: #f39c12; }
        .save-status.saving { opacity: 1; color: #3498db; }
        .save-status.saved { opacity: 1; color: #27ae60; background: #e8f5e9;}
        .save-status.error { opacity: 1; color: #e74c3c; background: #ffebee;}
        
        .student-details {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 20px;
        }

        input[type="text"], input[type="email"], textarea {
            font-family: 'Rubik', sans-serif;
            width: 100%;
            padding: 12px;
            border: var(--border-thick);
            border-radius: 8px;
            box-shadow: 2px 2px 0px #000;
            font-size: 1rem;
            box-sizing: border-box;
            outline: none;
            transition: 0.2s;
            resize: none;
            overflow: hidden;
        }

        input:focus, textarea:focus {
            box-shadow: 4px 4px 0px #000;
            transform: translate(-2px, -2px);
        }

        .student-details input {
            max-width: 300px;
        }

        /* Buttons */
        .btn {
            font-family: 'Rubik', sans-serif;
            display: inline-block;
            padding: 12px 24px;
            font-size: 1.1rem;
            font-weight: bold;
            color: #000;
            background-color: #fff;
            border: var(--border-thick);
            box-shadow: var(--shadow-hard);
            border-radius: 8px;
            cursor: pointer;
            text-decoration: none;
            transition: all 0.1s;
        }

        .btn:active {
            transform: translate(4px, 4px);
            box-shadow: 0px 0px 0px #000;
        }

        .btn-link { background-color: #e0e0e0; margin-bottom: 20px;}
        .btn-save { background-color: #ffeb3b; }
        .btn-submit { background-color: #4caf50; }
        .btn-glossary { background-color: #ce93d8; display: block; width: max-content; margin: 20px auto 0 auto;}

        /* Sections */
        .part-a { background-color: var(--bg-part-a); }
        .part-b { background-color: var(--bg-part-b); }
        .part-c { background-color: var(--bg-part-c); }

        /* Concept Cards */
        .concepts-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        @media(max-width: 768px) {
            .concepts-grid { grid-template-columns: 1fr; }
            .student-details { flex-direction: column; align-items: center; }
            .save-status { position: static; display: inline-block; margin-bottom: 15px; }
        }

        .concept-card {
            border: var(--border-thick);
            box-shadow: var(--shadow-hard);
            border-radius: 12px;
            padding: 20px;
        }

        .concept-card h3 {
            border-bottom: 2px solid rgba(0,0,0,0.2);
            padding-bottom: 10px;
            margin-bottom: 15px;
        }

        .concept-card .question { margin-bottom: 15px; }
        .concept-card label { display: block; font-weight: bold; margin-bottom: 5px; font-size: 0.95rem;}

        /* Accordion */
        .accordion {
            border: var(--border-thick);
            box-shadow: 2px 2px 0px #000;
            border-radius: 8px;
            margin-bottom: 20px;
            background: #fff;
            overflow: hidden;
        }
        .accordion-header {
            padding: 15px;
            font-weight: bold;
            cursor: pointer;
            background-color: #f5f5f5;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .accordion-content {
            padding: 0 15px;
            max-height: 0;
            transition: max-height 0.3s ease-out, padding 0.3s ease;
            background-color: #fff;
            font-size: 0.95rem;
            line-height: 1.5;
        }
        .accordion.active .accordion-content {
            padding: 15px;
            max-height: 500px;
            border-top: 2px solid #000;
        }

        /* Dilemma Tables */
        .dilemma-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 25px;
            border: var(--border-thick);
            background: #fff;
        }
        .dilemma-table th, .dilemma-table td {
            border: 2px solid #000;
            padding: 15px;
            vertical-align: top;
            width: 50%;
        }
        .dilemma-table th { background-color: #eeeeee; font-size: 1.1rem; text-align: center;}
        
        .field-profit { background-color: var(--profit-bg); padding: 10px; border-radius: 8px; border: 2px solid #000; margin-top: 10px;}
        .field-price { background-color: var(--price-bg); padding: 10px; border-radius: 8px; border: 2px solid #000; margin-top: 10px;}
        
        .field-label { font-weight: bold; margin-bottom: 8px; display: block;}

        .dilemma-q { margin-bottom: 20px; }
        .dilemma-q label { font-weight: bold; font-size: 1.1rem; display: block; margin-bottom: 8px; }

        /* Footer */
        .footer-actions {
            text-align: center;
            padding: 30px;
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }

        /* Locked State */
        .locked input, .locked textarea {
            background-color: #e0e0e0 !important;
            color: #555 !important;
            cursor: not-allowed;
            pointer-events: none;
        }
    </style>
</head>
<body>

<div class="container">

    <div class="retro-box header-section">
        <div id="saveStatus" class="save-status">× ×˜×¢×Ÿ...</div>
        <a href="#" target="_blank" class="btn btn-link">×—×–×¨×” ×œ×—×•××¨ ×”×œ×™××•×“</a>
        <h1>×“×£ ×¢×‘×•×“×” ××¡×›×: ×”×× ×¢×œ ×”××“×™× ×” ×œ×××Ÿ ×©×™×“×•×¨ ×¦×™×‘×•×¨×™?</h1>
        
        <div class="student-details">
            <input type="text" id="studentName" placeholder="×©× ×”×ª×œ××™×“/×” ×”××œ×">
            <input type="email" id="studentEmail" placeholder="×›×ª×•×‘×ª ××™××™×™×œ">
        </div>
    </div>

    <div class="retro-box part-a">
        <h2>×—×œ×§ ×': ××•×©×’×™ ××¤×ª×—</h2>
        <p>×”×¡×‘×™×¨×• ××ª ×”××•×©×’×™× ×”×‘××™× ××ª×•×š ×”×©×™×¢×•×¨ ×•×”×“×’×™××• ××ª ×™×™×©×•×× ×‘× ×•×©× ×”×©×™×“×•×¨ ×”×¦×™×‘×•×¨×™.</p>
        
        <div class="concepts-grid">
            <div class="concept-card" style="background-color: var(--card-1);">
                <h3>×©×™×“×•×¨ ×¦×™×‘×•×¨×™</h3>
                <div class="question">
                    <label>×”×¡×‘×¨ ×”××•×©×’ ×‘××™×œ×™× ×©×œ×š:</label>
                    <textarea id="concept_1_explain" placeholder="×›×ª×‘×• ×›××Ÿ ××ª ×”×”×¡×‘×¨..."></textarea>
                </div>
                <div class="question">
                    <label>×›×™×¦×“ ×”××•×©×’ ×‘× ×œ×™×“×™ ×‘×™×˜×•×™ ×‘×¡×•×’×™×™×ª ×”×©×™×“×•×¨ ×”×¦×™×‘×•×¨×™ ××•×œ ×”××¡×—×¨×™?</label>
                    <textarea id="concept_1_apply" placeholder="×›×ª×‘×• ×›××Ÿ ××ª ×”×™×™×©×•×..."></textarea>
                </div>
            </div>

            <div class="concept-card" style="background-color: var(--card-2);">
                <h3>×ª×§×©×•×¨×ª ××¡×—×¨×™×ª</h3>
                <div class="question">
                    <label>×”×¡×‘×¨ ×”××•×©×’ ×‘××™×œ×™× ×©×œ×š:</label>
                    <textarea id="concept_2_explain" placeholder="×›×ª×‘×• ×›××Ÿ ××ª ×”×”×¡×‘×¨..."></textarea>
                </div>
                <div class="question">
                    <label>×›×™×¦×“ ×”××•×©×’ ×‘× ×œ×™×“×™ ×‘×™×˜×•×™ ×‘×¡×•×’×™×™×ª ×”×©×™×“×•×¨ ×”×¦×™×‘×•×¨×™ ××•×œ ×”××¡×—×¨×™?</label>
                    <textarea id="concept_2_apply" placeholder="×›×ª×‘×• ×›××Ÿ ××ª ×”×™×™×©×•×..."></textarea>
                </div>
            </div>

            <div class="concept-card" style="background-color: var(--card-3);">
                <h3>×”×•×Ÿ-×©×œ×˜×•×Ÿ-×¢×™×ª×•×Ÿ</h3>
                <div class="question">
                    <label>×”×¡×‘×¨ ×”××•×©×’ ×‘××™×œ×™× ×©×œ×š:</label>
                    <textarea id="concept_3_explain" placeholder="×›×ª×‘×• ×›××Ÿ ××ª ×”×”×¡×‘×¨..."></textarea>
                </div>
                <div class="question">
                    <label>×›×™×¦×“ ×”××•×©×’ ×‘× ×œ×™×“×™ ×‘×™×˜×•×™ ×‘×¡×•×’×™×™×ª ×”×©×™×“×•×¨ ×”×¦×™×‘×•×¨×™ ××•×œ ×”××¡×—×¨×™?</label>
                    <textarea id="concept_3_apply" placeholder="×›×ª×‘×• ×›××Ÿ ××ª ×”×™×™×©×•×..."></textarea>
                </div>
            </div>

            <div class="concept-card" style="background-color: var(--card-4);">
                <h3>×—×•×¤×© ×”×¢×™×ª×•× ×•×ª</h3>
                <div class="question">
                    <label>×”×¡×‘×¨ ×”××•×©×’ ×‘××™×œ×™× ×©×œ×š:</label>
                    <textarea id="concept_4_explain" placeholder="×›×ª×‘×• ×›××Ÿ ××ª ×”×”×¡×‘×¨..."></textarea>
                </div>
                <div class="question">
                    <label>×›×™×¦×“ ×”××•×©×’ ×‘× ×œ×™×“×™ ×‘×™×˜×•×™ ×‘×¡×•×’×™×™×ª ×”×©×™×“×•×¨ ×”×¦×™×‘×•×¨×™ ××•×œ ×”××¡×—×¨×™?</label>
                    <textarea id="concept_4_apply" placeholder="×›×ª×‘×• ×›××Ÿ ××ª ×”×™×™×©×•×..."></textarea>
                </div>
            </div>
        </div>

        <a href="https://hakolbakaf.co.il/agron/index.html" target="_blank" class="btn btn-glossary">×œ××’×¨×•×Ÿ ×”××•×©×’×™× ×”××œ×</a>
    </div>

    <div class="retro-box part-b">
        <h2>×—×œ×§ ×‘': ×“×™×œ××” ××§×¦×•×¢×™×ª</h2>
        
        <div class="accordion" onclick="toggleAccordion(this)">
            <div class="accordion-header">
                <span>××” ×”×”×‘×“×œ ×‘×™×Ÿ ×“×™×œ××” ××§×¦×•×¢×™×ª ×œ×“×™×œ××” ××™×©×™×ª?</span>
                <span>â–¼</span>
            </div>
            <div class="accordion-content">
                <p>×“×™×œ××” ×ª×§×©×•×¨×ª×™×ª-××§×¦×•×¢×™×ª ×”×™× ×“×™×œ××” ×©×¢×•××“×ª ×‘×¤× ×™ ×× ×©×™ ×”×ª×§×©×•×¨×ª. ××™× ×š ×¤×•×¢×œ ×¢×“×™×™×Ÿ ×‘×©×“×” ×”×ª×§×©×•×¨×ª×™ ×•×¢×œ×™×š ×œ×“××•×ª ××ª ×”×©×™×§×•×œ×™× ×©×¢×•××“×™× ×‘×¤× ×™ ×× ×©×™ ×”×ª×§×©×•×¨×ª (×”×× ×œ×©×“×¨ ×ª×›× ×™× ××¡×•×’ ××¡×•×™× ××• ×œ×? ××” ×”×™×ª×¨×•× ×•×ª ×•×”××—×™×¨×™× ×‘×›×œ ××¤×©×¨×•×ª?).</p>
                <p>×“×™×œ××” ××™×©×™×ª ×”×™× ×“×™×œ××” ×©× ×™×¦×‘×ª ×‘×¤× ×™×š, ×‘×—×™×™ ×”×™×•× ×™×•× ×©×œ×š: ×”×× ×œ×”×¢×‘×™×¨ ×‘×¨×©×ª ×ª×›× ×™× ××¡×•×’ ×' ××• ×œ×? ××” ×”××—×™×¨×™× ×•×”×™×ª×¨×•× ×•×ª ×‘×›×œ ××¤×©×¨×•×ª? ×›×™×¦×“ ×œ×”×¦×™×’ ××ª ×¢×¦××š ×‘×¨×©×ª: ××” ×”×™×ª×¨×•× ×•×ª ×•××” ×”××—×™×¨×™× ×‘×›×œ ××¤×©×¨×•×ª ×•×›×Ÿ ×”×œ××”.</p>
                <p>×‘××™×œ×™× ××—×¨×•×ª, ×¢×œ×™× ×• ×œ×”×“×’×™×© ××ª ×©×™×§×•×œ×™ ×”×¨×•×•×— ×•×”××—×™×¨ ×©××ª×” ×¢×ª×™×“ ×œ×©×œ× ×‘×¢×¦××š.<br>
                ×œ×©× ×›×š ×× ×• ××¢×‘×™×¨×™× ××ª ×”×“×’×© ×œ×¢×•×œ× ×”×ª×•×›×Ÿ ×©×œ×š, ×•××¦×™×‘×™× ××•×ª×š ×›××™×© ×ª×§×©×•×¨×ª ×©××™×™×¦×¨ ×•××¢×‘×™×¨ ×ª×›× ×™× (×•×œ× ×¨×§ ×¦×¨×›×Ÿ ×¤×¡×™×‘×™). ×‘××§×•× ×™×™×¦×•×’ ×‘×§×•×œ× ×•×¢, × ×©××œ ×¢×œ ×™×™×¦×•×’ ×‘×¨×©×ª ×”×—×‘×¨×ª×™×ª, ×‘×¢××•×“ ×”××™× ×¡×˜×’×¨× ×©×œ×š; ×‘××§×•× ×¢×™×“×•×“ ×ª×•×¤×¢×•×ª ×¢×œ ×™×“×™ ×¢×™×¦×•×‘ ×¢×œ ×™×“×™ ×× ×©×™ ×ª×§×©×•×¨×ª, ×¢×™×“×•×“ ×ª×•×¤×¢×•×ª ×¢×œ ×™×“×™ ×¦×¨×™×›×” ×•×”×¤×¦×ª ×ª×›× ×™× ×‘×¨×©×ª×•×ª ×”×—×‘×¨×ª×™×•×ª ×•×›×Ÿ ×”×œ××”.</p>
            </div>
        </div>

        <div class="dilemma-q">
            <label>×”×¦×’×ª ×”×“×™×œ××” (×ª×™××•×¨ ×”×”×ª× ×’×©×•×ª):</label>
            <textarea id="prof_dilemma_desc" placeholder="×ª××¨×• ×›××Ÿ ××ª ×”×“×™×œ××” ×•×”×”×ª× ×’×©×•×ª ×‘×™×Ÿ ×”×¢×¨×›×™×..."></textarea>
        </div>

        <table class="dilemma-table">
            <thead>
                <tr>
                    <th>××¤×©×¨×•×ª ×¤×¢×•×œ×” 1</th>
                    <th>××¤×©×¨×•×ª ×¤×¢×•×œ×” 2</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>
                        <label class="field-label">××”×™ ×”×¤×¢×•×œ×”?</label>
                        <textarea id="prof_act1_desc" placeholder="×ª××¨×• ××ª ××¤×©×¨×•×ª ×”×¤×¢×•×œ×” ×”×¨××©×•× ×”..."></textarea>
                        
                        <div class="field-profit">
                            <label class="field-label">×¨×•×•×—:</label>
                            <textarea id="prof_act1_profit" placeholder="××”×• ×”×¢×¨×š ××• ×”×”×™×©×’ ×©× ×¨×•×•×™×— ××¤×¢×•×œ×” ×–×•?"></textarea>
                        </div>
                        
                        <div class="field-price">
                            <label class="field-label">××—×™×¨:</label>
                            <textarea id="prof_act1_price" placeholder="×¢×œ ××™×–×” ×¢×¨×š × ××œ×¥ ×œ×•×•×ª×¨ ××• ××™×–×” × ×–×§ ×™×™×’×¨×?"></textarea>
                        </div>
                    </td>
                    <td>
                        <label class="field-label">××”×™ ×”×¤×¢×•×œ×”?</label>
                        <textarea id="prof_act2_desc" placeholder="×ª××¨×• ××ª ××¤×©×¨×•×ª ×”×¤×¢×•×œ×” ×”×©× ×™×™×”..."></textarea>
                        
                        <div class="field-profit">
                            <label class="field-label">×¨×•×•×—:</label>
                            <textarea id="prof_act2_profit" placeholder="××”×• ×”×¢×¨×š ××• ×”×”×™×©×’ ×©× ×¨×•×•×™×— ××¤×¢×•×œ×” ×–×•?"></textarea>
                        </div>
                        
                        <div class="field-price">
                            <label class="field-label">××—×™×¨:</label>
                            <textarea id="prof_act2_price" placeholder="×¢×œ ××™×–×” ×¢×¨×š × ××œ×¥ ×œ×•×•×ª×¨ ××• ××™×–×” × ×–×§ ×™×™×’×¨×?"></textarea>
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>

        <div class="accordion" onclick="toggleAccordion(this)">
            <div class="accordion-header">
                <span>××” ×”×”×‘×“×œ ×‘×™×Ÿ ×”×›×¨×¢×” ×œ×¤×ª×¨×•×Ÿ?</span>
                <span>â–¼</span>
            </div>
            <div class="accordion-content">
                <p><strong>×”×›×¨×¢×”:</strong> ×”×›×¨×¢×ª ×”×ª×œ××™×“×™× ×‘×™×Ÿ ×”×¤×ª×¨×•× ×•×ª ×”××•×¦×¢×™× ×‘×“×™×œ××” ×©×”×¦×™×’×•. ×‘×“×¨×š ×›×œ×œ ×–×” '××•-××•': ××™×–×” ××‘×™×Ÿ ×©× ×™ ×”×¤×ª×¨×•× ×•×ª ×× ×™ ××¢×“×™×£ ×•××“×•×¢.</p>
                <p><strong>×¤×ª×¨×•×Ÿ:</strong> ×”×¦×¢×ª ×¤×ª×¨×•×Ÿ ×”×‘×¢×™×”/×”× ×•×©× ×”×§×•× ×§×¨×˜×™ ×©×œ ×”×¢×‘×•×“×”. ×¨××” ×™×•×ª×¨ ××¢×©×™×ª: ××™×–×” ×¤×ª×¨×•×Ÿ ×‘×©×˜×— ×× ×™ ××¦×™×¢ ×œ×‘×¢×™×” ×©×”×¦×’×ª×™ ×‘× ×•×©× ×”×¢×‘×•×“×”. ×–×” ×œ× ××—×™×™×‘ '××• ××•', ××œ× ×××¤×©×¨ ×œ×©×œ×‘ '×’× ×•×’×' ××• ×œ×”×¦×™×¢ ×¤×ª×¨×•×Ÿ ×™×¦×™×¨×ª×™ ××—×¨.</p>
            </div>
        </div>

        <div class="dilemma-q">
            <label>×”×›×¨×¢×” ×× ×•××§×ª:</label>
            <textarea id="prof_decision" placeholder="×‘××™×–×• ××©×ª×™ ×”××¤×©×¨×•×™×•×ª ××ª× ×‘×•×—×¨×™× ×•××“×•×¢? × ××§×• ××ª ×‘×—×™×¨×ª×›×."></textarea>
        </div>
        <div class="dilemma-q">
            <label>×™×™×©×•× ×¤×ª×¨×•×Ÿ ××¢×©×™:</label>
            <textarea id="prof_solution" placeholder="×”×¦×™×¢×• ×¤×ª×¨×•×Ÿ ××¢×©×™ ×‘×©×˜×— ×œ×¡×•×’×™×”. ××¤×©×¨ ×œ×©×œ×‘ ×‘×™×Ÿ ×”××¤×©×¨×•×™×•×ª ××• ×œ×”×¦×™×¢ ×¤×ª×¨×•×Ÿ ×™×¦×™×¨×ª×™ ×—×“×©."></textarea>
        </div>
    </div>

    <div class="retro-box part-c">
        <h2>×—×œ×§ ×’': ×“×™×œ××” ××™×©×™×ª (×¢×•×œ× ×”×ª×•×›×Ÿ ×©×œ×›×)</h2>
        
        <div class="dilemma-q">
            <label>×”×¦×’×ª ×”×“×™×œ××” (×ª×™××•×¨ ×”×”×ª× ×’×©×•×ª ××—×™×™ ×”×™×•× ×™×•× ×©×œ×›× ×‘×¨×©×ª):</label>
            <textarea id="pers_dilemma_desc" placeholder="×ª××¨×• ×›××Ÿ ××ª ×”×“×™×œ××” ×”××™×©×™×ª ×•×”×”×ª× ×’×©×•×ª ×‘×™×Ÿ ×”×¢×¨×›×™× ×× ×§×•×“×ª ×”××‘×˜ ×©×œ×›× ×›×™×¦×¨× ×™/×¦×¨×›× ×™ ×ª×•×›×Ÿ..."></textarea>
        </div>

        <table class="dilemma-table">
            <thead>
                <tr>
                    <th>××¤×©×¨×•×ª ×¤×¢×•×œ×” 1</th>
                    <th>××¤×©×¨×•×ª ×¤×¢×•×œ×” 2</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>
                        <label class="field-label">××”×™ ×”×¤×¢×•×œ×” (×©×œ×›×)?</label>
                        <textarea id="pers_act1_desc" placeholder="×ª××¨×• ××ª ××¤×©×¨×•×ª ×”×¤×¢×•×œ×” ×”×¨××©×•× ×”..."></textarea>
                        
                        <div class="field-profit">
                            <label class="field-label">×¨×•×•×— ××™×©×™:</label>
                            <textarea id="pers_act1_profit" placeholder="××”×• ×”×¢×¨×š ××• ×”×”×™×©×’ ×©×ª×¨×•×•×™×—×• ××¤×¢×•×œ×” ×–×•?"></textarea>
                        </div>
                        
                        <div class="field-price">
                            <label class="field-label">××—×™×¨ ××™×©×™:</label>
                            <textarea id="pers_act1_price" placeholder="×¢×œ ××™×–×” ×¢×¨×š ×ª××œ×¦×• ×œ×•×•×ª×¨ ××• ××™×–×” × ×–×§ ×™×™×’×¨× ×œ×›×/×œ×¡×‘×™×‘×ª×›×?"></textarea>
                        </div>
                    </td>
                    <td>
                        <label class="field-label">××”×™ ×”×¤×¢×•×œ×” (×©×œ×›×)?</label>
                        <textarea id="pers_act2_desc" placeholder="×ª××¨×• ××ª ××¤×©×¨×•×ª ×”×¤×¢×•×œ×” ×”×©× ×™×™×”..."></textarea>
                        
                        <div class="field-profit">
                            <label class="field-label">×¨×•×•×— ××™×©×™:</label>
                            <textarea id="pers_act2_profit" placeholder="××”×• ×”×¢×¨×š ××• ×”×”×™×©×’ ×©×ª×¨×•×•×™×—×• ××¤×¢×•×œ×” ×–×•?"></textarea>
                        </div>
                        
                        <div class="field-price">
                            <label class="field-label">××—×™×¨ ××™×©×™:</label>
                            <textarea id="pers_act2_price" placeholder="×¢×œ ××™×–×” ×¢×¨×š ×ª××œ×¦×• ×œ×•×•×ª×¨ ××• ××™×–×” × ×–×§ ×™×™×’×¨× ×œ×›×/×œ×¡×‘×™×‘×ª×›×?"></textarea>
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>

        <div class="accordion" onclick="toggleAccordion(this)">
            <div class="accordion-header">
                <span>××” ×”×”×‘×“×œ ×‘×™×Ÿ ×”×›×¨×¢×” ×œ×¤×ª×¨×•×Ÿ?</span>
                <span>â–¼</span>
            </div>
            <div class="accordion-content">
                <p><strong>×”×›×¨×¢×”:</strong> ×”×›×¨×¢×ª ×”×ª×œ××™×“×™× ×‘×™×Ÿ ×”×¤×ª×¨×•× ×•×ª ×”××•×¦×¢×™× ×‘×“×™×œ××” ×©×”×¦×™×’×•. ×‘×“×¨×š ×›×œ×œ ×–×” '××•-××•': ××™×–×” ××‘×™×Ÿ ×©× ×™ ×”×¤×ª×¨×•× ×•×ª ×× ×™ ××¢×“×™×£ ×•××“×•×¢.</p>
                <p><strong>×¤×ª×¨×•×Ÿ:</strong> ×”×¦×¢×ª ×¤×ª×¨×•×Ÿ ×”×‘×¢×™×”/×”× ×•×©× ×”×§×•× ×§×¨×˜×™ ×©×œ ×”×¢×‘×•×“×”. ×¨××” ×™×•×ª×¨ ××¢×©×™×ª: ××™×–×” ×¤×ª×¨×•×Ÿ ×‘×©×˜×— ×× ×™ ××¦×™×¢ ×œ×‘×¢×™×” ×©×”×¦×’×ª×™ ×‘× ×•×©× ×”×¢×‘×•×“×”. ×–×” ×œ× ××—×™×™×‘ '××• ××•', ××œ× ×××¤×©×¨ ×œ×©×œ×‘ '×’× ×•×’×' ××• ×œ×”×¦×™×¢ ×¤×ª×¨×•×Ÿ ×™×¦×™×¨×ª×™ ××—×¨.</p>
            </div>
        </div>

        <div class="dilemma-q">
            <label>×”×›×¨×¢×” ×× ×•××§×ª (×‘×¨××” ×”××™×©×™×ª):</label>
            <textarea id="pers_decision" placeholder="×‘××™×–×• ××¤×©×¨×•×ª ××ª× ×‘×•×—×¨×™× ×œ×¤×¢×•×œ ×‘×¨××” ×”××™×©×™×ª ×•××“×•×¢?"></textarea>
        </div>
        <div class="dilemma-q">
            <label>×™×™×©×•× ×¤×ª×¨×•×Ÿ ××¢×©×™ (×‘×¨××” ×”××™×©×™×ª):</label>
            <textarea id="pers_solution" placeholder="×”×¦×™×¢×• ×¤×ª×¨×•×Ÿ ××¢×©×™ ×œ×™×™×©×•× ×”×“×™×œ××” ×‘×—×™×™× ×”××™×©×™×™× ×©×œ×›× (×‘×¨×©×ª×•×ª/×‘×¦×¨×™×›×ª ×ª×•×›×Ÿ)."></textarea>
        </div>
    </div>

    <div class="footer-actions">
        <button class="btn btn-save" onclick="manualSave()">â˜ï¸ ×©××™×¨×” ×’×™×‘×•×™ ×‘×¢× ×Ÿ</button>
        <button class="btn btn-submit" onclick="submitWork()">ğŸ“ ×¡×™×•× ×•×”×’×©×” ×œ××•×¨×” (×§×•×‘×¥ × ×¢×•×œ)</button>
    </div>

</div>

<script>
    // ==========================================
    // 1. ×”×’×“×¨×•×ª Firebase
    // ==========================================
    const firebaseConfig = {
        apiKey: "AIzaSyDOlw3s8moJOTY-UcLBt6L-uQHHxrudj-I",
        authDomain: "matalot-c5b27.firebaseapp.com",
        databaseURL: "https://matalot-c5b27-default-rtdb.europe-west1.firebasedatabase.app",
        projectId: "matalot-c5b27",
    };
    
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // ==========================================
    // 2. ×§×œ×™×˜×ª ×¤×¨××˜×¨×™× ××”-URL
    // ==========================================
    const urlParams = new URLSearchParams(window.location.search);
    const studentId = urlParams.get('studentId') || 'guest_student';
    const assignmentId = urlParams.get('assignmentId') || 'public_broadcasting_task';
    const studentNameFromUrl = urlParams.get('studentName') || '';
    const studentClassFromUrl = urlParams.get('studentClass') || '';
    
    // ××¤×ª×— ×”×©××™×¨×” ×”×™×™×—×•×“×™ ×‘×“××˜×” ×‘×™×™×¡
    const dbPath = `submissions/${studentId}_${assignmentId}/fields/`;

    // ××›×œ×•×¡ × ×ª×•× ×™× ×¨××©×•× ×™×™× ×× ×™×© ×‘-URL
    if (studentNameFromUrl) {
        document.getElementById('studentName').value = studentNameFromUrl;
    }

    // ==========================================
    // 3. ×œ×•×’×™×§×ª ×˜×¢×™× ×” ×•×©××™×¨×” ×‘×¢× ×Ÿ
    // ==========================================
    const statusEl = document.getElementById('saveStatus');
    let typingTimer;
    
    // ×˜×¢×™× ×ª ×”× ×ª×•× ×™× ×‘×¤×ª×™×—×ª ×”×“×£
    function loadData() {
        db.ref(dbPath).once('value', snapshot => {
            if (snapshot.exists()) {
                const data = snapshot.val();
                for (let key in data) {
                    const el = document.getElementById(key);
                    if (el) {
                        el.value = data[key];
                        // ×¢×“×›×•×Ÿ ×’×•×‘×” ×”×ª×™×‘×” ×× ×–×” textarea
                        if (el.tagName === 'TEXTAREA') {
                            el.style.height = 'auto';
                            el.style.height = (el.scrollHeight) + 'px';
                        }
                    }
                }
                updateStatus('saved', 'âœ… × ×ª×•× ×™× × ×˜×¢× ×•');
                setTimeout(() => { statusEl.style.opacity = '0'; }, 3000);
            } else {
                statusEl.style.opacity = '0';
            }
        });
    }

    // ×¤×•× ×§×¦×™×™×ª ×©××™×¨×” ×œ-Firebase
    function saveToCloud(isManual = false) {
        updateStatus('saving', '×©×•××¨ ×‘×¢× ×Ÿ â³');
        
        let data = {};
        document.querySelectorAll('input[type="text"], input[type="email"], textarea').forEach(el => {
            if(el.id) {
                data[el.id] = el.value;
            }
        });

        // ×©××™×¨×ª ×©×¢×ª ×”×¢×“×›×•×Ÿ
        data.last_updated = new Date().toLocaleString('he-IL');

        db.ref(dbPath).set(data)
            .then(() => {
                updateStatus('saved', 'âœ… × ×©××¨ ×‘×¢× ×Ÿ');
                if (isManual) alert("×”×¢×‘×•×“×” × ×©××¨×” ×‘×”×¦×œ×—×” ×‘×¢× ×Ÿ!");
                setTimeout(() => { statusEl.style.opacity = '0'; }, 3000);
            })
            .catch(error => {
                updateStatus('error', 'âŒ ×©×’×™××” ×‘×©××™×¨×”');
                console.error(error);
            });
    }

    // ×¢×“×›×•×Ÿ ×¡×˜×˜×•×¡ ×‘-UI
    function updateStatus(state, text) {
        statusEl.textContent = text;
        statusEl.className = `save-status ${state}`;
    }

    // ×©××™×¨×” ×™×–×•××” ××”×›×¤×ª×•×¨
    function manualSave() {
        saveToCloud(true);
    }

    // ==========================================
    // 4. ××™×¨×•×¢×™ ××©×ª××© (Auto-save, Resize, Paste)
    // ==========================================

    // Auto-resize ×œ×ª×™×‘×•×ª ×˜×§×¡×˜
    function autoResize() {
        this.style.height = 'auto';
        this.style.height = (this.scrollHeight) + 'px';
    }

    document.querySelectorAll('input, textarea').forEach(el => {
        // ×”××–× ×” ×œ×”×§×œ×“×”
        el.addEventListener('input', function() {
            if (this.tagName === 'TEXTAREA') autoResize.call(this);
            
            updateStatus('typing', '××§×œ×™×“/×”...');
            clearTimeout(typingTimer);
            
            // ×©××™×¨×” 3 ×©× ×™×•×ª ××—×¨×™ ×”×¤×¡×§×ª ×”×§×œ×“×”
            typingTimer = setTimeout(() => saveToCloud(false), 3000);
        });

        // ×‘×™×˜×•×œ ×”×“×‘×§×”
        el.addEventListener('paste', e => {
            e.preventDefault();
            alert('×”×“×‘×§×” ×—×¡×•××”! ××˜×¨×ª ×”×¢×‘×•×“×” ×”×™× × ×™×¡×•×— ×¢×¦××™ ×•×”×§×œ×“×”.');
        });
        
        // ×”×ª×××ª ×’×•×‘×” ×”×ª×—×œ×ª×™×ª
        if (el.tagName === 'TEXTAREA') {
            el.style.height = (el.scrollHeight) + 'px';
        }
    });

    // ×©××™×¨×” ××•×˜×•××˜×™×ª ×›×’×™×‘×•×™ ×›×œ 45 ×©× ×™×•×ª
    setInterval(() => saveToCloud(false), 45000);

    // ==========================================
    // 5. × ×™×•×•×˜ ×•×ª×¦×•×’×”
    // ==========================================

    // ××§×•×¨×“×™×•×Ÿ ××ª×§×¤×œ
    function toggleAccordion(element) {
        element.classList.toggle('active');
        const headerArrow = element.querySelector('.accordion-header span:last-child');
        if (element.classList.contains('active')) {
            headerArrow.textContent = 'â–²';
        } else {
            headerArrow.textContent = 'â–¼';
        }
    }

    // ×”×’×©×” ×¡×•×¤×™×ª
    function submitWork() {
        const studentName = document.getElementById('studentName').value.trim();
        if (!studentName) {
            alert('×—×•×‘×” ×œ××œ× ×©× ×ª×œ××™×“/×” ×œ×¤× ×™ ×”×’×©×”!');
            document.getElementById('studentName').focus();
            return;
        }

        if (confirm('×”×× ××ª× ×‘×˜×•×—×™× ×©×‘×¨×¦×•× ×›× ×œ×”×’×™×©? ×¤×¢×•×œ×” ×–×• ×ª×©××•×¨ ×¡×•×¤×™×ª ×•×ª× ×¢×œ ××ª ×”×§×•×‘×¥ ×œ×¢×¨×™×›×”.')) {
            // × ×¢×™×œ×ª ×”×××©×§
            document.body.classList.add('locked');
            document.querySelectorAll('input, textarea').forEach(el => {
                el.setAttribute('disabled', 'true');
            });
            document.querySelector('.footer-actions').style.display = 'none';
            
            // ×”×•×¡×¤×ª ×¡×˜×˜×•×¡ "×”×•×’×©"
            db.ref(`submissions/${studentId}_${assignmentId}/status`).set('submitted');
            
            // ×©××™×¨×” ×¡×•×¤×™×ª ×‘×¢× ×Ÿ
            saveToCloud(false);
            
            alert('×”×¢×‘×•×“×” ×”×•×’×©×” ×‘×”×¦×œ×—×” ×•× ×©××¨×” ×‘×¢× ×Ÿ ×©×œ ×”××•×¨×”!');
        }
    }

    // ×§×¨×™××” ×œ×˜×¢×™× ×ª × ×ª×•× ×™× ×›×©×”×“×£ ×¢×•×œ×”
    window.onload = loadData;

</script>

</body>
</html>